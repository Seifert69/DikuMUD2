/*
filename    demon
password    funky
changedby   jager
EmailAdd     Palio <palio@blinksoft.com>
request     compile
version     28
END HEADER*/

#include <composed.h>
#include <values.h>

#define ENTERED_REALM	"Demon realm entered"
#define QUEST1_ONGOING	"Chaos quest Ongoing"
#define QUEST1_FINISHED "Chaos quest Finished"

#define MAIDEN_ONGOING	"Searching for the young maiden Anya"
#define MAIDEN_FINISHED "Found the young maiden Anya"

#define VAULT_MAX	4
#define VAULT_COMBN	"2","4","3","7"
#define VAULT_COMBD	"r","r","l","l"

#define SAY(_SAYSTR)	exec("say "+_SAYSTR,self)
#define GRIN		exec("grin",self)
#define CACK		exec("cack",self)
#define MOO		exec("moo",self)
#define LAU		exec("laugh",self)
#define CHUCK		exec("chuck",self)
#define SMILE		exec("smile",self)

#define _VORTEX extra {"vortex"} \
"The vortex is a very beautiful sight, its colour ranges from white to blue  \
and it pulsates with power. If you can remember correctly, the vortex is     \
supposed to be the source of all magic power even the gods drain their       \
strength from it. In this world the vortex acts as a sun because of its      \
shimmering appearance."



/* Abilities: Str, Dex, Con, Hpp, Bra, Cha, Mag, Div */
/* Weapons: Axe_ham, Sword, Club_mace, Polearm, Unarmed, Special */
/* Spells: Div, Pro, Det, Sum, Cre, Min, Hea, Col, Cel, Int, Ext */

/* Define section for demons */
/* ---------------------------------------------------------------------- */
/*									  */
/*				   DEMONS				 */
/*									  */
/* ---------------------------------------------------------------------- */
#define BASE_LESSER_DEMON(MLVL, ARMOUR)  \
   sex SEX_NEUTRAL \
   race RACE_LESSER_DEMON \
   level MLVL \
   height 100 + MLVL*4 \
   weight 200 + MLVL*4 \
   NATURAL_DEF(WPN_CRUSH, ARMOUR)

#define BASE_GREATER_DEMON(MLVL, ARMOUR, SEX_APP)  \
   sex SEX_APP \
   race RACE_GREATER_DEMON \
   level MLVL \
   height 400 + MLVL*5 \
   weight 400 + MLVL*5 \
   NATURAL_DEF(WPN_CLAW, ARMOUR)

#define BASE_SERVENT_DEMON(MLVL, ARMOUR) \
   sex SEX_NEUTRAL \
   race RACE_SERVANT_DEMON \
   level MLVL \
   height 50 + MLVL*3 \
   weight 100 + MLVL*3 \
   NATURAL_DEF(WPN_CLAW,ARMOUR)

#define SERVANT_DEMON_GROUP(MLVL) \
   BASE_LESSER_DEMON(MLVL, ARM_CLOTHES) \
   MSET_ABILITY(24,20,10,10,9,9,9,9) \
   MSET_WEAPON(5,20,5,5,20,5) \
   MSET_SPELL(10,3,3,3,3,3,3,3,3,3,3) \
   exp 70


#define SERVENT_DEMON(MLVL) \
   BASE_LESSER_DEMON(MLVL, ARM_CLOTHES) \
   MSET_ABILITY(17,18,12,17,9,9,9,9) \
   MSET_WEAPON(5,20,5,5,20,5) \
   MSET_SPELL(10,3,3,3,3,3,3,3,3,3,3) \
   exp 70

#define MAGE_DEMON(MLVL) \
   BASE_LESSER_DEMON(MLVL, ARM_HLEATHER) \
   MSET_ABILITY(9,7,9,20,20,10,20,5) \
   MSET_WEAPON(0,0,0,15,15,0) \
   MSET_SPELL(0,5,5,10,0,10,20,0,0,10,10) \
   dilcopy combat_mag@function("spray of acid","",0,3);

#define WARRIOR_DEMON(MLVL) \
   BASE_LESSER_DEMON(MLVL, ARM_CHAIN) \
   MSET_ABILITY(22,19,11,20,14,0,7,7) \
   MSET_WEAPON(8,23,8,8,15,8) \
   MSET_SPELL(1,1,1,5,1,2,11,1,1,3,3) \
   dilcopy combat_mag@function("fire ball","",0,3);

#define LORD_DEMON(MLVL,SEX) \
   BASE_GREATER_DEMON(MLVL, ARM_PLATE, SEX) \
   race RACE_PRINCE_DEMON \
   MSET_ABILITY(22,22,4,23,14,1,7,7) \
   MSET_WEAPON(6,12,6,6,12,5) \
   MSET_SPELL(4,3,3,3,3,3,12,3,3,4,12) \
   exp 150 \
   dilcopy combat_mag@function("acid ball","",0,3);

#define DEMON_SPIDER(MLVL, ARMOUR, SEX_APP) \
   sex SEX_APP \
   race RACE_GREATER_DEMON \
   level MLVL \
   height 300 + MLVL*5 \
   weight 500 + MLVL*5 \
   alignment -600 \
   NATURAL_DEF(WPN_BITE, ARMOUR) \
   MSET_ABILITY(31,32,10,10,14,3,0,0) \
   MSET_WEAPON(12,6,6,6,12,5) \
   MSET_SPELL(4,3,3,3,3,3,3,3,3,21,4)

#define LESSER_GHOST(MLVL,GENDER) \
   race RACE_GHOST \
   level MLVL \
   height 150 \
   weight  80 \
   NATURAL_DEF(WPN_CLAW, ARM_CHAIN) \
   exp 40 \
   alignment 0 /* Who says a ghost has to be evil? */ \
   MSET_ABILITY(20,20,15,15,5,5,5,15) \
   MSET_WEAPON(6,6,6,6,20,6) \
   MSET_SPELL(2,2,2,2,2,2,2,2,2,21,11)


#define GREATER_GHOST(MLVL,GENDER) \
   race RACE_GHOST \
   level MLVL \
   height	140 \
   weight	120 \
   NATURAL_DEF(WPN_CLAW, ARM_CHAIN) \
   exp 50  \
   alignment 0 /* Who says a ghost has to be evil? */ \
   MSET_ABILITY(20,20,15,15,15,0,0,15) \
   MSET_WEAPON(6,6,6,6,20,6) \
   MSET_SPELL(2,2,2,2,2,2,2,2,2,21,11) \
   dilcopy combat_mag@function("energy drain","",0,3);


%zone demon_realm	/* Zone name */
title "Demon Realm"
lifespan 20	/* Reset time */
reset RESET_ANYHOW
creators {"shai"} /* Ahm... It speaks for itself */

notes "A demonic realm outside of Hades, It has some future links if people
would like to use them. Otherwise they'll stay unused.  (Added clan link
on 1/26/97 - Jager)"

help "This zone has a lot of dead ends, those are planned links to other zones
and you will be notified when any of them are in use. Please report bugs and
things you think are wrong in this zone by using any of the bug/typo commands.&n"
/*################################################################*/
%dil
/******************************************************************/
dilbegin aware chop_leftarm();
var
 pc	: unitptr;
 arg	: string;
 tmp	: string;
 shit   : integer;
code{
     if( dilfind( "block_left@demon_realm", self ) )
       quit;
     act( "$1n's left arm is cut off, there is blood everywhere!", A_SOMEONE, self, null, null, TO_ROOM );
     act( "Your left arm is cut off, there is blood everywhere!", A_SOMEONE, self, null, null, TO_CHAR );
     unequip( equipment( self, WEAR_HOLD ) );
     unequip( equipment( self, WEAR_SHIELD ) );
     dilcopy( "block_left@demon_realm", self );
   :loop:
     wait( SFB_DONE, command( CMD_CAST ) );
     arg := argument;
     tmp := " " + getword( arg );
     if( tmp in " heal" )
     {
      pc := findunit( activator, arg, FIND_UNIT_SURRO, null );
      if( pc == self )
      {
       act( "The heal spell allows you to grow a new left arm.", A_SOMEONE, self, null, null, TO_CHAR );
       act( "The heal spell cast on $1n allows $1m to grow a new left arm.", A_HIDEINV, self, null, null, TO_CHAR );
       shit := dildestroy( "block_left@demon_realm", self );
       quit;
      }
     }
     goto loop;
}
dilend

dilbegin aware block_left();
var
 u	: unitptr;
code{
   :loop:
     wait( SFB_CMD, ( command( CMD_WEAR ) or command( CMD_HOLD ) ) and ( activator == self ) );
     if( command( CMD_HOLD ) )
     {
      block;
      sendtext( "Have you forgot?&nYou have no left arm!&n", self );
      goto loop;
     }
     if( command( CMD_WEAR ) )
     {
      u := findunit( self, argument, FIND_UNIT_INVEN, null );
      if( u )
      {
       if( u.manipulate & ( MANIPULATE_WEAR_SHIELD | MANIPULATE_HOLD ) )
       {
	block;
	sendtext( "Have you forgot?&nYou have no left arm!&n", self );
       }
      }
     }
     goto loop;
}
dilend

dilbegin aware chop_rightarm();
var
 pc	: unitptr;
 arg	: string;
 tmp	: string;
 shit   : integer;
code{
     if( dilfind( "block_right@demon_realm", self ) )
       quit;

     act( "$1n's right arm is cut off, there is blood everywhere!", A_SOMEONE, self, null, null, TO_ROOM );
     act( "Your right arm is cut off, there is blood everywhere!", A_SOMEONE, self, null, null, TO_CHAR );
     unequip( equipment( self, WEAR_WIELD ) );
     dilcopy( "block_right@demon_realm", self );
   :loop:
     wait( SFB_DONE, command( CMD_CAST ) );
     arg := argument;
     tmp := " " + getword( arg );
     if( tmp in " heal" )
     {
      pc := findunit( activator, arg, FIND_UNIT_SURRO, null );
      if( pc == self )
      {
       act( "The heal spell allows you to grow a new right arm.", A_SOMEONE, self, null, null, TO_CHAR );
       act( "The heal spell cast on $1n allows $1m to grow a new right arm.", A_HIDEINV, self, null, null, TO_CHAR );
       shit := dildestroy( "block_right@demon_realm", self );
       quit;
      }
     }
     goto loop;
}
dilend

dilbegin aware block_right();
var
 u	: unitptr;
code{
   :loop:
     wait( SFB_CMD, command( CMD_WIELD ) and ( activator == self ) );
     block;
     sendtext( "Have you forgot?&nYou have no right arm!&n", self );
     goto loop;
}
dilend

/******************************************************************/

dilbegin aware shopclose();
var
 room	: string;
 out	: unitptr;
code{
	 out := self;
	 while( not( out.type & UNIT_ST_ROOM ) )
		out := out.outside;
	 room := out.nameidx;

	 exec( "say Closing time...", self );
	 act( "$1n fades from existence.", A_HIDEINV, self, null, null, TO_ALL );
	 link( self, findroom( "shop_room@demon_realm" ) );
	 self.minv := 51;

	 wait( SFB_MSG, ( argument == "opening" ) );
	 link( self, findroom( room + "@demon_realm" ) );
	 self.minv := 0;
	 act( "$1n fades back into existence.", A_HIDEINV, self, null, null, TO_ALL );
	 quit;
}
dilend

/* Shadow eq Light damage */

dilbegin light_eat();
var
 rom : unitptr;
code{
	 heartbeat := PULSE_SEC*3;
   :loop:
	 pause;
	 if( self.outside.type & ( UNIT_ST_PC | UNIT_ST_ROOM ) )
	 {
	  rom := self;
	  while( not( rom.type & UNIT_ST_ROOM ) )
	rom := rom.outside;
	  if( rom.light > 0 )
	  {
	   if( rom.light >= self.hp)
	   {
	if( self.outside.type & UNIT_ST_ROOM )
	 act( "The $2N gives out a sudden burst of light and fades away.",
		  A_SOMEONE, self.outside.inside, self, null, TO_ALL );
	else
	{
	 act( "$1n's $2N gives out a sudden burst of light and fades away.",
		 A_SOMEONE, self.outside, self, null, TO_REST );
	 act( "Your $2N gives out a sudden burst of light and fades away.",
		 A_SOMEONE, self.outside, self, null, TO_CHAR );
	}
	destroy( self );
	   }
	   self.hp := self.hp - rom.light;
	  }
	 }
	 goto loop;
}
dilend


dilbegin chain_aff(medi : unitptr, targ : unitptr, hm : integer);
code{
	 if( hm > 0 )
	 {
	  act( "The $2N burns your skin as the magic power overwhelms it.",
		   A_SOMEONE, self, medi, null, TO_CHAR );
	 }
	 return;
}
dilend

/* Mortifier recharge dil */

dilbegin mort_load();
var
   random : integer;
   u	  : unitptr;
code{
   :start:
         wait( SFB_DEAD, TRUE );
         if( self.fighting != activator ) goto start;

         u := equipment( self, WEAR_WIELD );
	 if( ( u == null )
	 or  ( u.nameidx != "mortifier"   )
	 or  ( u.zoneidx != "demon_realm" ) )
	   quit;

         random := activator.race;
         if( ( random >= RACE_LESSER_DEMON ) and
             ( random <= RACE_PRINCE_DEMON ) )
	 {
	  /* Charge depending on race */
          if( random == RACE_SERVANT_DEMON ) sendtoalldil( "1", "mort_charge@demon_realm" );
          if( random == RACE_LESSER_DEMON  ) sendtoalldil( "2", "mort_charge@demon_realm" );
          if( random == RACE_GREATER_DEMON ) sendtoalldil( "4", "mort_charge@demon_realm" );
          if( random == RACE_PRINCE_DEMON  ) sendtoalldil( "8", "mort_charge@demon_realm" );
	 }
	 goto start;
}
dilend

/* Mortifier Heal-Affect */

dilbegin mort_heal(medi : unitptr, targ : unitptr, hm : integer);
code{
           act( "The handle of you $2n starts to shine faintly, then the light dies.",A_SOMEONE,self,medi,null,TO_CHAR);
           act( "The handle of $1n's $2n starts to shine faintly, then the light dies.",A_SOMEONE,self,medi,null,TO_REST);
           act( "You feel something wet sliding over your hands.",A_SOMEONE,self,null,null,TO_CHAR);
           act( "A warm feeling starts at your hands and rapidly turns in to a jolt of energy.",A_SOMEONE,self,null,null,TO_CHAR);
	   return;
}
dilend

/* Mortifier Fumble-Affect */

dilbegin mort_fumb(medi : unitptr, targ : unitptr, hm : integer);
code{
           act("The horns of your $2N turns over and CUTS your hands.",A_SOMEONE,
			  self,medi,null,TO_CHAR);
           act("You SCREAM in AGONY!",A_SOMEONE,self,null,null,TO_CHAR);
           act("The horns of $1n's $2N turns over and CUTS $1s hands.",A_SOMEONE,
			  self,medi,null,TO_REST);
           act("$1n SCREAM in AGONY!",A_SOMEONE,self,null,null,TO_REST);
	   return;
}
dilend

/* Mortifier Affect */

dilbegin mort_aff(medi : unitptr, targ : unitptr, hm : integer);
code{  /* Self=Wielder, Medi=Sword, Targ=Enemy */
           act( "Your $2N glows!",  A_SOMEONE,  self, medi, null, TO_CHAR );
	   act( "$1n's $2N glows!", A_SOMEONE, self, medi, null, TO_REST );
	   if( hm < 10 )
	   {
        act( "Your $2N MUTILATES $3n.",  A_SOMEONE,  self, medi, targ, TO_CHAR );
	act( "$1n's $2N MUTILATES $3n.", A_SOMEONE, self, medi, targ, TO_NOTVICT );
	act( "$1n's $2N MUTILATES you.", A_SOMEONE, self, medi, targ, TO_VICT );
	return;
	   }
	   if( hm < 20 )
	   {
        act( "You THRUST the $2N through $3n.",  A_SOMEONE,  self, medi, targ, TO_CHAR );
	act( "$1n THRUSTS his $2N through $3n.", A_SOMEONE, self, medi, targ, TO_NOTVICT );
	act( "$1n THRUSTS his $2N through you.", A_SOMEONE, self, medi, targ, TO_VICT );
	return;
	   }
	   if( hm < 30 )
	   {
	act( "As you PUSH the $2N into $3n, the horns on the $2N start to VIBRATE",
                A_SOMEONE, self, medi, targ, TO_CHAR );
	act( "As $1n PUSHES the $2N into $3n, the horns on the $2N start to VIBRATE",
		A_SOMEONE, self, medi, targ, TO_NOTVICT );
	act( "As $1n PUSHES the $2N into you, the horns on the $2N start to VIBRATE",
		A_SOMEONE, self, medi, targ, TO_VICT );
        act( "You SCREAM loudly!!!",  A_SOMEONE,  targ, null, null, TO_CHAR );
	act( "$1n SCREAMS loudly!!!", A_SOMEONE, targ, null, null, TO_REST );
	return;
	   }
	   act( "The horns on the $2N CRUSHES $3n as they EMBRACE $3m.",
                   A_SOMEONE,  self, medi, targ, TO_CHAR );
	   act( "The horns on $1n's $2N CRUSHES $3n as they EMBRACE $3m.",
		   A_SOMEONE, self, medi, targ, TO_NOTVICT );
	   act( "The horns on $1n's $2N CRUSHES you as they EMBRACE you.",
		   A_SOMEONE, self, medi, targ, TO_VICT );
           act( "You HOWL in pain!!!",  A_SOMEONE,  targ, null, null, TO_CHAR );
	   act( "$1n HOWLS in pain!!!", A_SOMEONE, targ, null, null, TO_REST );
	   return;
}
dilend

/* Mortifier Lightning-Affect */

dilbegin mort_light(medi : unitptr, targ : unitptr, hm : integer);
code{
          act("The power of the lightning hits you hard.",A_SOMEONE,targ,null,null,TO_CHAR);
	  act("The power of the lightning hits $1n hard.",A_SOMEONE,targ,null,null,TO_REST);
	  if(hm==0)
	  {
           act("As the lightning is about to hit you, a small portal opens.",A_SOMEONE,targ,null,null,TO_CHAR);
	   act("As the lightning is about to hit $1n, a small portal opens.",A_SOMEONE,targ,null,null,TO_REST);
           act("And the lightning bolt is sucked into it.",A_SOMEONE,targ,null,null,TO_ALL);
	   return;
	  }
          act("You can feel every muscle and nerve in your body straining, the pain is almost to great.",A_SOMEONE,targ,null,null,TO_CHAR);
	  act("When the lightning strikes $1n $1s body, $1e tries to scream. But you hear nothing.",A_HIDEINV,targ,null,null,TO_REST);
	  return;
}
dilend

/* Check guardian quest */
dilbegin chk_gqst();
var
   pc	  : unitptr;
   pname  : string;
   ifight : integer;
   quest  : extraptr;
   potn   : unitptr;
code {
   :init:
	 heartbeat:=PULSE_SEC*3;
	 on_activation(self.position == POSITION_FIGHTING, ina_fight);
	 interrupt(SFB_COM,self.position==POSITION_FIGHTING, ina_fight);
	 interrupt(SFB_CMD,(self.position==POSITION_RESTING)   or
			   (self.position==POSITION_SLEEPING)  or
			   (self.position==POSITION_MORTALLYW) or
			   (self.position==POSITION_INCAP)	   or
			   (self.position==POSITION_STUNNED), busy);
   :start:
	 wait(SFB_CMD,activator.type==UNIT_ST_PC);
	 pc:=activator;
	 secure(pc,lost_act);
	 if(command(CMD_SAY)) goto maybe_enter;
	 if(command("tranfer") and (argument=="me")) goto link_player;
	 goto start;

   :maybe_enter:
	 if("transfer me"==argument) goto link_player;
	 goto start;

   :link_player:
	 block;
	 heartbeat:=PULSE_SEC*4;
	 if(ENTERED_REALM in pc.quests) goto just_link;
	 exec("say So "+pc.name+" you wish to enter the realm of demons.",self);
	 pause;
	 exec("grin",self); pause;
	 if(pc.level<50)
	 {
	  exec("say This place would be too dangerous for you.",self); pause;
	  exec("say Come back when you are more experienced...",self);
	  heartbeat:=PULSE_SEC*3;
	  goto start;
	 }
	 act("$2n reaches for your arm.",A_SOMEONE,pc,self,null,TO_CHAR);
	 act("$2n reaches for $1n's arm.",A_SOMEONE,pc,self,null,TO_REST); pause;
         act("As $2n touches your arm, a nasty scar appears.",A_SOMEONE,pc,self,null,TO_CHAR);
	 act("As $2n touches $1n's arm, a nasty scar appears.",A_SOMEONE,pc,self,null,TO_REST);
	 addextra(pc.quests,{ENTERED_REALM},"");
         act("Suddenly you know exactly how to enter the demon realm.",A_SOMEONE,pc,null,null,TO_CHAR);
	 pause;

   :just_link:
         act("You step onto the pentagram.",A_SOMEONE,pc,null,null,TO_CHAR);
	 act("$1n steps onto the pentagram.",A_HIDEINV,pc,null,null,TO_REST);
	 pause;
         act("The pentagram starts to glow.",A_SOMEONE,self,null,null,TO_ALL);
	 pause;
         act("Suddenly everything goes black!",A_SOMEONE,pc,null,null,TO_CHAR);
	 act("Suddenly the pentagram seems to consume all light within it's circle.",
                   A_SOMEONE,pc,null,null,TO_REST);
	 pname:=pc.name;
	 dilcopy("arrive1@demon_realm",pc);
	 unsecure(pc);
	 link(pc,findroom("rentran@demon_realm"));
	 pause;
	 act("When the light comes back, "+pname+" is gone!",A_HIDEINV,self,null,null,TO_ALL);
	 heartbeat:=PULSE_SEC*3;
	 goto start;

   :busy:
	 while((self.position==POSITION_RESTING)   or
	   (self.position==POSITION_SLEEPING)  or
	   (self.position==POSITION_MORTALLYW) or
	   (self.position==POSITION_INCAP)	   or
	   (self.position==POSITION_STUNNED)) pause;
	 goto start;

   :ina_fight:
	 heartbeat:=PULSE_SEC*1;
	 while(self.position==POSITION_FIGHTING) pause;
	 heartbeat:=PULSE_SEC*2;
	 exec("sigh",self);
	 pause;
	 exec("say It is not me that is the enemy...",self);
	 pause;
	 exec("grin",self);
	 pause;
	 exec("say It is the demons!",self);
	 pause;
	 exec("say YET ANOTHER LOST SOUL!!!",self);
	 goto start;

   :lost_act:
	 heartbeat:=PULSE_SEC*4;
	 unsecure(pc);
	 goto start;
}
dilend

/* Ghost random walk */

dilbegin ghost_walk();
var
   pc	   : unitptr;
   places  : stringlist;
   places2 : stringlist;
   place   : integer;
   pname   : string;
   pptr    : unitptr;
code{
  :init:
	places:={"tsaar_road1@demon_realm"    ,"tsaar_road2@demon_realm"    ,
		 "tsaar_road3@demon_realm"    ,"tsaar_road4@demon_realm"    ,
		 "tsaar_road5@demon_realm"    ,"tsaar_road6@demon_realm"    ,
		 "tsaar_road7@demon_realm"    ,"tsaar_road8@demon_realm"    ,
		 "tsaar_road9@demon_realm"    ,"tsaar_road10@demon_realm"   ,
		 "tsaar_road11@demon_realm"   ,"tsaar_road12@demon_realm"   ,
		 "tsaar_road13@demon_realm"   ,"tsaar_road14@demon_realm"   ,
		 "tsaar_road15@demon_realm"   ,"tsaar_road16@demon_realm"   ,
		 "tsaar_road17@demon_realm"   ,"tsaar_road18@demon_realm"   ,
		 "tsaar_road19@demon_realm"   ,"tsaar_road20@demon_realm"   ,
		 "tsaar_road21@demon_realm"   ,"tsaar_road22@demon_realm"   ,
		 "tsaar_road23@demon_realm"   ,"tsaar_road24@demon_realm"   ,
		 "tsaar_road25@demon_realm"   ,"tsaar_road26@demon_realm"   ,
		 "tsaar_road27@demon_realm"   ,"tsaar_road28@demon_realm"
		 };
	places2:={
		 "dark_alley1@demon_realm"    ,"dark_alley2@demon_realm"    ,
		 "village_sq1@demon_realm"    ,"village_sq2@demon_realm"    ,
		 "village_sq3@demon_realm"    ,"village_sq4@demon_realm"    ,
		 "food_store@demon_realm"     ,"mayor_floor1@demon_realm"   ,
		 "main_road1@demon_realm"     ,"main_road2@demon_realm"     ,
		 "main_road3@demon_realm"     ,"deadend@demon_realm"        ,
		 "ruin_inn1@demon_realm"      ,"ruin_inn2@demon_realm"      ,
		 "mayor_floor2@demon_realm"   ,"hardware_store@demon_realm" ,
		 "jeweler@demon_realm"        ,"bank_of_tsaar@demon_realm"  ,
		 "tsaar_armory@demon_realm"   ,"tsaar_weaponry@demon_realm" ,
		 "magic_store@demon_realm"    ,"tsaar_guard@demon_realm"
		 };
  /* 40 rooms */

	heartbeat:=PULSE_SEC*10;
	interrupt(SFB_COM,self.position==POSITION_FIGHTING,ina_fight);
  :loop:
	heartbeat:=PULSE_SEC*10;
	pc:=activator;
  :retry:
	place:=rnd(0,39);
	if(place<28)
	  pname:=places.[place];
	else
	  pname:=places2.[place-28];
	walkto(findroom(pname));		   /* Use ptr. to move ghost */
	pause;
	heartbeat:=PULSE_SEC*25;
	pause;
	goto loop;

  :ina_fight:
	while(self.position==POSITION_FIGHTING) pause;
	goto loop;
}
dilend


dilbegin arrive1();
var
   shit :integer;
code{
	 heartbeat:=PULSE_SEC*1;
	 pause;
         act("You step out through a portal.",A_SOMEONE,self,null,null,TO_CHAR);
         act("$1n arrives through the portal.",A_SOMEONE,self,null,null,TO_REST);
	 exec("look",self);
	 quit;
}
dilend

dilbegin arrive2();
var
   shit :integer;
code{
	 heartbeat:=PULSE_SEC*1;
	 pause;
         act("You step out through a stonewall.",A_SOMEONE,self,null,null,TO_CHAR);
         act("$1n arrives through the stonewall.",A_SOMEONE,self,null,null,TO_REST);
	 exec("look",self);
	 quit;
}
dilend

dilbegin aware bag_own();
var
 ext : extraptr;
 car : unitptr;
code{
   :loop:
	 wait( SFB_MSG, ( activator.nameidx == "mayor" ) and ( activator.zoneidx == "demon_realm" ) );
	 ext := "$owner" in self.extra;
	 car := self;
	 while( not( car.type & ( UNIT_ST_PC | UNIT_ST_NPC | UNIT_ST_ROOM ) ) )
	   car := car.outside;
	 if( argument == ext.descr )
	 {
	  if( car.type == UNIT_ST_PC )
	   act( "There is a sudden lightness in your inventory.",
                  A_SOMEONE, car, null, null, TO_CHAR );
	  act( "$1n dissolves.", A_HIDEINV, self.outside.inside, null, null, TO_ROOM );
	  destroy( self );
	 }
	 goto loop;
}
dilend

dilbegin integer check_con(u : unitptr, nidx : string);
var
 u1   : unitptr;
 stat : integer;
code{
	u1:=u.inside;
	stat:=0;
	while((u1) and (stat==0))
	{
	 if(u1.nameidx==nidx) return(1);
	 if( u1.inside ) stat:=check_con(u1,nidx);
	 u1:=u1.next;
	}
	return(stat);
}
dilend

/*################################################################
  ################################################################*/
%rooms
/******************************************************************/
	shop_room
names {"shop keepers home"}
title "Resting room"
descr "The shopkeeper resting room."

flags { UNIT_FL_NO_TELEPORT }
ALWAYS_LIGHT

end
/******************************************************************/
	shai_study
names {"shais study","bohs study","study"}
title "Shai's study"
descr "A very messy room, the walls are covered with mirrors which
show diffrent parts of VALHALLA. Your guess is that they are there so that
whoever owns this rooms can guard over the realm. The south wall is covered
with pictures, and there is a big picture in the middle."

extra {"mirrors","mirror"}
"These mirrors show the entire realm of VALHALLA."

extra {"big picture in middle","big picture","picture","middle"}
"This is a picture of Boh, and on the bottom it says 'My mortal shape'."

extra {"pictures"}
"There are pictures of Ashes,Aqua,Brenda,Cecil,Chavez,Drevar,Elminster,God,
Jager,Joeboo,Julia,Kilbia,Leandra,Oldbie,Orin,Palio,Papi,Tyk,Warrax,Whistler,
Zandar. Below each of these pictures is a small golden plaque which says
'People to respect'"

extra {"ashes","aqua","brenda","cecil","chavez","drevar","elminster","god",
"jager","joeboo","julia","kilbia","leandra","oldbie","orin","palio","papi",
"tyk","warrax","whistler","zandar"}
"A picture of the person in general."

flags { UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT
end
/******************************************************************/
	rentry
names {"realm entry point","entry point"}
title "Massive wall at the bottom of the mountain"
descr
"As you walk around the mountain you come to a stop at the massive mountain
wall. As you look around, you realise that climbing it would be impossible.
The wall is covered in ancient ruins and on the rock ground there is a gigantic
pentagram. The only way from here is back around the mountain."

extra {"gigantic pentagram","pentagram"}
"It is a gigantic pentagram with ancient runes carved round its boundaries.
Your guess is that it is either a summon zone for something very powerfull or
an entrypoint to somewhere which you do not really want to go to."

extra {"ancient runes","runes"}
"The runes looks as if they have been here since the mountain raised from the
ground. But they still look very sharp and un-natural."

movement SECT_FIELD

south to shaolin_mount_1@outxiyang descr "Shaolin Mountains";

ALWAYS_LIGHT
end  /* End Realm entry point */
/******************************************************************/
		rentran
names {"realm entrance","entrance"}
title "The portal to the real world"
descr
"As you enter this room a foul smell hits you in the face. It is not a bad
smell it is only extremely strong. At first you feel a bit dizzy but you adjust
very fast to the odor. You can see movement far away... or is it far away?
You now realize that your knowledge of the law of physics dont really apply
in this dimension. You have gigantic firewalls to your east and west, so the
only way out of here is north or out through the portal."

extra {"firewalls","fire","walls","wall"}
"As you stand before the firewall you look up and realize that you can't see any
roof. Wow how high is this place really?"

extra {"gigantic portal","portal"}
"This gigantic portal pulsates with power. When you look deep inside it you
can see small fragments of the real world, at least you think it is the real
world."

_VORTEX

flags {UNIT_FL_NO_WEATHER, UNIT_FL_NO_MOB}
movement SECT_FIELD

north to pzone_4 descr "You can see a great field without vegetation before you.";

dilbegin portal();
var
   pname : string;
code {
	   heartbeat:=PULSE_SEC * 3;
	 :start:
	   wait(SFB_CMD,(command("enter")) and (activator.position==POSITION_STANDING) and
			(("portal" in argument) or (argument=="portal")));
	   block;
	   pname:=activator.name;
           act("You step through the portal.",A_SOMEONE,activator,null,null,TO_CHAR);
	   act("$1n steps through the portal.",A_HIDEINV,activator,null,null,TO_REST);
	   dilcopy("arrive2@demon_realm",activator);
	   link(activator,findroom("rentry@demon_realm"));
	   goto start;
}
dilend

ALWAYS_LIGHT
end /* End of demon realm entrence */
/*****************************************************************
			DEMONINC REALM PLAINS
 *****************************************************************/
	pzone_1
names {"pzone_1"}
title "Burning plains"
descr
"There are no bushes, trees, not even a single straw of grass, only this strange
red sand. These plains seem to burn somehow, even though the ground is barren.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
There is a huge firewall to the south."

extra {"firewall","wall"}
"As you stand before the firewall you look up and realize that you can't see any
roof. Wow how high is this place really?"

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to pzone_7 descr "You can see a great field before you without vegetation";
east  to pzone_2 descr "You can see a great field before you without vegetation";
west  to pzone_6 descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_1 */
/******************************************************************/
	pzone_2
names {"pzone_2"}
title "Burning plains"
descr
"There is no grass, no bushes, no trees. Only this strange red sand.
These plains seem to burn somehow, even though the ground is barren.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
There is a huge firewall to the south."

extra {"firewall","wall"}
"As you stand before the firewall you look up and realize that you can't see any
roof. Wow how high is this place really?"

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to pzone_8 descr "You can see a great field before you without vegetation";
east  to pzone_3 descr "You can see a great field before you without vegetation";
west  to pzone_1 descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_2 */
/******************************************************************/
	pzone_3
names {"pzone_3"}
title "Burning plains"
descr
"There is no grass, no bushes, no trees. Only this strange red sand.
These plains seem to burn somehow, even though the ground is barren.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
There is a huge firewall to the south."

extra {"firewall","wall"}
"As you stand before the firewall you look up and realize that you can't see any
roof. Wow how high is this place really?"

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to pzone_9 descr "You can see a great field before you without vegetation";
east  to pzone_4 descr "You can see a great field before you without vegetation";
west  to pzone_2 descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_3 */
/******************************************************************/
	pzone_4
names {"pzone_4"}
title "Burning plains"
descr
"There is no grass, no bushes, no trees. Only this strange red sand.
These plains seem to burn somehow, even though the ground is barren.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
To the south you see a great portal."

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"great portal","portal"}
"Hmm. That must be the entrance to this wierd realm."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to pzone_10 descr "You can see a great field before you without vegetation";
south to rentran  descr "The realm entrance point is to the south";
east  to pzone_5  descr "You can see a great field before you without vegetation";
west  to pzone_3  descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_4 */
/******************************************************************/
	pzone_5
names {"pzone_5"}
title "Burning plains"
descr
"There is no grass, no bushes, no trees. Only this strange red sand.
These plains seem to burn somehow, even though the ground is barren.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
There is a huge firewall to the south."

extra {"firewall","wall"}
"As you stand before the firewall you look up and realize that you can't see any
roof. Wow how high is this place really?"

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to pzone_11 descr "You can see a great field before you without vegetation";
east  to pzone_6 descr "You can see a great field before you without vegetation";
west  to pzone_4 descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_5 */
/******************************************************************/
	pzone_6
names {"pzone_6"}
title "Burning plains"
descr
"There is no grass, no bushes, no trees. Only this strange red sand.
These plains seem to burn somehow, even though the ground is barren.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
There is a huge firewall to the south."

extra {"firewall","wall"}
"As you stand before the firewall you look up and realize that you can't see any
roof. Wow how high is this place really?"

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to pzone_12 descr "You can see a great field before you without vegetation";
east  to pzone_1 descr "You can see a great field before you without vegetation";
west  to pzone_5 descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_6 */
/******************************************************************/
	pzone_7
names {"pzone_7"}
title "Burning plains"
descr
"There is no grass, no bushes, no trees. Only this strange red sand.
These plains seem to burn somehow, even though the ground is barren.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
There is a huge firewall to the distant south."

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

extra {"firewall"}
"The firewall rises from the ground up in the sky, you are unable to see any
ceiling so your guess is that it keeps on forever."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to pzone_13 descr "You can see a great field before you without vegetation";
south to pzone_1  descr "You can see a great field before you without vegetation";
east  to pzone_8  descr "You can see a great field before you without vegetation";
west  to pzone_12 descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_7 */
/******************************************************************/
	pzone_8
names {"pzone_8"}
title "Burning plains"
descr
"There is no grass, no bushes, no trees. Only this strange red sand.
These plains seem to burn somehow, even though the ground is barren.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
There is a huge firewall to the distant south."

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

extra {"firewall"}
"The firewall rises from the ground up in the sky, you are unable to see any
ceiling so your guess is that it keeps on forever."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to pzone_14 descr "You can see a great field before you without vegetation";
south to pzone_2  descr "You can see a great field before you without vegetation";
east  to pzone_9  descr "You can see a great field before you without vegetation";
west  to pzone_7  descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_8 */
/******************************************************************/
	pzone_9
names {"pzone_9"}
title "Burning plains"
descr
"There is no grass, no bushes, no trees. Only this strange red sand.
These plains seem to burn somehow, even though the ground is barren.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that."

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

extra {"firewall"}
"The firewall rises from the ground up in the sky, you are unable to see any
ceiling so your guess is that it keeps on forever."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to pzone_15 descr "You can see a great field before you without vegetation";
south to pzone_3  descr "You can see a great field before you without vegetation";
east  to pzone_10 descr "You can see a great field before you without vegetation";
west  to pzone_8  descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_9 */
/******************************************************************/
	pzone_10
names {"pzone_10"}
title "Burning plains"
descr
"There is no grass, no bushes, no trees. Only this strange red sand.
These plains seem to burn somehow, even though the ground is barren.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
"

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

extra {"firewall"}
"The firewall rises from the ground up in the sky, you are unable to see any
ceiling so your guess is that it keeps on forever."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to pzone_16 descr "You can see a great field before you without vegetation";
south to pzone_4  descr "You can see a great field before you without vegetation";
east  to pzone_11 descr "You can see a great field before you without vegetation";
west  to pzone_9  descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_10 */
/******************************************************************/
	pzone_11
names {"pzone_11"}
title "Burning plains"
descr
"There is no grass, no bushes, no trees. Only this strange red sand.
These plains seem to burn somehow, even though the ground is barren.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
"

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

extra {"firewall"}
"The firewall rises from the ground up in the sky, you are unable to see any
ceiling so your guess is that it keeps on forever."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to pzone_17 descr "You can see a great field before you without vegetation";
south to pzone_7  descr "You can see a great field before you without vegetation";
east  to pzone_12 descr "You can see a great field before you without vegetation";
west  to pzone_10 descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_11 */
/******************************************************************/
	pzone_12
names {"pzone_12"}
title "Burning plains"
descr
"There is no grass, no bushes, no trees. Only this strange red sand.
These plains seem to burn somehow, even though the ground is barren.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
"

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

extra {"firewall"}
"The firewall rises from the ground up in the sky, you are unable to see any
ceiling so your guess is that it keeps on forever."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to pzone_18 descr "You can see a great field before you without vegetation";
south to pzone_6  descr "You can see a great field before you without vegetation";
east  to pzone_7  descr "You can see a great field before you without vegetation";
west  to pzone_11 descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_12 */
/******************************************************************/
	pzone_13
names {"pzone_13"}
title "Burning plains"
descr
"There is no grass, no bushes, no trees. Only this strange red sand.
These plains seem to burn somehow, even though the ground is barren.
To your north is a great Abyss, when you look down you can make out some sort
of movement very far below.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
"
extra {"abyss"}
"As you look down into the abyss you can make out some sort of movement very far
below. You just hope that you will never end up down there."

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

extra {"firewall"}
"The firewall rises from the ground up in the sky, you are unable to see any
ceiling so your guess is that it keeps on forever."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

south to pzone_7  descr "You can see a great field before you without vegetation";
east  to pzone_14 descr "You can see a great field before you without vegetation";
west  to pzone_18 descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_13 */
/******************************************************************/
	pzone_14
names {"pzone_14"}
title "Burning plains"
descr
"There is no grass, no bushes, no trees. Only this strange red sand.
These plains seem to burn somehow, even though the ground is barren.
To your north is a great Abyss, when you look down you can make out some sort
of movement very far below.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
"

extra {"abyss"}
"As you look down into the abyss you can make out some sort of movement very far
below. You just hope that you will never end up down there."

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

extra {"firewall"}
"The firewall rises from the ground up in the sky, you are unable to see any
ceiling so your guess is that it keeps on forever."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

south to pzone_8  descr "You can see a great field before you without vegetation";
east  to pzone_15 descr "You can see a great field before you without vegetation";
west  to pzone_13 descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_14 */
/******************************************************************/
	pzone_15
names {"pzone_15"}
title "Burning plains"
descr
"There is no grass, no bushes, no trees. Only this strange red sand.
These plains seem to burn somehow, even though the ground is barren.
To your north is an organic bridge that goes across the abyss.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
"
extra {"bridge"}
"To your north lies an organic bridge which leads over the abyss to the opposite
side."

extra {"abyss"}
"As you look down into the abyss you can make out some sort of movement very far
below. You just hope that you will never end up down there."

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

extra {"firewall"}
"The firewall rises from the ground up in the sky, you are unable to see any
ceiling so your guess is that it keeps on forever."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to bridge_1 descr "There is a great bridge before you in this direction";
south to pzone_9  descr "You can see a great field before you without vegetation";
east  to pzone_16 descr "You can see a great field before you without vegetation";
west  to pzone_14 descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_15 */
/******************************************************************/
	pzone_16
names {"pzone_16"}
title "Burning plains"
descr
"There is no grass, no bushes, no trees. Only this strange red sand.
These plains seem to burn somehow, even though the ground is barren.
To your north is a great Abyss, when you look down you can make out some sort
of movement very far below.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
"

extra {"abyss"}
"As you look down into the abyss you can make out some sort of movement very far
below. You just hope that you will never end up down there."

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

extra {"firewall"}
"The firewall rises from the ground up in the sky, you are unable to see any
ceiling so your guess is that it keeps on forever."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

south to pzone_10 descr "You can see a great field before you without vegetation";
east  to pzone_17 descr "You can see a great field before you without vegetation";
west  to pzone_15 descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_16 */
/******************************************************************/
	pzone_17
names {"pzone_17"}
title "Burning plains"
descr
"There is no grass, no bushes.. no vegetation at all. The only thing covering
the ground is a strange redish sand. The sand seems to burn somehow.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that.
To your north is a great Abyss, when you look down you can make out some sort
of movement very far below."

extra {"abyss"}
"As you look down into the abyss you can make out some sort of movement very far
below. You just hope that you will never end up down there."

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

extra {"firewall"}
"The firewall rises from the ground up in the sky, you are unable to see any
ceiling so your guess is that it keeps on forever."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

south to pzone_11 descr "You can see a great field before you without vegetation";
east  to pzone_18 descr "You can see a great field before you without vegetation";
west  to pzone_16 descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_17 */
/******************************************************************/
	pzone_18
names {"pzone_18"}
title "Burning plains"
descr
"There is no grass, no bushes.. no vegetation at all. The only thing covering
the ground is a strange redish sand. The sand seems to burn somehow.
To your north is a great Abyss, when you look down you can make out some sort
of movement very far below.
The flames have a soft orange color, and they seem to move in the same
way all the time. Just as if some power made them move like that."

extra {"abyss"}
"As you look down into the abyss you can make out some sort of movement very far
below. You just hope that you will never end up down there."

extra {"plains"}
"Strange the sand is burning, but when you touch it you can't feel any pain."

extra {"flames","sand"}
"The sand is burning with a soft orange colour, the flames seems to be made
of some magic force. Bacuse they dont hurt you."

extra {"grass"}
"There is no grass here. And there probably never will be because of the
burning sand."

extra {"bushes","bush"}
"There are no bushes here."

extra {"trees","tree"}
"There are no trees here."

extra {"roof"}
"You can't see any roof."

extra {"firewall"}
"The firewall rises from the ground up in the sky, you are unable to see any
ceiling so your guess is that it keeps on forever."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

south to pzone_12 descr "You can see a great field before you without vegetation";
east  to pzone_13 descr "You can see a great field before you without vegetation";
west  to pzone_17 descr "You can see a great field before you without vegetation";

ALWAYS_LIGHT
end   /* End of plaine_zone_18 */
/******************************************************************/
	bridge_1
names {"bridge across abyss","bridge"}
title "The Bridge across the abyss"
descr
"The bridge is very old and is crafted in some organic material, the sight of
it makes you feel sick to your stomach. It keeps pulsating and you can see
something that looks like veins. When you put your foot down you hear a slight
slurping sound. YUCK. The bridge continues north and to your south lies the
burning plains."

extra {"bridge"}
"You are standing on it!"

extra{"veins"}
"These are real veins. The bridge is somehow alive. Creepy"

extra{"abyss"}
"The abyss don't seem to have a bottom, at least no visible bottom. You can make
out movement far below, or maybe it is just you."

_VORTEX

MATERIAL_ORGANIC("Organic material")

flags {UNIT_FL_NO_WEATHER, UNIT_FL_NO_MOB}
movement SECT_FIELD

south to pzone_15 descr "You can see a great field before you without vegetation";
north to bridge_2 descr "The bridge continues in this direction";

end /* End of brige_1 */
/******************************************************************/
	bridge_2
names {"bridge across abyss","bridge"}
title "The Bridge across the abyss"
descr
"You stand at the northern part of the bridge, it is made of some organic
material. When you look at it you see veins pulsating as some strange fluid
rushes through them. This bridge really gives you the creeps. North from here
is a small path and this bridge continues south."

extra {"bridge"}
"You are standing on it!"

extra{"veins"}
"These are real veins. The bridge is somehow alive. Creepy"

extra {"fluid"}
"As you make a small hole in one of the veins, a greyish fluid sips out through
the hole. But it only takes a few seconds for the bridge to heal and close the
wound."

extra{"abyss"}
"The abyss don't seem to have a bottom, at least no visible bottom. You can make
out movement far below, or maybe it is just you."

_VORTEX

MATERIAL_ORGANIC("Organic material")

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

south to bridge_1 descr "The bridge continues in this direction";
north to path2village3 descr "An old path";

ALWAYS_LIGHT
end /* End of brige_2 */
/******************************************************************
	   PATH BETWEEN VILLAGE,BRIDGE AND ISHLORS CASTLE!!
 ******************************************************************/
	path2village1
names {"path"}
title "Path to village"
descr
"An old worn out path which is covered with tracks of varying sizes and shapes.
It is difficult to make out exactly what creature that made these tracks, and it
makes almost impossible to tell if any humanoid has ever walked here before.
To the west is the entrance to the village of Tsaar, the path continues east.
South from here is a great abyss."

extra {}
"This path is as old as the human race possibly older."

extra {"tracks"}
"There are a lot of tracks, but you can't identify any of them. This is strange, as soon
as you lift your foot from the ground, the footprint disappear."

extra{"beasts","beast"}
"It is impossible to determine what beast that did these tracks."

extra {"abyss"}
"As you look down into the abyss you can make out some sort of movement very far
below. You just hope that you will never end up down there."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to east_gate descr "East gate of Tsaar";
east to path2village2 descr "An old path";

ALWAYS_LIGHT
end /* End of path2village1 */
/******************************************************************/
	path2village2
names {"path"}
title "Path to village"
descr
"An old worn out path which is covered with tracks of varying sizes and shapes.
It is difficult to make out exactly what creature that made these tracks, and it
makes almost impossible to tell if any humanoid has ever walked here before.
The path goes from east to west, to your south is the great Abyss and to your
north is a small path covered in ashes."

extra {}
"This path is as old as the human race possibly older."

extra {"tracks"}
"There are a lot of tracks, but you can't identify any of them."

extra{"beasts","beast"}
"It is impossible to determine what beast that did these tracks."

extra {"abyss"}
"As you look down into the abyss you can make out some sort of movement very far
below. You just hope that you will never end up down there."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to path2village1 descr "An old path.";
east to path2village3 descr "An old path.";
north to path_1 descr "The ash buried path.";

ALWAYS_LIGHT
end /* End of path2village2 */
/******************************************************************/
	path2village3
names {"path"}
title "Path to village"
descr
"An old worn out path which is covered with tracks of varying sizes and shapes.
It is difficult to make out exactly what creature that made these tracks, and it
makes almost impossible to tell if any humanoid has ever walked here before.
The path goes from east to west and to your south is a bridge that leads across
the great Abyss."

extra {}
"This path is as old as the human kind."

extra {"bridge"}
"To your north lies an organic bridge which leads over the abyss to the opposite
side."

extra {"tracks"}
"There are a lot of tracks, but you can't identify any of them."

extra{"beasts","beast"}
"It is impossible to determine what beast that did these tracks."

extra {"abyss"}
"As you look down into the abyss you can make out some sort of movement very far
below. You just hope that you will never end up down there."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

east  to path2village4 descr "An old path.";
west  to path2village2 descr "An old path.";
south to bridge_2	   descr "Bridge over the Abyss.";

ALWAYS_LIGHT
end /* End of path2village3 */
/******************************************************************/
	path2village4
names {"path"}
title "Path to village"
descr
"An old worn out path which is covered with tracks of varying sizes and shapes.
It is difficult to make out exactly what creature that made these tracks, and it
makes almost impossible to tell if any humanoid has ever walked here before.
The path leads from east to west, to your south is a great abyss and to your
north you can see a HUGE statue."

extra {}
"This path is as old as the human kind."

extra {"huge statue","statue","north"}
"The statue is somewhat decayed but it resembles the god Zeus from the greek
mythology, it is missing an arm."

extra {"tracks"}
"There are a lot of tracks, but you can't identify any of them."

extra{"beasts","beast"}
"It is impossible to determine what beast that did these tracks."

extra {"abyss"}
"As you look down into the abyss you can make out some sort of movement very far
below. You just hope that you will never end up down there."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to path2village3 descr "An old path";
east to path2village5 descr "An old path";

ALWAYS_LIGHT
end /* End of path2village4 */
/******************************************************************/
	path2village5
names {"path"}
title "Path to village"
descr
"An old worn out path which is covered with tracks of varying sizes and shapes.
It is difficult to make out exactly what creature that made these tracks, and it
makes almost impossible to tell if any humanoid has ever walked here before.
The path goes from east to west with a smaller path leading south over the abyss."

extra {}
"This path is as old as the human kind."

extra {"tracks"}
"There are a lot of tracks, but you can't identify any of them."

extra{"beasts","beast"}
"It is impossible to determine what beast that did these tracks."

extra {"abyss"}
"As you look down into the abyss you can make out some sort of movement very far
below. You just hope that you will never end up down there."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west  to path2village4 descr "An old path";
east  to path2village6 descr "An old path";
south to road_1 descr "A worn out path leads south";

ALWAYS_LIGHT
end /* End of path2village5 */
/******************************************************************/
	path2village6
names {"path"}
title "Path to village"
descr
"An old worn out path which is covered with tracks of varying sizes and shapes.
It is difficult to make out exactly what creature that made these tracks, and it
makes almost impossible to tell if any humanoid has ever walked here before.
To your east you can see an entrance to a castle, this road continues west and
to your south is a great abyss."

extra {}
"This path is as old as the human kind."

extra {"castle"}
"The castle looks like it has been standing here since the dawn of time,
everything is very old and the walls look like they are going to fall down.
But some strange power seems to hold it together."

extra {"huge gate","gate"}
"The gates are crafted in some stone material, it looks like marble but that
is not possible. It would weigh hundreds of tons."

extra {"tracks"}
"There are a lot of tracks, but you can't identify any of them."

extra{"beasts","beast"}
"It is impossible to determine what beast that did these tracks."

extra {"abyss"}
"As you look down into the abyss you can make out some sort of movement very far
below. You just hope that you will never end up down there."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to path2village5 descr "An old path";
east to cas_entrance descr "The entrance to a castle";

ALWAYS_LIGHT
end /* End of path2village6 */
/******************************************************************/
/* Entrance to Ishlors castle, will link to castle-zone */
	cas_entrance
names {"entrance to castle of ishlor","entrance"}
title "Entrance to castle of Ishlor"
descr
"The castle looks like it has been standing here since the dawn of time,
everything is very old and the walls look like they are going to fall down.
But some strange power seems to hold it together. There is a huge gate in the
castle wall to the north and there is a path that leads west."

extra {"castle"}
"The castle looks like it has been standing here since the dawn of time,
everything is very old and the walls look like they are going to fall down.
But some strange power seems to hold it together."

extra {"castle wall","wall"}
"The castle wall is about to fall apart, but it somehow stays straight."

extra {"huge gate","gate"}
"The gates are crafted in some stone material, it looks like marble but that
is not possible. It would weigh hundreds of tons."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to bridge@ishlor descr "Gate of Ishlors castle." keyword {"gate"}
	 open {EX_OPEN_CLOSE,EX_CLOSED};
west to path2village6 descr "An old path";

ALWAYS_LIGHT
end /* End of cas_entrance */
/******************************************************************/
	 cas_bridge
names {"castle bridge"}
title "Castle bridge to Ishlors castle"
descr "The room needs no descriptions, you shouldn't be here!!"

flags {UNIT_FL_NO_TELEPORT}

south to cas_entrance descr "Gate to Ishlors castle.";

end  /* End of cas_bridge */
/******************************************************************
	VILLAGE IN DEMON REALM
 ******************************************************************/
	 east_gate
names {"east gate of tsaar","east gate","gate"}
title "East gate of Tsaar"
descr
"When you look around you can detect spots where lightning that has struck.
As you look closer at the town gate you can see some runes burned into it.
You recognise them as the markings of the gods, meaning that this place
has been banned from the natural world. Your guess is that is why it is here.
To you east is an old worn out path, west from here lies the village of Tsaar
and south lies a guard sentry."

extra {"gate"}
"Well, there is a gate. But it is on the ground by the side of the road.
The gate has some runes burned into it."

extra {"traces of lightning","lightning","traces"}
"The lightning seems to have struck at random, there is no pattern of any kind
and the result is devastating."

extra {"markings of the gods","markings","marking","runes"}
"These markings are actually ancient runes, but they are to old for you to
be able to understand them."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

extra {"guard sentry","sentry"}
"The entrance to an old guard sentry."

_VORTEX

flags {UNIT_FL_NO_WEATHER, UNIT_FL_NO_MOB}
movement SECT_CITY

south to east_guardcage descr "A sentry.";
west  to tsaar_road23	descr "The bounding road of Tsaar.";
east  to path2village1	descr "An old path.";

ALWAYS_LIGHT
end
/*========================================*/
	 east_guardcage
names {"east gate sentry","guard room","sentry"}
title "East gate sentry"
descr "This old guard sentry has not been used for at least a millenium maybe
even more. The roof has been destroyed by lightning so you can see the vortex
through it. The walls are covered in blood and mold, the only exit leads north
to the east gate."

extra {"blood"}
"The blood is very old. It has been on the wall for a long time."

extra {"mold"}
"There is not much mold in here. But the smell of it makes your stomach
turn inside out."

extra {"roof"}
"There is no roof! It has been completely destroyed by lightning, you can tell
by the burns."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to east_gate descr "East gate of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 north_gate
names {"north gate of tsaar","north gate","gate"}
title "North gate of Tsaar"
descr
"When you look around you can detect spots where lightning that has struck.
As you look closer at the town gate you can see some runes burned into it.
You recognise them as the markings of the gods, meaning that this place
has been banned from the natural world. Your guess is that is why it is here.
You can go south from here into the village, or east into the guard sentry.
To your north is a massive blue wall of pure energy, there is no way you can
pass it."

extra {"gate"}
"Well, there is a gate. But it is on the ground by the side of the road.
The gate has some runes burned into it."

extra {"traces of lightning","lightning","traces"}
"The lightning seems to have struck at random, there is no pattern of any kind
and the result is devastating."

extra {"markings of the gods","markings","marking","runes"}
"These markings are actually ancient runes, but they are to old for you to
be able to understand them."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

extra {"blue wall of energy","blue wall","wall of energy","wall","energy","blue"}
"The wall seems to draw its power straight from the magical vortex, you have
no way of breaking this wall down."

extra {"guard sentry","sentry"}
"The entrance to an old guard sentry."

_VORTEX

flags {UNIT_FL_NO_WEATHER, UNIT_FL_NO_MOB}
movement SECT_CITY

south to tsaar_road3 descr "The village bounding road.";

ALWAYS_LIGHT
end
/*========================================*/
	 north_guardcage
names {"north gate sentry","guard room","sentry"}
title "North gate sentry"
descr "Its walls are covered in blood and mold. It has been deserted for quite
some time."

extra {"blood"}
"The blood is very old. It has been on the wall for a long time."

extra {"mold"}
"There is not much mold in here. But the smell of it makes your stomach
turn inside out."

extra {"roof"}
"There is no roof! It has been completely destroyed by lightning, you can tell
by the burns."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}
movement SECT_CITY

west to north_gate descr "North gate of Tsaar";

ALWAYS_LIGHT
end
/******************************************************************/
	 south_gate
names {"south gate of tsaar","south gate","gate"}
title "South gate of Tsaar"
descr
"When you look around you can detect spots where lightning that has struck.
As you look closer at the town gate you can see some runes burned into it.
You recognise them as the markings of the gods, meaning that this place
has been banned from the natural world. Your guess is that is why it is here.
To your south lies a broken bridge, north lies the Tsaar village wall road and
east from here is a guard sentry."

extra {"gate"}
"Well, there is a gate. But it is on the ground by the side of the road.
The gate has some runes burned into it."

extra {"traces of lightning","lightning","traces"}
"The lightning seems to have struck at random, there is no pattern of any kind
and the result is devastating."

extra {"markings of the gods","markings","marking","runes"}
"These markings are actually ancient runes, but they are to old for you to
be able to understand them."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

extra {"broken bridge","bridge"}
"You are unable to see it clearly at this distance, maybe you should go closer."

extra {"guard sentry","sentry"}
"The entrance to an old guard sentry."

_VORTEX

flags {UNIT_FL_NO_WEATHER, UNIT_FL_NO_MOB}
movement SECT_CITY

east to south_guardcage descr "A sentry.";
north to tsaar_road17 descr "The village bounding road.";
south to broken_bridge descr "A great Abyss";

ALWAYS_LIGHT
end
/*========================================*/
	 south_guardcage
names {"south gate sentry","guard room","sentry"}
title "South gate sentry"
descr "Its walls are covered in blood and mold. It has been deserted for quite
some time."

extra {"blood"}
"The blood is very old. It has been on the wall for a long time."

extra {"mold"}
"There is not much mold in here. But the smell of it makes your stomach
turn inside out."

extra {"roof"}
"There is no roof! It has been completely destroyed by lightning, you can tell
by the burns."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}
movement SECT_CITY

west to south_gate descr "South gate of Tsaar";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road1
names {"tsaar road","road"}
title "Wall road"
descr
"A very dirty road that leads east and south, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the north and west."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

east to tsaar_road2 descr "The wall road of Tsaar.";
south to tsaar_road8 descr "The wall road od Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road2
names {"tsaar road","road"}
title "Wall road"
descr
"A very dirty road that leads east and west, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the north and to your south
is the north wall of the Tsaar jail."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west to tsaar_road1 descr "The wall road of Tsaar.";
east to tsaar_road3 descr "The village bounding road.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road3
names {"tsaar road","road"}
title "Wall road"
descr
"A very dirty road that leads east and west, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. To your north is the north entrance to the village of Tsaar and to
the south is the northern wall of the Tsaar guard office."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west to tsaar_road2 descr "The wall road of Tsaar.";
east to tsaar_road4 descr "The wall road of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road4
names {"tsaar road","road"}
title "Wall road"
descr
"A very dirty road that leads east and west, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the north and there is a
road leading south to the village square."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west to tsaar_road3 descr "The village bounding road.";
east to tsaar_road5 descr "The wall road of Tsaar.";
south to tsaar_road27 descr "Emeral lane.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road5
names {"tsaar road","road"}
title "Wall road"
descr
"A very dirty road that leads east and west, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the north and and a house
wall is to your south."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west to tsaar_road4 descr "The wall road of Tsaar.";
east to tsaar_road6 descr "The wall road of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road6
names {"tsaar road","road"}
title "Wall road"
descr
"A very dirty road that leads east and west, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. There is a great pile of junk to your south, your guess is that that
is the village dump. You are unable to move south  bacause of it and the city
walls prevent your movement north."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west to tsaar_road5 descr "The wall road of Tsaar.";
east to tsaar_road7 descr "The wall road of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road7
names {"tsaar road","road"}
title "Wall road"
descr
"A very dirty road that leads west and south, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the north and east."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west to tsaar_road6 descr "The wall road of Tsaar.";
south to tsaar_road21 descr "The wall road of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road8
names {"tsaar road","road"}
title "Wall road"
descr
"A very dirty road that leads north and south, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the west. To your east is the
back side of the Tsaar jail, you can see that the wall has been reinforced to
prevent jail breaks."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road1 descr "The wall road of Tsaar.";
south to tsaar_road9 descr "The wall road of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road9
names {"tsaar road","road"}
title "Wall road"
descr
"A very dirty road that leads north and south, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the west and to your east is
a great poster on a wall."

extra {"poster on wall","poster","wall"}
"The poster holds the picture of a person on top some beast, you can't make out
exactly what it is because the color is so old and weak."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road8 descr "The wall road of Tsaar.";
south to tsaar_road10 descr "The wall road of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road10
names {"tsaar road","road"}
title "Wall road"
descr
"A very dirty road that leads north and south, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the west. To your east goes
the main road of Tsaar towards the village square."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road9 descr "The wall road of Tsaar.";
south to tsaar_road11 descr "The wall road of Tsaar.";
east to main_road1 descr "Main road.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road11
names {"tsaar road","road"}
title "Wall road"
descr
"A very dirty road that leads north and south, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the west. To your east is
the entrance to the Tsaar armoury."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road10 descr "The wall road of Tsaar.";
south to tsaar_road12 descr "The wall road of Tsaar.";
east to  tsaar_armory descr "The Tsaar Armory.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road12
names {"tsaar road","road"}
title "Wall road"
descr
"A very dirty road that leads north and south, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. To your east is the entrance to the Tsaar weaponry. The city walls
prevent your movement to the west."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road11 descr "The wall road of Tsaar.";
south to tsaar_road13 descr "The wall road of Tsaar.";
east to tsaar_weaponry descr "The Tsaar weaponry.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road13
names {"tsaar road","road"}
title "Wall road"
descr
"A very dirty road that leads north and south, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the west and to your east
is the Tsaar bazaar."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road12 descr "The wall road of Tsaar.";
south to tsaar_road14 descr "The wall road of Tsaar.";
east to tsaar_road28 descr "The Tsaar bazaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road14
names {"tsaar road","road"}
title "Wall road"
descr
"The road leads from the north to east and is very dirty, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the south and west."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road13 descr "The wall road of Tsaar.";
east to tsaar_road15 descr "The wall road of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road15
names {"tsaar road","road"}
title "Wall road"
descr
"The road leads from the east to west and is very dirty, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the south. To your north is
the Tsaar bazaar."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west to tsaar_road14 descr "The wall road of Tsaar.";
east to tsaar_road16 descr "The wall road of Tsaar.";
north to tsaar_road28 descr "The Tsaar bazaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road16
names {"tsaar road","road"}
title "Wall road"
descr
"The road leads from the east to west and is very dirty, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the south and the southern
wall of the Tsaar magic shop prevents you from going north."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west to tsaar_road15 descr "The wall road of Tsaar.";
east to tsaar_road17 descr "The village bounding road.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road17
names {"tsaar road","road"}
title "Wall road"
descr
"The road leads from the east to west and is very dirty, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. To your south is the southern entrance of the village and to your
north is a dark alley."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west  to tsaar_road16 descr "The wall road of Tsaar.";
east  to tsaar_road18 descr "The wall road of Tsaar.";
south to south_gate   descr "The south gate of Tsaar.";
north to dark_alley1   descr "A dark alley.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road18
names {"tsaar road","road"}
title "Wall road"
descr
"The road leads from the east to west and is very dirty, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the south. To your north is
the entrance to the Tsaar church called 'The Fallen Angel'."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west  to tsaar_road17 descr "The village bounding road.";
east  to tsaar_road19 descr "The wall road of Tsaar.";
north to tsaar_church descr "The Fallen Angel";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road19
names {"tsaar road","road"}
title "Wall road"
descr
"The road leads from the east to west and is very dirty, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The walls of the Tsaar church prevents your movement north and the
city walls stops you from going south."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west to tsaar_road18 descr "The wall road of Tsaar.";
east to tsaar_road20 descr "The wall road of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road20
names {"tsaar road","road"}
title "Wall road"
descr
"The road leads from the north to west and is very dirty, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the south and east."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road26 descr "The wall road of Tsaar.";
west to tsaar_road19 descr "The wall road of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road21
names {"tsaar road","road"}
title "Wall road"
descr
"The road leads from the north to south and is very dirty, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the east. To your west is the
Tsaar dump and you can't enter it bacause of all the garbage."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road7 descr "The wall road of Tsaar.";
south to tsaar_road22 descr "The wall road of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road22
names {"tsaar road","road"}
title "Wall road"
descr
"The road leads from the north to south and is very dirty, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the east. To your west stands
the mighty house of the ancient demonologist guild."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road21 descr "The wall road of Tsaar.";
south to tsaar_road23 descr "The bounding road of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road23
names {"tsaar road","road"}
title "Wall road"
descr
"The road leads from the north to south and is very dirty, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. To your west is the main road of Tsaar which leads to the village
square and to your east is the eastern entrance to the village."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road22 descr "The wall road of Tsaar.";
south to tsaar_road24 descr "The wall road of Tsaar.";
east  to east_gate	  descr "The east gate of Tsaar.";
west  to main_road3   descr "Main road.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road24
names {"tsaar road","road"}
title "Wall road"
descr
"The road leads from the north to south and is very dirty, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the east and a house wall
stops you from going west."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road23 descr "The bounding road of Tsaar.";
south to tsaar_road25 descr "The wall road of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road25
names {"tsaar road","road"}
title "Wall road"
descr
"The road leads from the north to south and is very dirty, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The city walls prevent your movement to the east and to your west is
a smaller road."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road24 descr "The wall road of Tsaar.";
south to tsaar_road26 descr "The wall road of Tsaar.";
west  to deadend	  descr "It is a dead end.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road26
names {"tsaar road","road"}
title "Wall road"
descr
"The road leads from the north to south and is very dirty, it has been used by
the guards to patrol the city and keep watch. There is no real light source
here, so the only thing that illuminates this road is the gigantic vortex above
you. The lack of light makes you feel as if you are gonna be jumped by some hideous
beast. The walls of the church stands to your west and the city walls prevent
your movement to the east."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road25 descr "The wall road of Tsaar.";
south to tsaar_road20 descr "The wall road of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road27
names {"emerald lane"}
title "Emerald lane"
descr
"Above your head hangs a big sign which says 'Emerald Lane'. The road leads from
the northen part of Tsaar to the village square. To your east is the western
wall of an old store of miscellaneous items, and to your west is the entrance
to the Tsaar cityguards office."

extra {"big sign","sign"}
"An old sign, which for some reason you are still able to read. The sign
says:&n
Emerald Land - Founded in the year of the great dragon."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road4 descr "The wall road of Tsaar.";
south to village_sq1 descr "Village Square.";
west  to tsaar_guard descr "The Tsaar guard office";

ALWAYS_LIGHT
end
/******************************************************************/
	 tsaar_road28
names {"tsaar bazaar","bazaar"}
title "Tsaar bazaar"
descr
"From the looks of it this place has been used by tradesmen and merchants to
haggle for a long time. But since the village is now deserted your guess is
that this place has not been used since the early days of the human race. To your
east is the Tsaar magic store and to your north is a wall of the Tsaar Weaponry
which blocks your way."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west to tsaar_road13 descr "The wall road of Tsaar.";
south to tsaar_road15 descr "The wall road of Tsaar.";
east to magic_store descr "The Tsaar Vortex";

ALWAYS_LIGHT
end
/******************************************************************/
	 dark_alley1
names {"dark alley","alley"}
title "Dark alley"
descr
"This place smells awful, and as you look around you try to find the
source of the smell. But you are unable to locate it. The dark alley continues
to the north. To your east and west stands houses so you can't walk in those
directions, the alley also leads south to the wall road of Tsaar."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

north to dark_alley2 descr "A dark alley.";
south to tsaar_road17 descr "The wall road os Tsaar.";

IN_ALWAYS_DARK
end
/******************************************************************/
	 dark_alley2
names {"dark alley","alley"}
title "Dark alley"
descr
"As you arrive from the south the vile smell gets even stronger and you have a
hard time breathing. This place could be dangerous to your physical health, so
you decide that you won't stay in this place longer than needed. The alley leads
south and you have house wall to your east, west and north which prevent your
movement in those directions."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

south to dark_alley1 descr "A dark alley.";

OUT_ALWAYS_DARK
end
/******************************************************************/
	 deadend
names {"dead end"}
title "Tsaar dead end"
descr
"A dead end. It looks as if this place has been used by thiefs a long
time ago, the reason for this is that you can make out some smaller so called
hidden compartments in the walls. But time has taken it is turn so the loose
bricks have been removed and lost. The only exit is to the east and you have
house walls in the other 3 general directions."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

east to tsaar_road25 descr "The wall road of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 village_sq1
names {"tsaar square","village square","square"}
title "Tsaar square"
descr
"The north-western part of the Tsaar village square, this place has been
used for public executions and all other kinds of public amusements. To your
west is the ruins of a Jewelry store, ot your east and south is the village square
and yo out north goes the emerald lane."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to tsaar_road27 descr "Emerald lane.";
south to village_sq3 descr "Tsaar Village square.";
east  to village_sq2 descr "Tsaar Village square.";
west  to jeweler descr "Ainas Jewels";

ALWAYS_LIGHT
end
/******************************************************************/
	 village_sq2
names {"tsaar square","village square","square"}
title "Tsaar square"
descr
"You stand at the north-eastern part of the Tsaar village square, this place has been
used for public executions and all other kinds of public amusements. To your
north is the remains of a store of miscellaneous items and to your east stands the mighty
house of the demonologists guild. The village square continues to your south
and west."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

east  to demonic_guild descr "The entrance to the demonologists guild.";
west  to village_sq1	descr "Village square.";
south to village_sq4	descr "Village square.";
north to hardware_store descr "Entrance to Ruthgers store of miscellaneous items.";

ALWAYS_LIGHT
end
/******************************************************************/
	 village_sq3
names {"tsaar square","village square","square"}
title "Tsaar square"
descr
"The south-western part of the Tsaar village square is just as messy as the
rest of this village, this place has been used for public executions as well
as other kinds of public amusements. The village square continues to your
north and east or you may follow the main road west. To the south is the
entrance to the mayor's house."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

extra {"tsaar village square","village square","square"}
"This is the place, you are standing on it."

extra {"entrance to the mayor's house","entrance","mayor's house","house"}
"The entrance is badly damaged, the fasad has been torn to pieces and the door
is almost completely smashed."

extra {"fasad"}
"The fasad is almost destroyed, just some pieces of the decoration is left."

extra {"decoration"}
"It has been smashed."

extra {"door"}
"Not much of a door, but it is still there."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to village_sq1 descr "Village square.";
east  to village_sq4 descr "Village square.";
west  to main_road2 descr "Main road.";
south to mayor_floor1 open {EX_OPEN_CLOSE,EX_CLOSED} keyword {"door"};

ALWAYS_LIGHT
end
/******************************************************************/
	 village_sq4
names {"tsaar square","village square","square"}
title "Tsaar square"
descr
"You are at the south-eastern part of the Tsaar village square, this place has been
used for public executions and all other kinds of public amusements.
The main road of Tsaar runs east from here while the square continues to the north and west. You see a
food store to the south."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west to village_sq3 descr "Village square.";
north to village_sq2 descr "Village square.";
east to main_road3 descr "Main road.";
south to food_store descr "A food store.";

ALWAYS_LIGHT
end
/******************************************************************/
	 main_road1
names {"tsaar main road","main road","road"}
title "Tsaar main road"
descr
"The main road of Tsaar. It leads from the east to the west edge of the
village. To your north and south stands the ruins of two houses but their walls
are still strong enough to prevent you from moving in either if those directions.
To your east continues the main road and to your west lies the wall road of Tsaar."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west to tsaar_road10 descr "The wall road of Tsaar.";
east to main_road2 descr "Main road.";

ALWAYS_LIGHT
end
/******************************************************************/
	 main_road2
names {"tsaar main road","main road","road"}
title "Tsaar main road"
descr
"The main road of Tsaar leads from the east to the west edge of the village.
To your north is the southern wall of the Tsaar jewelery store. It looks like
the wall was used to put messages on but the age of the papers has made the
ink fade away. The Tsaar main road continues to your west and eastwards lies
the village square. South from this point is the once beautiful Tsaar bank,
it looks as if it has been looted a long time ago."

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"jewelery store","store"}
"The northern house is the Tsaar jewelery."

extra {"north wall","wall"}
"This bulletin board is as old as the road you are standing on. You try to make
out what the old papers way but it is impossible to read them. The ink is to
vague."

extra {"papers","paper","ink"}
"The ink on the papers is so old that you are unable to make out what they
used to say."

extra {"tsaar bank","bank"}
"The entrance to the bank was once a very beautiful view, but now it has been
completely ruined."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

extra {"village square","square"}
"East from here lies the village square."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west  to main_road1 descr "Main road.";
east  to village_sq3 descr "South west part of the village square.";
south to bank_of_tsaar descr "Entrance to the bank of Tsaar.";

ALWAYS_LIGHT
end
/******************************************************************/
	 main_road3
names {"tsaar main road","main road","road"}
title "Tsaar main road"
descr
"You are standing on the main road of Tsaar, it leads from the east to the west
edge of the village. To your north stands the mighty house of the demonologist
guild. The main road leads west to the village square and east to the wall road
of Tsaar. South from here lies the ruin of an Inn."

extra {"old sign on ground","sign on ground","old sign","sign"}
"This sign has been erased by time, you can make out the words:
TH	FLY N  PI  - A l adve  ur rs  elco e."
/* THE FLYING PIG - All adventurers welcome. */

extra {"road"}
"The road is covered with a black stone material, which seems to act as some
sort of protection to the real road."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

extra {"village square","square"}
"West from here lies the village square."

_VORTEX

flags {UNIT_FL_NO_WEATHER}
movement SECT_CITY

west to village_sq4 descr "Village square.";
east to tsaar_road23 descr "The bounding road of Tsaar.";
south to ruin_inn1 descr "An old inn.";

ALWAYS_LIGHT
end
/******************************************************************/
	 ruin_inn1
names {"first floor of tsaar inn","tsaar inn","inn"}
title "First floor of Tsaar inn"
descr
"When you enter the wind from the door makes the dust in here fly around
so you can't see a thing for 30 seconds, but when the dust has settled you
you see the tables, chairs and the old bar. There are stairs that lead up.
This used to be an inn, but as it has been deserted for such a long time
it now looks more like an old shaft. There are some stairs leading up and
the only other exit is to the north, which leads to the main road."

extra {"dust"}
"Thie place is full of it."

extra {"tables","chairs","table","chair"}
"The furniture is not intact enough to be used."

extra {"old bar","bar"}
"This used to be the place to buy beer and other amusing liquids in this village,
but that is no longer possible."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to main_road3 descr "The Main road.";
up to ruin_inn2 descr "Up to floor 2. Sleeping room.";

ALWAYS_LIGHT
end
/******************************************************************/
	 ruin_inn2
names {"second floor of tsaar inn","tsaar inn","inn"}
title "Second floor of Tsaar inn"
descr
"This place is a large sleeping room where up to 50 people can sleep on small
benches, you can't even imagine that people actually paid to be able to sleep
like this. It must have been a thiefs paradise to just walk around and loot
people while they were sleeping.Even sleeping outside a dragons cave must have
been more safe than this place. There are stairs leading down."

extra {"benches","bench"}
"As you examine it you realise that it would never hold for your weight, it is
to old."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}
movement SECT_CITY

down to ruin_inn1 descr "Down to floor 1. Eating room.";

ALWAYS_LIGHT
end
/******************************************************************/
	 food_store
names {"tsaar food store","food store"}
title "Tsaar food store"
descr
"This was once a food store. You can tell by the sign that are hanging in
front of diffrent shelves. Now everything is empty and full of dust. The
only thing that seems to be intact are the shelves."

extra {"shelves","shelf"}
"These shelves holds nothing but dust."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

extra {"dust"}
"There is plenty of dust in here."

extra {"signs","sign"}
"The signs read 'Melons','Apples','Oranges','Pears','Bread','Milk'."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}
movement SECT_CITY

north to village_sq4 descr "The Village square.";

ALWAYS_LIGHT
end
/******************************************************************/
	 mayor_floor1
names {"mayors house","mayor's house"}
title "Mayor's house"
descr
"It looks like this house used to have very large furniture, you can
tell by the markings on the floor. Further back there are stairs leading
up to the next floor. On the south wall there is a painting. There is a door
leading north to the village square."

extra {"furniture"}
"There are no furniture in here."

extra {"markings"}
"There are holes in the floor where the furniture stood before."

extra {"stairs"}
"The stairs to the next floor."

extra {"painting","wall"}
"It is a painting of a man, most likely the mayor. He is standing in front
of a house. You can see children playing in the back. Strange, why did
the person that looted this house leave the painting."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}
movement SECT_INSIDE

north to village_sq3 open {EX_OPEN_CLOSE,EX_CLOSED} keyword {"door"};
up to mayor_floor2 descr "Second floor of Mayors house.";

ALWAYS_LIGHT
end /* End of Mayors house floor 1 */
/*=======================================================*/
	 mayor_floor2
names {"mayors house","mayor's house"}
title "Second floor"
descr
"This place is really a mess, the furniture is still here but it has
been completely smashed. You can see what's left of a rope hanging from the
ceiling. The only exit from here is down to the first floor of this house."

extra {"furniture"}
"The so called furniture is here, but it is in pieces on the floor. Not of
much use to anyone."

extra {"rope"}
"It looks like a noose, but you are unable to reach it."

extra {"ceiling"}
"It is very high to the ceiling in here."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}

down to mayor_floor1 descr "First floor of Mayors house..";

ALWAYS_LIGHT
end /* End of Mayors house floor 2 */
/******************************************************************/
	 hardware_store
names {"ruthgers shop","hardware store"}
title "Ruthgers Hardware store"
descr
"The remainings of a hardware store. You can see a counter and some shelves, but
that is it. There is an exit to the south which leads to the village square."

extra {"counter"}
"The standard store counter, although this one is a bit smashed up."

extra {"shelves"}
"Empty shelves, the only thing that is for sale here is dust."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}

south to village_sq2 descr "The village square.";

ALWAYS_LIGHT
end /* End of hardware store */
/******************************************************************/
	 jeweler
names {"ainas jewels","jeweler"}
title "Ainas Jewels"
descr
"Well not much of a jewelery store, it has been swiped clean. There
is not even dust in here. You realise that this must have been the real
target for the looters, they did not even leave the furniture here. Only exit
leads east to the village square."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}

east to village_sq1 descr "The village square.";

ALWAYS_LIGHT
end /* End of jeweler */
/******************************************************************/
	 bank_of_tsaar
names {"bank of tsaar","bank"}
title "Bank of Tsaar"
descr
"This place has been destroyed completely by looters. Even the tables and chairs
have been destroyed in search for money. The south wall is covered in debris.
You can make out a steel construction from behind the debris, to your north is
the main road of Tsaar. There is an eblem carved into the east wall."

extra {"debris","chairs","chair","tables","table"}
"The debris is from chairs, tables and other misc. items that have been smashed."

extra {"steel construction","steel","construction"}
"When you examine it you realise that it is a vault door."

extra {"south wall","wall"}
"This wall is completey covered in debris."

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

extra {"east wall","wall","emblem"}
"The second you look at this emblem, you realise that it is a magic magnet. It
prevents all casting of spells."

extra {"vault door","vault"}
"The vault door is solid steel, it has a small wheel in the middle."

extra {"small wheel","wheel"}
"This is a small wheel with numbers on it, the number range from 0 to 9.&n
(To turn type: turn wheel <left|right> <number>."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}

north to main_road2 descr "The main road of Tsaar.";
south to treasury open {EX_OPEN_CLOSE,EX_CLOSED,EX_LOCKED,EX_PICKPROOF} keyword "Vault Door";

dilbegin aware vault();
var
   stat : integer;
   user : unitptr;
   args : stringlist;
   dirl : stringlist;
   dirr : stringlist;
   posn : stringlist;
   posd : stringlist;
   vals : stringlist;
code{
	dirl:={"left","lef","le","l"};
	dirr:={"right","righ","rig","ri","r"};
	vals:={"0","1","2","3","4","5","6","7","8","9"};
	stat:=0;
	posn:={VAULT_COMBN};
	posd:={VAULT_COMBD};
	heartbeat:=PULSE_SEC*5;
	interrupt(SFB_CMD,command("reset") and (argument=="wheel"),stat_res);
	interrupt(SFB_CMD,command("turn") and ("wheel" in argument),crack_code);
	interrupt(SFB_CMD,command(CMD_OPEN) and ("vault"==argument),open_door);
	interrupt(SFB_CMD,command(CMD_CLOSE) and ("vault"==argument),close_door);
	interrupt(SFB_CMD,command("cast"),no_magic);
	interrupt(SFB_CMD,command(CMD_PICK),pick_nope);
	interrupt(SFB_CMD,command("smash"),no_smash);
	interrupt(SFB_MSG,(activator.title=="vault closer") and ("close"==argument),close_vault);
  :start:
	pause;
	goto start;

  :close_vault:
	user:=findsymbolic("morgia@demon_realm");
	if(user.outside==self)
	 if(user!=null)
	 {
	  if(not (isset(self.exit_info[SOUTH],EX_CLOSED)))
           act("You hear a low humming sound as the vault door closes.",A_SOMEONE,user,null,null,TO_ALL);
	  if(not (isset(self.exit_info[SOUTH],EX_LOCKED)))
           act("*cluck* *cluck* *cluck*",A_SOMEONE,user,null,null,TO_ALL);
	  set(self.exit_info[SOUTH],EX_CLOSED);
	  set(self.exit_info[SOUTH],EX_LOCKED);
	  set(self.exit_to[SOUTH].exit_info[NORTH],EX_CLOSED);
	  set(self.exit_to[SOUTH].exit_info[NORTH],EX_LOCKED);
	  stat:=0;
	 }
	goto start;

  :no_magic:
	block;
        act("You see a small emblem glow on the east wall.",A_SOMEONE,activator,null,null,TO_ALL);
	goto start;

  :no_smash:
	if(((argument!="vault") and (argument!="door")) and (argument!="south"))
	 goto start;
	block;
        act("You throw yourself at the steel door. OUCH!",A_SOMEONE,activator,null,null,TO_CHAR);
	act("$1n throws $1sself at the steel door, ouch. That must have hurt!",
                 A_SOMEONE,activator,null,null,TO_REST);
	goto start;

  :crack_code:
	if(stat==VAULT_MAX)
	{
	 block;
	 if(isset(self.exit_info[SOUTH],EX_CLOSED))
	 {
	  set(self.exit_info[SOUTH],EX_LOCKED);
	  set(self.exit_info[SOUTH],EX_CLOSED);
	  set(self.exit_to[SOUTH].exit_info[NORTH],EX_LOCKED);
	  set(self.exit_to[SOUTH].exit_info[NORTH],EX_CLOSED);
          act("*cluck* *cluck* *cluck*",A_SOMEONE,activator,null,null,TO_ALL);
          act("Dont you feel silly, you just locked the Vault.",A_SOMEONE,activator,null,null,TO_CHAR);
	  stat:=0;
	 }
	 else
	 {
          act("The vault door is already open!",A_SOMEONE,activator,null,null,TO_CHAR);
	 }
	 goto start;
	}
	args:=getwords(argument);
	if(length(args)<3)
	{
	 block;
         act("To turn wheel type:'turn wheel <left|right> <number>'",A_SOMEONE,activator,null,null,TO_CHAR);
         act("note! number has to be in the range of 0-9",A_SOMEONE,activator,null,null,TO_CHAR);
	 goto start;
	}
	if((args.[0]!="wheel") or
	   (not(args.[1] in dirr) and not(args.[1] in dirl)) or
	   (not(args.[2] in vals)))
	{
	 block;
         act("To turn wheel type:'turn wheel <left|right> <number>'",A_SOMEONE,activator,null,null,TO_CHAR);
         act("note! number has to be in the range of 0-9",A_SOMEONE,activator,null,null,TO_CHAR);
	 goto start;
	}
	block;
	if(args.[2]!=posn.[stat])
	{
	 stat:=0;
         act("Wrrr...",A_SOMEONE,activator,null,null,TO_ALL);
	 goto start;
	}
	if(((args.[1] in dirl) and (posd.[stat]!="l")) or
	   ((args.[1] in dirr) and (posd.[stat]!="r")))
	{
         act("Wrrr...",A_SOMEONE,activator,null,null,TO_ALL);
	 goto start;
	}
	stat:=stat+1;
	if(stat<VAULT_MAX)
	{
         act("*cluck*",A_SOMEONE,activator,null,null,TO_ALL);
	 goto start;
	}
        act("*click*",A_SOMEONE,activator,null,null,TO_ALL);
	unset(self.exit_info[SOUTH],EX_LOCKED);
	unset(self.exit_to[SOUTH].exit_info[NORTH],EX_LOCKED);
	goto start;

  :pick_nope:
	if((argument!="vault") and (argument!="door"))
	 goto start;
	block;
	act("How are you planning to pick something that dont have a lock?",
                 A_SOMEONE,activator,null,null,TO_CHAR);
	goto start;

  :close_door:
	block;
	if(isset(self.exit_info[SOUTH],EX_CLOSED))
	{
         act("The door is already closed!",A_SOMEONE,activator,null,null,TO_CHAR);
	 goto start;
	}
        act("You close the vault door.",A_SOMEONE,activator,null,null,TO_CHAR);
        act("$1n' closes the vault door.",A_SOMEONE,activator,null,null,TO_REST);
	set(self.exit_info[SOUTH],EX_CLOSED);
	set(self.exit_to[SOUTH].exit_info[NORTH],EX_CLOSED);
	goto start;

  :open_door:
	block;
	if(isset(self.exit_info[SOUTH],EX_CLOSED) and
	   isset(self.exit_info[SOUTH],EX_LOCKED))
	{
         act("The vault door is locked.",A_SOMEONE,activator,null,null,TO_CHAR);
	 goto start;
	}
	if(isset(self.exit_info[SOUTH],EX_CLOSED) and
	   not (isset(self.exit_info[SOUTH],EX_LOCKED)))
	{
	 unset(self.exit_info[SOUTH],EX_CLOSED);
	 unset(self.exit_to[SOUTH].exit_info[NORTH],EX_CLOSED);
         act("$1n opens the vault door.",A_SOMEONE,activator,null,null,TO_REST);
         act("You open the vault door.",A_SOMEONE,activator,null,null,TO_CHAR);
	}
	else
         act("The vault door is already open.",A_SOMEONE,activator,null,null,TO_CHAR);
	goto start;

  :stat_res:
	block;
	if(isset(self.exit_info[SOUTH],EX_CLOSED) and
	   isset(self.exit_info[SOUTH],EX_LOCKED))
	 stat:=0;
	else
	if(isset(self.exit_info[SOUTH],EX_CLOSED) and
	  not (isset(self.exit_info[SOUTH],EX_LOCKED)))
	{
	 set(self.exit_info[SOUTH],EX_LOCKED);
	 set(self.exit_to[SOUTH].exit_info[NORTH],EX_LOCKED);
	 stat:=0;
	}
	goto start;
}
dilend

ALWAYS_LIGHT
end /* End of Bank */
/******************************************************************/
	 treasury
names {"tsaar treasury","treasury"}
title "Tsaar treasury"
descr
"The vault to the bank. This place has not been smashed up so you guess
that none of the earlier looters found this place. This place has not been
affected by the time that has passed since this village was destroyed. Only
exit from here leads north to the bank."

extra {"vault to the bank","vault"}
"You are in it!"

extra {"village of tsaar","village"}
"This is the ghost village of Tsaar."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER, UNIT_FL_NO_TELEPORT}

north to bank_of_tsaar open {EX_OPEN_CLOSE,EX_CLOSED,EX_LOCKED} keyword "Vault door";

dilbegin vault_inside();
code{
	heartbeat:=PULSE_SEC*3;
	interrupt(SFB_CMD,command(CMD_OPEN),test_open);
	interrupt(SFB_CMD,command(CMD_CLOSE) and ("vault"==argument),close_door);
	interrupt(SFB_CMD,command(CMD_PICK),pick_nope);
	interrupt(SFB_CMD,command("smash"),no_smash);
  :start:
	pause;
	goto start;

  :no_smash:
	if(((argument!="vault") and (argument!="door")) and (argument!="north"))
	 goto start;
	block;
        act("You throw yourself at the steel door. OUCH!",A_SOMEONE,activator,null,null,TO_CHAR);
	act("$1n throws $1sself at the steel door, ouch. That must have hurt!",
                 A_SOMEONE,activator,null,null,TO_REST);
	goto start;

  :pick_nope:
	if((argument!="vault") and (argument!="door"))
	 goto start;
	block;
	act("How are you planning to pick something that dont have a lock?",
                 A_SOMEONE,activator,null,null,TO_CHAR);
	goto start;

  :close_door:
	block;
	if(isset(self.exit_info[SOUTH],EX_CLOSED))
	{
         act("The door is already closed!",A_SOMEONE,activator,null,null,TO_CHAR);
	 goto start;
	}
        act("You close the vault door.",A_SOMEONE,activator,null,null,TO_CHAR);
        act("$1n' closes the vault door.",A_SOMEONE,activator,null,null,TO_REST);
	set(self.exit_info[SOUTH],EX_CLOSED);
	set(self.exit_to[SOUTH].exit_info[NORTH],EX_CLOSED);
	goto start;

  :test_open:
	if((argument!="vault") and (argument!="door"))
	 goto start;
	if(isset(self.exit_info[NORTH],EX_CLOSED) and
	   isset(self.exit_info[NORTH],EX_LOCKED))
	{
	 block;
         act("YOU CANT!! You trapped in here.",A_SOMEONE,activator,null,null,TO_CHAR);
	 act("$1n panics as $1s is unable to open the vault door!",
                  A_SOMEONE,activator,null,null,TO_REST);
	 goto start;
	}
	if(isset(self.exit_info[NORTH],EX_CLOSED) and
	   not (isset(self.exit_info[NORTH],EX_LOCKED)))
	{
	 block;
         act("You open the vault door. It is heavy!",A_SOMEONE,activator,null,null,TO_CHAR);
         act("$1n opens the vaukt door. BARELY!",A_SOMEONE,activator,null,null,TO_REST);
	 unset(self.exit_info[NORTH],EX_CLOSED);
	 unset(self.exit_to[NORTH].exit_info[SOUTH],EX_CLOSED);
	 goto start;
	}
	if(not (isset(self.exit_info[NORTH],EX_CLOSED)))
	{
	 block;
         act("It is already open!",A_SOMEONE,activator,null,null,TO_CHAR);
	 goto start;
	}
	goto start;
}
dilend

OUT_ALWAYS_DARK
end /* End of Treasury */
/******************************************************************/

/******************************************************************/
	 broken_bridge
names {"broken bridge","bridge"}
title "Broken Bridge"
descr
"You stand by a great Abyss, as you look down into the dark you hear
a horrifying scream. There is a broken bridge here, and as you look around
you realize that the bridge was the only way across."

extra {"bridge"}
"There is no bridge across this abyss."

extra {"great abyss","abyss"}
"When you look down into the abyss, you can make out movement way below.Y
You stare for a long time to let your eyes adjust to the poor light, but you
are unable to make out a bottom."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

north to south_gate descr "North to south gate of Tsaar.";

ALWAYS_LIGHT
end /* End of Broken Bridge */
/******************************************************************/
	tsaar_armory
names {"tsaar armory","tsaar armoury","armory","armoury"}
title "Tsaar Armory"
descr "This place is a mess just like everything else in this village. The armor
racks have been smashed and are now spread across the floor. You won't find
anything in this mess. The only exit is to your west which leads to the wall
road of Tsaar."

extra {"armor racks","racks","rack"}
"These racks have been treated very poorly, they are completely smashed."

extra {"floor"}
"You try to find the floor, but all the trash stops you."

extra {"trash"}
"Yeah, the floor is full of it."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}

west to tsaar_road11 descr "The wall road of Tsaar.";

ALWAYS_LIGHT
end /* End of Armory */
/******************************************************************/
	 tsaar_weaponry
names {"tsaar weaponry","weaponry"}
title "Tsaar Weaponry"
descr "You look around, but can't find anything.
This place has been swept clean! The only exit is to your west which leads
to the wall road of Tsaar."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}

west to tsaar_road12 descr "The wall road of Tsaar.";

ALWAYS_LIGHT
end  /* End of Weaponry */
/******************************************************************/
	 magic_store
names {"magic shop","magic store","shop","store"}
title "Tsaar Vortex"
descr "This store is strangly enough really tidy and clean. The shelves are empty
but there is no dust on them. There is no counter, and strangly enough.. No debris
from one either. Only exit is to your west, it leads to the Tsaar bazaar."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}

west to tsaar_road28 descr "The Tsaar Bazar";

dilbegin check_drop();
var
   pc  : unitptr;
   obj : unitptr;
   sto : integer;
   nam : string;
code{
  :init:
	heartbeat:=PULSE_SEC*10;
  :start:
	wait(SFB_DONE,command("drop") and (argument!=""));
	pc:=activator;
	obj:=findunit(activator,medium.name,FIND_UNIT_SURRO,null);
	if(obj==null) goto init;

	secure(pc,ret);
	secure(obj,ret);
	nam:=obj.name;
        act("A shimmering cloud embraces "+nam+".",A_SOMEONE,pc,null,null,TO_ALL); pause;
	unsecure(obj);
	destroy(obj);
        act("There is a sudden burst of light and the "+nam+" is gone.",A_SOMEONE,pc,null,null,TO_ALL);
	unsecure(pc);
	goto start;

  :ret:
	unsecure(obj);
	unsecure(pc);
	goto start;
}
dilend

ALWAYS_LIGHT
end  /* End of Magic Store */
/******************************************************************/
	 tsaar_church
names {"tsaar church","church"}
title "Tsaar church"
descr "An old abandoned church with barred windows and steel ceiling. As you
examine the place you com to the conclusion that there has not been a real
religous ceremony in here for quite some time. This place seems like a good
place to rest and regain your strength. To your east is a donation room and
to the south lies the wall road of Tsaar."

extra {"windows","window"}
"The windows have steel bars on both the inside and outside to prevent unwanted
things to enter."

extra {"steel ceiling","ceiling"}
"The ceiling is made conpletely out of steel, it prevents any sort of
teleportation from this room."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER, UNIT_FL_NO_TELEPORT,UNIT_FL_NO_MOB}
flags {UNIT_FL_SACRED}


east to  tsaar_don_room descr "The Fallen Angel donation room";
south to tsaar_road18 descr "The Wall road of Tsaar";

SECRET_DOOR_DIFFICULTY(UP, 100)
up to clan_home_025@clans
keyword {"ceiling"} open {EX_OPEN_CLOSE, EX_CLOSED, EX_HIDDEN} descr
"Something funny...";

ALWAYS_LIGHT
end  /* End of Tsaar Church */
/******************************************************************/
	 tsaar_don_room
names {"tsaar donation room","donation room"}
title "Tsaar donation room"
descr "This is a sacred place where players leave equipment that they dont need
but think other players might. The tsaar church lies to your west."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER, UNIT_FL_NO_TELEPORT}

dilbegin prev_getall();
code{
   :loop:
	 wait(SFB_CMD,command(CMD_GET) and (argument=="all"));
	 block;
         act("Get all command not allowed in donation room.",A_SOMEONE,activator,null,null,TO_ALL);
	 goto loop;
}
dilend

west to tsaar_church descr "The Fallen Angel";

ALWAYS_LIGHT
end  /* End of Tsaar Donation Room */
/******************************************************************/
	 tsaar_guard
names {"tsaar guard office","guard office"}
title "The Tsaar guard office"
descr "The guard office has been completely destroyed, There is an empty
space on the wall where the wanted board used to be. To your east lies the
emerald lane and behind the western door lies the Tsaar jail."

extra {"wanted board","board","wall"}
"The wanted board has been torn down by someone or something, so now there is
a clean spot on the wall where it used to be."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}

west to tsaar_jail open {EX_OPEN_CLOSE,EX_CLOSED,EX_LOCKED,EX_PICKPROOF}
	keyword{"door"};
east to tsaar_road27 descr "The Emerald lane";

ALWAYS_LIGHT
end  /* End of Tsaar Guard Office */
/******************************************************************/
	 tsaar_jail
names {"tsaar jail","jail"}
title "The Tsaar jail."
descr "This jail has not been used in thousands of years and you feel a bit silly
standing in here for no reason. This place reminds you of your youth, and all
the stupid things you did. The only exit is to the east and it leads to the
Tsaar Guards office."

dilbegin no_cmd();
var
   pc : unitptr;

code{
   :init:
	 interrupt(SFB_CMD,command(CMD_CAST),no_magic);
   :loop:
	 pause;
	 goto loop;

   :no_magic:
	 block;
	 pc:=activator;
         act("This is a no magic room",A_SOMEONE,pc,null,null,TO_CHAR);
	 goto loop;
}
dilend

east to tsaar_guard open {EX_OPEN_CLOSE,EX_CLOSED,EX_LOCKED,EX_PICKPROOF}
	keyword{"door"};

ALWAYS_LIGHT
end  /* End of Tsaar Jail */
/******************************************************************/
	 demonic_guild
names {"demonic guild","guild"}
title "The Demonic guild entrance"
descr "The entrance to the guild of the demonologists, they were a powerful
group of people that devoted their life to total destruction of all demons.
When the gods of VALHALLA destroyed the temple of olympus the guildmasters of
this guild tried to stop them, they were all killed. There is a small sqare
in the east corner which looks diffrent somehow. Some day this guild might
return, if only the few followers gather and rebuild the power of this guild.
The stairs leading down are totally destroyed."

extra {"stairs"}
"There aren't any!! They have been destroyed."

extra {"square","east corner"}
"Someone has been here not so long ago, there seems to be some sort of hatch
here."

_VORTEX

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER}

west to village_sq2 descr "The tsaar village square";
up to guild_attic open {EX_OPEN_CLOSE,EX_CLOSED,EX_HIDDEN} keyword "hatch"
	  descr "Attic";

SECRET_DOOR_DIFFICULTY(UP,40)

ALWAYS_LIGHT
end  /* End of Demonic Guild */
/******************************************************************/
	 guild_attic
names {"demonic guild attic","guild attic","attic"}
title "Demonic guild attic"
descr "This is the attic of the demonic guild, it is neatly furnished and well
taken care off. Unlike the rest of this village everything is in perfect
condition, there is not even dust in the corners of the room. There is a huge
silver mirror on the east wall, which has a frame shaped like a hexagon.
By the north wall is a kingsize bed dressed with sky blue sheets, and at
the right side there is a small pile of clothes."

extra{"neatly furnished","furnished"}
"Everything is in perfect harmony, whoever did this has a natural or very
well trained sense of geometry."

extra {"dust in corners","dust","corners"}
"The coreners are completely dust free, just like the rest of the room."

extra {"silver mirror","mirror"}
"The mirror is crystal clear without a scratch, yet when you look in it you see
nothing."

extra {"hexagon","frame"}
"The frame of the mirror is shaped like a hexagon."

extra {"kingsize bed","bed"}
"This is a gigantic bed which looks very comfortable."

extra {"pile of clothes","pile","clothes"}
"This is the only thing which puts the room out of harmony, a pile of smelly
clothes in desperate need of washing."

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER, UNIT_FL_NO_TELEPORT}

down to demonic_guild open {EX_OPEN_CLOSE,EX_CLOSED} keyword "hatch"
	descr "Demonic guild entrance.";

ALWAYS_LIGHT
end  /* End of guild attic */
/******************************************************************
	 Small Maze
 ******************************************************************/
	 path_1
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads from the
north to the south."

_VORTEX

flags {UNIT_FL_NO_WEATHER,UNIT_FL_NO_MOB}

south to path2village2 descr "Yew..";
north to path_2 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 1 */
/******************************************************************/
	 path_2
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads from the
north to the south."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

south to path_1 descr "The ash buried patth.";
north to path_3 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 2 */
/******************************************************************/
	 path_3
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. This is a small crossing."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

south to path_2  descr "The ash buried patth.";
north to path_4  descr "The ash buried patth.";
east  to path_14 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 3 */
/******************************************************************/
	 path_4
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. This is a small crossing."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

south to path_3 descr "The ash buried patth.";
north to path_5 descr "The ash buried patth.";
west  to path_9 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 4 */
/******************************************************************/
	 path_5
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads from the
north to the south."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

south to path_4 descr "The ash buried patth.";
north to path_6 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 5 */
/******************************************************************/
	 path_6
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads from the
north to the south."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

south to path_5 descr "The ash buried patth.";
north to path_7 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 6 */
/******************************************************************/
	 path_7
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads from the
west to the south."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

south to path_6 descr "The ash buried patth.";
west  to path_8 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 7 */
/******************************************************************/
	 path_8
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. This is a dead end only
exit is east."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

east  to path_7 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 8 */
/******************************************************************/
	 path_9
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads from the
east to the west."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

east to path_4	descr "The ash buried patth.";
west to path_10 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 9 */
/******************************************************************/
	 path_10
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads from the
east to the west."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

east to path_9	descr "The ash buried patth.";
west to path_11 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 10 */
/******************************************************************/
	 path_11
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads from the
east to the west."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

east to path_10 descr "The ash buried patth.";
west to path_12 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 11*/
/******************************************************************/
	 path_12
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads from the
east to the west."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

east to path_11 descr "The ash buried patth.";
west to path_13 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 12*/
/******************************************************************/
	 path_13
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old
bones here. You guess that there once has been a great battle here. You
also see a small pond with clear beautiful water. Looking west you think
you see a river somewhere in the distance. The path also leads east."

extra {"river"}
"The river looks dark and foreboding and even from here you can see that
the water is black. The only vegetation to be seen near the riverbank is
dead."


_VORTEX

flags {UNIT_FL_NO_WEATHER,UNIT_FL_NO_MOB}

east to path_12 descr "The ash buried patth.";
west to styx_bank02@abyss1 descr "The bank of the river Styx";

ALWAYS_LIGHT
end  /* End of Path 13*/
/******************************************************************/
	 path_14
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads from the
west to the east."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

east  to path_15 descr "The ash buried patth.";
west  to path_3  descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 14*/
/******************************************************************/
	 path_15
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads from the
west to the north."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

north to path_16 descr "The ash buried patth.";
west  to path_14 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 15*/
/******************************************************************/
	 path_16
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads from the
north to the south."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

south to path_15 descr "The ash buried patth.";
north to path_17 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 16*/
/******************************************************************/
	 path_17
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads from the
south to the east."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

south to path_16 descr "The ash buried patth.";
east  to path_18 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 17*/
/******************************************************************/
	 path_18
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads from the
east to the west. There is a great rift to the north."

extra {"north"}
"As you look north, you stare into a great rift. Inside the rift you see some
ruins and what seems to be a GOD who is preparing something."

extra {"rift"}
"Inside the rift you see some ruins and what seems to be a GOD who is preparing
something."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

east  to path_19 descr "The ash buried patth.";
west  to path_17 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 18*/
/******************************************************************/
	 path_19
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads from the
west to the south."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

south to path_20 descr "The ash buried patth.";
west  to path_18 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 19*/
/******************************************************************/
	 path_20
names {"path"}
title "Small path"
descr "The path is covered with burned tree parts and ashes from old bones.
Your guess is that there has been a great battle here. The path leads to the
north. This is a dead end."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

north to path_19 descr "The ash buried patth.";

ALWAYS_LIGHT
end  /* End of Path 20*/
/******************************************************************/
	 road_1
names {"road"}
title "Dirty road"
descr
"You can see traces from gigantic feet everywhere, and when you study the
road a bit. You can make some traces of humanoid feet. The road is worn out
and probably as old as the human kind. The road leads north to a slightly
larger one and continues south. To your east and west is the abyss."

extra {"traces","tracks","gigantic feet","feet"}
"These tracks resemble those of humans, put they seem to have been made by a
creature with claws on its feet instead of toes."

extra {"abyss","east","west"}
"This abyss really looks bottomless, as you stare down you are unable to
see anything in it except for some things which seems to move down there. Maybe
it is the wind, you are unable to tell."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

north to path2village5 descr "An old path";
south to road_2 descr "The worn out path continues south";

ALWAYS_LIGHT
end  /* End of Road 1*/
/******************************************************************/
	 road_2
names {"road"}
title "Dirty road"
descr
"You can see traces from gigantic feet everywhere, and when you study the
road a bit. You can make some traces of humanoid feet. The road is worn out
and probably as old as the human kind. To you west and south is the abyss,
the road continues east and north from this point."

extra {"traces","tracks","gigantic feet","feet"}
"These tracks resemble those of humans, put they seem to have been made by a
creature with claws on its feet instead of toes."

extra {"abyss","south","west"}
"This abyss really looks bottomless, as you stare down you are unable to
see anything in it except for some things which seems to move down there. Maybe
it is the wind, you are unable to tell."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

north to road_1 descr "The worn out path continues south";
east  to road_3 descr "The worn out path continues south";

ALWAYS_LIGHT
end  /* End of Road 2*/
/******************************************************************/
	 road_3
names {"road"}
title "Dirty road"
descr
"You can see traces from gigantic feet everywhere, and when you study the
road a bit. You can make some traces of humanoid feet. The road is worn out
and probably as old as the human kind."

extra {"traces","tracks","gigantic feet","feet"}
"These tracks resemble those of humans, put they seem to have been made by a
creature with claws on its feet instead of toes."

extra {"abyss","north","south"}
"This abyss really looks bottomless, as you stare down you are unable to
see anything in it except for some things which seems to move down there. Maybe
it is the wind, you are unable to tell."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

west  to road_2 descr "The worn out path continues south";
east  to road_4 descr "The worn out path continues south";

ALWAYS_LIGHT
end  /* End of Road 3*/
/******************************************************************/
	 road_4
names {"road"}
title "Dirty road"
descr
"You can see traces from gigantic feet everywhere, and when you study the
road a bit. You can make some traces of humanoid feet. The road is worn out
and probably as old as the human kind."

extra {"traces","tracks","gigantic feet","feet"}
"These tracks resemble those of humans, put they seem to have been made by a
creature with claws on its feet instead of toes."

extra {"abyss","north","south"}
"This abyss really looks bottomless, as you stare down you are unable to
see anything in it except for some things which seems to move down there. Maybe
it is the wind, you are unable to tell."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

west  to road_3 descr "The worn out path continues south";
east  to road_5 descr "The worn out path continues south";

ALWAYS_LIGHT
end  /* End of Road 4*/
/******************************************************************/
	 road_5
names {"road"}
title "Dirty road"
descr
"You can see traces from gigantic feet everywhere, and when you study the
road a bit. You can make some traces of humanoid feet. The road is worn out
and probably as old as the human kind."

extra {"traces","tracks","gigantic feet","feet"}
"These tracks resemble those of humans, put they seem to have been made by a
creature with claws on its feet instead of toes."

extra {"abyss","north","south"}
"This abyss really looks bottomless, as you stare down you are unable to
see anything in it except for some things which seems to move down there. Maybe
it is the wind, you are unable to tell."

_VORTEX

flags {UNIT_FL_NO_WEATHER}

west  to road_4 descr "The worn out path continues south";

ALWAYS_LIGHT
end  /* End of Road 5*/
/******************************************************************/
/*################################################################
  ################################################################*/
%mobiles
/******************************************************************/
	 anya
names {"anya","maiden","lady"}
title "a young maiden"
descr " A young maiden lies here on the floor."

extra {}
"This is a beutiful young human maiden who seems to have been trapped here
for quite some time. Her pail skin and dirty face makes you realise that
she shouldn't stay here much longer."

race RACE_HUMAN

flags {UNIT_FL_NO_TELEPORT}

dilbegin awake();
var
 u	: unitptr;
 actn	: string;
code{
   :loop:
         heartbeat := 2;
         wait( SFB_CMD, TRUE );
         if( cmdstr in {"wake","awaken","poke"} )
	 {
	  u := findunit( activator, argument, FIND_UNIT_SURRO, null );
	  if( u != self ) goto loop;
	  if( not visible( activator, self ) ) goto loop;
	 }
	 else
	  goto loop;

         pause;
         heartbeat := PULSE_SEC * 3;
         act( "The young maiden awakens.", A_SOMEONE, self, null, null, TO_ALL );
         exec( "wake", self );     /* If poked */
	 exec( "scream", self );

	 if( ( activator.type & UNIT_ST_NPC ) or not( MAIDEN_ONGOING in activator.quests ) )
	 {
	  act( "$1n's body shakes violently.", A_SOMEONE, self, null, null, TO_ROOM );
	  pause;
	  act( "$1n's body stops shaking.", A_SOMEONE, self, null, null, TO_ROOM );
   /* Let's load the corpse :) */
	  u := load( "anya_corpse@demon_realm" );
	  while( self.inside )
	   link( self.inside, u );
	  link( u, self.outside );
	  destroy( self );
	  goto loop;	  /* This line should never happen */
	 }

	 if( not visible( self, activator ) ) /* If can't see, then never mind */
	 {
	  exec( "say What was that?", self );
	  exec( "sleep", self );
	  goto loop;
	 }

	 actn := activator.name;

	 exec( "say Who... who.. who are you?", self );
	 pause;
	 exec( "say Nevermind.", self );
	 pause;
	 exec( "say Please get me out of here!", self );
	 exec( "stand", self );
	 exec( "follow " + actn, self );
	 sendto( actn, self );
	 quit;
}
dilend

dilbegin aware shout_wait();
var
 actn	: string;
code{
	 wait( SFB_MSG, activator == self );
	 dilcopy( "brother@demon_realm", self );
	 actn := argument;
	 heartbeat := PULSE_SEC * 5;
   :loop:
	 pause;
	 if( ( not self.master ) or ( self.master.name != actn ) )
	 {
	  exec( "follow " + actn, self );
	  if( self.master.name != actn )
	  {
	   exec( "follow self", self );
	   exec( "shout " + actn + ", please come back.. I can't keep up!", self );
	  }
	  goto loop;
	 }
	 goto loop;
}
dilend

dilbegin aware brother();
var
 u	: unitptr;
 actn	: string;
 shit   : integer;
code{
   :loop:
	 wait( SFB_DONE, TRUE );
	 if( command( CMD_NORTH ) or
             command( CMD_EAST  ) or
             command( CMD_SOUTH ) or
             command( CMD_WEST  ) or
             command( CMD_UP    ) or
             command( CMD_DOWN  ) )
	 {
	  u := findsymbolic( self, "bjorn@demon_realm", FIND_UNIT_SURRO );
	  if( u )
	  {
           shit:= dildestroy( "shout_wait@demon_realm", self );
	   actn := self.master.name;
	   exec( "follow bjorn", self );
	   exec( "say Bjorn!", self );
	   exec( "hug bjorn", self );
	   send( "Im_here " + actn );
	   quit;
	  }
	 }
	 goto loop;
}
dilend

end
/******************************************************************/
	 bjorn
names {"bjorn","man"}
title "a weak man"
descr "A man is trying to hide himself in the corner."

extra {}
"This man looks like he has been kept in captivity for a long time.
His face is pale and his lips lack colour, every muscle in his body
seems to have vanished and it's a miracle that he can keep himself
straight up."

dilbegin sis();
var
 arg	: string;
 u1 : unitptr;
 u2 : unitptr;
code{
	 heartbeat := PULSE_SEC * 5;
   :loop:
	 wait( SFB_MSG, TRUE );
	 if( not ( ( activator.nameidx == "ayna" ) and ( activator.zoneidx == "demon_realm" ) and ( ( " " + getword( argument ) ) == " Im_here" ) ) )
	  goto loop;
	 arg := argument;
	 exec( "say Ayna!", self );
	 exec( "sniff", self );
	 pause;
         exec( "thank " + arg, self );
	 pause;
	 exec( "say Thankyou for rescuing my sister...", self );
	 pause;
	 exec( "say As i said earlier i cannot pay you enough.", self );
	 pause;
	 exec( "say All i can give you is this bag i stole from Ishlor's castle when i escaped", self );
	 pause;
	 u1 := load( "bag@midgaard" );
	 link( load( "note_1@demon_realm" ), u1 );
	 link( load( "demon_gem@demon_realm" ), u1 );
	 u2 := findunit( self, arg, FIND_UNIT_SURRO, null );
         if( not u2 )
	 {
	  exec( "say He didn't stay for his reward.", self );
	  destroy( u1 );
	 }
	 else
	 {
	  link( u1, u2 );
          subextra( u2.quests, MAIDEN_ONGOING );
          addextra( u2.quests, {MAIDEN_FINISHED}, "" );
	  exec( "say I took the liberty of putting the bag in your inventory.", self );
	  pause;
	  exec( "say Now we must run.", self );
	 }
	 u1 := findsymbolic( self, "ayna@demon_realm", FIND_UNIT_SURRO );
  /* If Ayna is missing..? fuckit! */
         follow( u1, self );
	 exec( "wake", u1 );
	 exec( "stand", u1 );
	 exec( "wake", self );
	 exec( "stand", self );
	 pause;
	 exec( "south", self );
	 exec( "west", self );
	 exec( "north", self );
	 exec( "north", self );
	 exec( "west", self );
	 pause;
	 u1 := findsymbolic( self, "ayna@demon_realm", FIND_UNIT_SURRO );
  /* If Ayna is missing..? fuckit! */
	 exec( "emote hides in the shadows.", u1 );
	 exec( "emote hides in the shadows.", self );
	 destroy( u1 );
	 destroy( self );
	 goto loop;
}
dilend

end
/******************************************************************/
	 demon_gservant
names {"demon servant","demon","servant"}
title "Demon Servant"
descr "A pathetic little demon servant is standing here."

extra {}
"This malformed little creature makes you sick to your stomach, it has no real
physical form thus it keeps changing shape all the time."

SERVANT_DEMON_GROUP(25)

special SFUN_TEAMWORK   "demon servant"
special SFUN_AGGRESSIVE "$1n starts to move." time PULSE_SEC*15
						  bits SFB_RANTIME

end
/******************************************************************/
	 attic_thief
names {"edgar","thief"}
title "Edgar the cautios"
descr "A dark mass of clothes stands here."

extra {}
"When you look at him you realise that he has no physical shape, the
contours keep changing. All you can see is a black shadow inside the mass
of clothing."

M_ELF_THIEF_AXE( 100, SEX_MALE )

money 1 GOLD_PIECE

dilbegin boast();
var
 u	: unitptr;
 wp : unitptr;
code{
	 exec("sit",self);
	 heartbeat:=PULSE_SEC*5;
	 on_activation((self.position<POSITION_RESTING) or
		   (self.position==POSITION_FIGHTING),do_nothing);
   :loop:
	 wait(SFB_CMD,activator.type==UNIT_ST_PC);
	 SAY("Greetings fellow adventurer!"); pause;
	 SAY("My name is Edgar."); pause;
	 SAY("Edgar the Cautios..."); pause;
	 SAY("Although I can't remember where i got that name."); pause;
	 GRIN; pause;
	 SAY("I can see that you are a person who has traveled far and wide."); pause;
	 SMILE; pause;
	 u:=findrndunit(self,FIND_UNIT_SURRO,UNIT_ST_PC);
	 if(u!=null)
	 {
	  exec("point "+u.name,self);
	  wp:=equipment(u,WEAR_WIELD);
	  if(wp!=null)
	   SAY("Nice "+wp.title+", it has been a long time since i saw one of those.");
	  else
	  {
	   SAY("You fight unarmed!");
           exec( "clap", self ); pause;
	  }
	 }
	 SAY("I just came back from my travels through Xiyang and the desert."); pause;
	 GRIN; pause;
	 SAY("I met a strange man there..."); pause;
	 CHUCK; pause;
	 SAY("He gave me this book."); pause;
	 CACK; pause;
	 act("$1n shows you a book without title.",A_SOMEONE,self,null,null,TO_ALL); pause;
	 SAY("I love reading.."); pause;
	 SMILE; pause;
	 SAY("There is nothing more relaxing."); pause;
	 exec("sigh",self); pause;
	 SAY("There used to be a time when i did nothing but fight."); pause;
	 GRIN; pause;
	 SAY("But that is all in the past now..."); pause;
	 SMILE; pause;
	 SAY("I still fight now and then though."); pause;
	 SAY("The former owner of this book put up quite a struggle to keep it."); pause;
	 CHUCK; pause;
	 SAY("But he got more important things on his mind now."); pause;
	 CACK; pause;
	 SAY("I better get on with my reading."); pause;
	 SAY("This is very facinating!"); pause;
	 exec("emote opens the book and starts to read.",self); pause;
	 pause;
	 SAY("I don't mind you being here, just to mess it up."); pause;
	 GRIN; pause;
	 SAY("I like to keep things clean."); pause;
	 exec("emote starts reading again.",self);
	 heartbeat:=PULSE_SEC*60*3;
	 pause;
	 pause;
	 SAY("Ahh.. Yet another chapter finished."); pause;
	 SAY("I think i'll doze off for a bit, if you don't mind.");
	 exec("emote goes to sleep before you have time to say anything.",self);
	 pause;
	 pause;
	 pause;
	 goto loop;

   :do_nothing:
	 while((self.position<POSITION_RESTING) or
	   (self.position==POSITION_FIGHTING))
	 {
	  if(self.position==POSITION_SLEEPING) exec("wake", self);
	  if(self.position==POSITION_RESTING)  exec("stand",self);
	  pause;
	 }
	 goto loop;
}
dilend

end  /* End of attic thief */
/******************************************************************/
	 c_man1
names {"rudolf","crying man","man"}
title "Rudolf"
descr "A man is crying here."
extra {}
"This man is pathetic, he looks as if he crawled up from under a rock."

M_AVG_HUMAN(1, SEX_MALE, RACE_HUMAN)

money 1 IRON_PIECE

dilbegin cry();
code{
	 interrupt(SFB_COM,self.position==POSITION_FIGHTING,skip_it);
   :start:
	 heartbeat:=PULSE_SEC*3;
	 exec("say I can't believe it!!",self); pause;
	 exec("sigh",self); pause;
	 exec("say He removed my home from this world...",self); pause;
	 exec("sniff",self); pause;
	 exec("say Why did he do that?",self); pause;
	 exec("cry",self); pause;
	 act("$1n keeps on crying.",A_SOMEONE,self,null,null,TO_ALL); pause;
	 exec("say That god Shai is a mean person!",self); pause;
	 exec("sniff",self); pause;
	 exec("say He just walked up here and said.",self); pause;
         act("'This place needs to be replaced.'",A_SOMEONE,self,null,null,TO_ALL); pause;
	 exec("sniff",self); pause;
	 exec("say Then he casted some spell and my entire home was gone!",self); pause;
	 exec("cry",self); pause;
	 exec("say ..my entire home..",self); pause;
	 exec("sniff",self); pause;
	 exec("say My wife and children...",self); pause;
	 exec("sniff",self); pause;
	 exec("say I AM NEVER GONNA FORGIVE HIM!!",self); pause;
	 exec("sigh",self); pause;
         act("You hear a deep and firm voice saying 'OLD FOOL!'",A_SOMEONE,self,null,null,TO_ALL); pause;
         act("The voice says 'I will teach you not to make me angry!'",A_SOMEONE,self,null,null,TO_ALL); pause;
	 exec("say ...",self); pause;
	 exec("say ......",self); pause;
	 act("It looks as if he has lost his voice.",A_HIDEINV,self,null,null,TO_REST);
	 heartbeat:=PULSE_SEC*30;
	 pause;
	 exec("emote moves his hand in a swift motion and conjures a vial.",self); pause;
	 exec("emote quaffs the vial.",self); pause;
	 exec("say HA!",self); pause;
	 exec("say I will NEVER let him push me down.",self);
	 exec("sigh",self); pause;
	 pause;
	 pause;
	 pause;
	 goto start;

   :skip_it:
	 heartbeat:=PULSE_SEC*3;
	 while(self.position==POSITION_FIGHTING) pause;
	 goto start;
}
dilend

end
/******************************************************************/
	 c_man2
names {"bertil","crying man","man"}
title "Bertil"
descr "A man is crying here."
extra {}
"This man is pathetic, he looks as if he crawled up from under a rock."

M_AVG_HUMAN(1, SEX_MALE, RACE_HUMAN)

dilbegin cry2();
code{
	 interrupt(SFB_COM,self.position==POSITION_FIGHTING,skip_it);
   :start:
	 heartbeat:=PULSE_SEC*3;
	 exec("say I can't believe it!!",self); pause;
	 exec("sigh",self); pause;
	 exec("say He removed my home from this world...",self); pause;
	 exec("sniff",self); pause;
	 exec("say Why did he do that?",self); pause;
	 exec("cry",self); pause;
	 act("$1n keeps on crying.",A_SOMEONE,self,null,null,TO_ALL); pause;
	 exec("say That god Shai is a mean person!",self); pause;
	 exec("sniff",self);
	 exec("say He just walked up here and said.",self); pause;
         act("'This place needs to be replaced.'",A_SOMEONE,self,null,null,TO_ALL); pause;
	 exec("sniff",self); pause;
	 exec("say Then he casted some spell and my entire home was gone!",self); pause;
	 exec("cry",self); pause;
	 exec("say ..my entire home..",self); pause;
	 exec("sniff",self); pause;
	 exec("say My wife and children...",self); pause;
	 exec("sniff",self); pause;
	 exec("say I AM NEVER GONNA FORGIVE HIM!!",self); pause;
	 exec("sigh",self); pause;
	 exec("say ...",self); pause;
	 exec("say ......",self); pause;
	 act("It looks as if he has lost his voice.",A_HIDEINV,self,null,null,TO_REST);
	 heartbeat:=PULSE_SEC*30;
	 pause;
	 goto start;

   :skip_it:
	 heartbeat:=PULSE_SEC*3;
	 while(self.position==POSITION_FIGHTING) pause;
	 goto start;
}
dilend

money 1 IRON_PIECE

end
/******************************************************************/
	 d_spider
names {"demonic spider","spider","demon"}
title "demonic spider"
descr "A demonic spider is crawling here."
extra {}
"As you look close at the spider you realise that 4 of its legs has been changed
into arms. Its green facetted eyes look completely lifeless, but you can feel it
that it has complete control over the surrounding."

extra {"facetted eyes","eyes"}
"The eyes are as black as night, they don't even show a tiny little spark of
life. But the spider is moving anyway."

DEMON_SPIDER(80, ARM_CHAIN, SEX_NEUTRAL)
weight 400
exp 50

special SFUN_TEAMWORK "demonic spider queen"
special SFUN_RESCUE   "demonic spider queen"
special SFUN_RANDOM_ZONE_MOVE time 100 bits SFB_RANTIME
special SFUN_AGGRESSIVE "$1n snarls at $3n and bites $3s leg."
			time 160 bits SFB_RANTIME

end
/******************************************************************/
	 d_sp_queen
names {"demonic spider queen","spider queen","spider","queen","demon"}
title "demonic spider queen"
descr "The demonic spider queen is crawling here."
extra {}
"The first thing you notice when you look at her is her white eyes. She has
some nasty scars on her body and there are even missing parts. Or are they
missing? You realise that a demon just not matches any of your visions on
how life should be."

extra {"white eye","eyes"}
"The eyes are slowly changing shape as you watch, they look like some sort
of organic substance that don't really belong on the spiders body."

extra {"scars on her body","scars","scar","body"}
"The number of scars is uncountable, there are aimply to many of them. Most of
them are old but there are a few fresh ones."

extra {"missing parts","parts"}
"There seem to be a part of her body missing in some places, but you can't be
sure since there is no rule to how demons look."

DEMON_SPIDER(100, ARM_PLATE, SEX_FEMALE)
weight 450
exp 70
speed 8

dilbegin queen_load();
code{
   /* 20% chance of loading at repop. */
	if(rnd(1,100)<20) link(load("sp_pend@demon_realm"),self);
	quit;
}
dilend

special SFUN_AGGRESSIVE "$1n hisses and attacks."
			time 180 bits SFB_RANTIME

end
/******************************************************************/
		p_servent
names {"demon runner","demon","runner"}
title "demon runner"
descr "A demon is standing here."
extra {}
"This is a rather small demon, it is only about 1 meter tall. But its muscular
body looks like one which has been been through hard labour during its entire
existence. As you look at the demon you realize that he is watching you."

SERVENT_DEMON(60)

special SFUN_TEAMWORK "servant/demon"  /* If more than one, teamwork */
special SFUN_RANDOM_ZONE_MOVE time 120 bits SFB_RANTIME

dilbegin con_char();
var
   pc		 : unitptr;
   stat 	 : integer;
   ifight	 : integer;
   name_list : stringlist;
code {
	 :init:
	   heartbeat:=PULSE_SEC*3;
	   interrupt(SFB_CMD,(self.position == POSITION_SLEEPING)  or
				 (self.position == POSITION_MORTALLYW) or
				 (self.position == POSITION_INCAP)	   or
				 (self.position == POSITION_STUNNED), busy);
	   ifight:=interrupt(SFB_COM,self.position==POSITION_FIGHTING, ina_fight);
	   on_activation(self.position == POSITION_FIGHTING, ina_fight);
	 :start:
	   wait(SFB_TICK,activator.type==UNIT_ST_PC);
	   pc := activator;
	   secure(pc,lost_it);
	   if(pc.level>IMMORTAL_LEVEL) goto lost_it;
	   if(("egon" in pc.names) and
		  (pc.type==UNIT_ST_NPC)) goto found_peddler;
	   exec("look "+pc.name,self);
	   pause;
	   if(pc.alignment>=350)
	   {
		exec("growl "+pc.name,self);
		pause;
		exec("grin "+pc.name,self);
		pause;
		exec("kill "+pc.name,self);
	   }
	   else if(pc.alignment>-350)
	   {
		act("The demon grins at you shaking his head.",
                                                A_SOMEONE,pc,null,null,TO_CHAR);
		act("The demon grins at $1n shaking his head.",
                                                A_SOMEONE,pc,null,null,TO_REST);
	   }
	   else
	   {
		act("The demon smiles at you nodding his head.",
                                                A_SOMEONE,pc,null,null,TO_CHAR);
		act("The demon smiles at $1n nodding his head.",
                                                A_SOMEONE,pc,null,null,TO_REST);
	   }
	   unsecure(pc);
	   pause;
	   goto start;

	 :found_peddler:
	   exec("growl egon",self); pause;
	   exec("emote mutters something about 'traitor'",self); pause;
	   unsecure(pc);
	   goto start;

	 :busy:
	   while((self.position==POSITION_SLEEPING)  or
		 (self.position==POSITION_MORTALLYW) or
		 (self.position==POSITION_INCAP)	 or
		 (self.position==POSITION_STUNNED))  pause;
	   goto start;

	 :ina_fight:
	   while(self.position==POSITION_FIGHTING) pause;
	   if(self.hp>0)
	   {
		exec("emote Howls in victory.",self);
		pause;
	   }
	   goto start;

	 :lost_it:
	   unsecure(pc);
	   goto start;
}
dilend

end /* End of plain demon */
/******************************************************************/
		   g_wizard
names {"argon the guardian","argon","guardian wizard","guardian","wizard","small man","man"}
title "the guardian"
descr "A small man sitting on the ground studying his hands."

extra {}
"The old man looks almost as old as the mountain which he stands
before. The weather and age has not treated him nice. He looks as
if he is going to die any time now. Just say 'transfer me' and
he will do it."

BASE_HUMAN_MAGE(80,SEX_MALE,"cast flash")
MSET_SPELL(1,8,8,8,8,25,8,6,6,6,6)
MSET_WEAPON(0,0,0,10,0,0)

money 1 GOLD_PIECE, 3 SILVER_PIECE

dilcopy chk_gqst@demon_realm();

end /* End of the Guardian */
/******************************************************************/
			 ishlor
names {"ishlor","demon prince","demon","prince"}
title "Ishlor the demon prince"
descr "Ishlor stands here."
extra {}
"Ishlor is clearly a beast of chaos, his entire body is extremely
deformed. His head has 4 eyes, very many teeth and 2 horns. The body
is very well built if it had not been for the gigantic hole in his chest."

extra {"body"}
"It has been twisted to serve its purpose which you by the way, is unable
to figure out."

extra {"chest","hole"}
"The hole in his chest is about 6 inches in diameter and completely circular.
Your guess is that it is an old war wound."

extra {"head"}
"The head has some scars but the main thing that catches your eyes is HIS
eyes. They are green and life-less, yet they glow slightly."

extra {"horns","horn"}
"His horns are huge and you suspect that many thinga has been run through
by them."

extra {"teeth"}
"He has a huge amount of teeth, which seems to shine."

LORD_DEMON(120,SEX_MALE)

alignment -900
speed 6

money 3 GOLD_PIECE, 4 SILVER_PIECE, 1 COPPER_PIECE

dilbegin get_help();
var
   help   : unitptr;
   lop	  : integer;
   ifight : integer;
code{
   :start:
	 heartbeat := PULSE_SEC * 3;
	 ifight := interrupt(SFB_COM,self.fighting, ina_fight );

   :loop:
	 pause;
	 goto loop;

   :ina_fight:
	 clear( ifight );
	 exec( "emote speaks in a deep and beastly voice:", self );
	 exec( "say COME HELP ME MY MINIONS!!", self );
	 lop := rnd( 1 , 3 );
	 while(lop>0)
	 {
	  help := load( "ishlors_guard@demon_realm" );
	  link( help, self.outside );
	  exec( "kill " + self.fighting.name, help);
	  lop := lop - 1;
	 }
	 while( self.fighting ) pause;
	 ifight := interrupt( SFB_COM, self.fighting, ina_fight );
	 goto loop;
}
dilend

end /* End of Demon Prince Ishlor  */
/******************************************************************/
	 ishlors_guard
names {"ishlors guard","guard","demon"}
title "Ishlors Guard"
descr "A personal guard of Ishlor stands here."
extra {}
"As you look the the demon your stomach turns, you can only keep your eyes on
it for a few seconds. This grotesc beast has only one purpuse... To save
Ishlor from dying."

WARRIOR_DEMON(80)

special SFUN_TEAMWORK "ishlor/ishlors guard"
special SFUN_RESCUE   "ishlor"

dilbegin equip_guard();
var
   u  : unitptr;
code{
	 heartbeat:=PULSE_SEC*5;
	 u:=load("guard_sword@demon_realm");
	 u.height := self.height;
	 addequip(u,WEAR_WIELD);
	 u:=load("guard_helmet@demon_realm");
	 u.height := self.height;
	 addequip(u,WEAR_HEAD);
	 u:=load("guard_plate@demon_realm");
	 u.height := self.height;
	 addequip(u,WEAR_BODY);
	 u:=load("guard_sleeves@demon_realm");
	 u.height := self.height;
	 addequip(u,WEAR_ARMS);
	 u:=load("guard_gauntlets@demon_realm");
	 u.height := self.height;
	 addequip(u,WEAR_HANDS);
	 u:=load("guard_leggings@demon_realm");
	 u.height := self.height;
	 addequip(u,WEAR_LEGS);
	 u:=load("guard_boots@demon_realm");
	 u.height := self.height;
	 addequip(u,WEAR_FEET);
	 heartbeat:=PULSE_SEC*1;
         act("One of ishlors lifeguards appears in a flash.",A_SOMEONE,self,null,null,TO_ALL);
	 exec("say YES MASTER!",self);
	 pause;
	 heartbeat := PULSE_SEC*5;
	 pause;
	 heartbeat := PULSE_SEC*1;
   :kicking:
	 while( self.fighting ) pause;
   :loop:
	 pause;
	 if( self.position < POSITION_RESTING ) goto loop;
	 if( self.fighting ) goto kicking;
         act("The guard of ishlor fades away.",A_SOMEONE,self,null,null,TO_ALL);
	 destroy(self);
}
dilend

end /* End of Ishlors Guard */
/******************************************************************/
	 bridge_guard
names {"demon guardian","guardian","guard","demon"}
title "Demon Guardian"
descr "A big demon stands here."
extra {}
"When you study this demon you start to wonder who created him, he has a
perfect humanoid body. And you can't make out any kind of defects on him.
This large beast seems to have been put here to keep non-demons from
crossing the bridge."

WARRIOR_DEMON(70)

special SFUN_TEAMWORK  "guard/runner"  /* If more than one, teamwork */

dilbegin guard_way();
var
 place	: integer;
code{
	 heartbeat := PULSE_SEC * 5;
	 place := self.outside.idx;
   :loop:
	 wait( SFB_CMD, command( CMD_NORTH ) );
	 if( place != self.outside.idx )
	  goto loop;
	 if( ( activator.nameidx == "peddler" ) and ( activator.zoneidx == "demon_realm" ) )
	 {
	  exec( "say You may pass traitor...", self );
	  goto loop;
	 }
	 block;
	 act( "$1n stops you.. And growls something about 'Demons only'", A_SOMEONE, self, null, activator, TO_VICT );
	 act( "$1n prevents $3n from going north. And growls something about 'Demons only'", A_SOMEONE, self, null, activator, TO_REST );
	 goto loop;
}
dilend

end /* End of Bridge guard */
/******************************************************************/
	 peddler
names {"man in dark cloak","man","egon","peddler"}
title "Egon The Peddler"
descr "A man in a dark cloak stands here."
extra {}
"At your first glimpse he looks like an ordinary male human, but when you look
harder you realise that he is a bit more than a human. You can make out strange
teeth in his mouth, small horns on his head and scale like skin. This has to
be a demon fighter, it is said that they are ordinary fighters who have a
demon inside themselves instead of a soul. It is also said that they are
unbeatable in hand to hand combat. When you think back on your early days as
an adventurer you remember hearing about a warrior who stalks some strange
world in another dimension, he was supposed to have killed a demon prince
but those are only stories. Maybe you can buy information from this guy."

extra {"teeth","mouth"}
"When you look at his mouth you realise that he has fangs, and it looks as if
they are pretty sharp too."

extra {"horns","horn"}
"He has 3 small horns in his forehead, they are almost invisible. It looks like
three bumps, but they are a bit to pointy."

extra {"scale like skin","scale","skin"}
"His skin has a scale like surface, and you realise that it acts as some sort
of armor."

flags {UNIT_FL_NO_TELEPORT}

race RACE_HUMAN
level 100
sex SEX_MALE
height 180
weight 190
alignment 200
NATURAL_DEF( WPN_FIST, ARM_HLEATHER )
MSET_ABILITY( 15, 20, 20, 20, 10, 5, 5, 5 )
MSET_WEAPON( 0, 16, 0, 0, 16, 0 )
MSET_SPELL( 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 6 )

dilbegin peddler_dead();
var
   pc : unitptr;
code{
   :start:
	 heartbeat:=PULSE_SEC*1;
	 wait(SFB_COM, (self.position==POSITION_FIGHTING) and
		   (command(CMD_AUTO_COMBAT)) and
		   (self.hp<=-10) );
	 pc:=activator;
	 secure(pc,lost_it);
	 log("peddler_dead: Egon the peddler has died");
         act("You foolish mortals!!",A_SOMEONE,pc,null,null,TO_ALL); pause;
	 act("You won't be able to get through this realm without my help..",
                           A_SOMEONE,pc,null,null,TO_ALL); pause;
         act("Those last words is stuck in you mind..",A_SOMEONE,pc,null,null,TO_ALL);
	 unsecure(pc);
	 pause;
	 goto start;

   :lost_it:
	 unsecure(pc);
	 goto start;
}
dilend

dilbegin aware peddlermain();
var
   pc	  : unitptr;
   enemy  : unitptr;
   ipos   : integer;
   ibuy   : integer;
   ifight : integer;
   itime  : integer;
   bname  : string;
code{
   :init:
	 heartbeat:=PULSE_SEC*3;
	 interrupt(SFB_COM,self.position==POSITION_FIGHTING,ina_fight);
	 interrupt(SFB_CMD,command("buy"),buy_int);
   :loop:
	 wait(SFB_CMD,FALSE);
	 goto loop;

   :buy_int:
	 if(argument=="information")
	 {
	  priority;
	  sendtoalldil("buying","peddler_walk@demon_realm");
	  block;
	  exec("say Information about what?",self);
	  wait(SFB_DONE,command(CMD_SAY) or ((command(CMD_TELL) or command("whisper")) and
			(target==self) and (activator==pc)));
	  if((argument=="chaos gem") or (argument=="gem") or (argument=="gem of chaos"))
	  {
	   exec("think",self);
	   pause;
	   exec("say I will tell you what i know for a cost of 10 platinum.",self);

	   itime:=0;
	   while(not(command("give") and (activator==pc)) and (itime<10))
	   {
	wait(SFB_CMD|SFB_TICK,TRUE);
	if(command(CMD_AUTO_TICK)) itime:=itime+1;
	   }
	   if(itime==10) goto re_set;

	   if((purse(self,PLATINUM_PIECE)>=10)	  or
	  (purse(self,GOLD_PIECE)>=80)		  or
	  (purse(self,SILVER_PIECE)>=640)	  or
	  (purse(self,COPPER_PIECE)>=(640*8)) or
	  (purse(self,IRON_PIECE)>=(64*640)))
	   {
	destroy(medium);
	exec("whisper "+activator.name+" It is said that the gem is hidden somewhere in the draconian realm.",self);
	   }
	   else if("pieces" in medium.name)
	   {
	exec("say This not enough!",self);
	exec("give "+itoa(medium.value[0])+" "+medium.name+" "+activator.name,self);
	   }
	   else
	   {
	exec("say I dont trade information for goods!",self);
	exec("drop "+medium.name,self);
	   }
	  }
	  else
	  if((argument=="chaos staff") or (argument=="staff") or (argument=="staff of chaos"))
	  {
	   exec("think",self);
	   pause;
	   exec("say I will tell you what i know for a cost of 8 platinum.",self);

	   itime:=0;
	   while(not(command("give") and (activator==pc)) and (itime<10))
	   {
	wait(SFB_CMD|SFB_TICK,TRUE);
	if(command(CMD_AUTO_TICK)) itime:=itime+1;
	   }
	   if(itime==10) goto re_set;

	   if((purse(self,PLATINUM_PIECE)>=8)	 or
	  (purse(self,GOLD_PIECE)>=64)		  or
	  (purse(self,SILVER_PIECE)>=(8*64))	 or
	  (purse(self,COPPER_PIECE)>=(64*64)) or
	  (purse(self,IRON_PIECE)>=(64*64*8)))
	   {
	destroy(medium);
	exec("whisper "+activator.name+" The last person who had the staff was hunting for Baykur, the soul eater.",self);
	   }
	   else if("pieces" in medium.name)
	   {
	exec("say This not enough!",self);
	exec("give "+itoa(medium.value[0])+" "+medium.name+" "+activator.name,self);
	   }
	   else
	   {
	exec("say I dont trade information for goods!",self);
	exec("drop "+medium.name,self);
	   }
	  }
	  else
	  if((argument=="chaos ring") or (argument=="ring") or (argument=="ring of chaos"))
	  {
	   exec("think",self);
	   pause;
	   exec("say I will tell you what i know for a cost of 5 platinum.",self);

	   itime:=0;
	   while(not(command("give") and (activator==pc)) and (itime<10))
	   {
	wait(SFB_CMD|SFB_TICK,TRUE);
	if(command(CMD_AUTO_TICK)) itime:=itime+1;
	   }
	   if(itime==10) goto re_set;

	   if((purse(self,PLATINUM_PIECE)>=5)	  or
	  (purse(self,GOLD_PIECE)>=40)		  or
	  (purse(self,SILVER_PIECE)>=(8*40))  or
	  (purse(self,COPPER_PIECE)>=(64*40)) or
	  (purse(self,IRON_PIECE)>=(8*64*40)))
	   {
	destroy(medium);
        exec("whisper "+activator.name+" The ring lies by the poor soul who drank from the crystal pond.",self);
	   }
	   else if("pieces" in medium.name)
	   {
	exec("say This not enough!",self);
	exec("give "+itoa(medium.value[0])+" "+medium.name+" "+activator.name,self);
	   }
	   else
	   {
	exec("say I dont trade information for goods!",self);
	exec("drop "+medium.name,self);
	   }
	  }
	  else
	  {
	   exec("say Sorry, i know nothing about that.",self);
	  }
	 }
	 sendtoalldil("nobuy","peddler_walk@demon_realm");
	 nopriority;
	 goto loop;

   :re_set:
	 nopriority;
	 sendtoalldil("nobuy","peddler_walk@demon_realm");
	 heartbeat:=PULSE_SEC*3;
	 exec("say I can't wait around all day!",self);
	 goto loop;

   :ina_fight:
	 nopriority;
	 sendtoalldil("nobuy","peddler_walk@demon_realm");
	 while(self.position==POSITION_FIGHTING) pause;
	 goto loop;
}
dilend

dilbegin aware peddler_walk();
var
   room   : unitptr;
   walk   : integer;
   ext	  : integer;
   cnt	  : integer;
   cnt2   : integer;
   crap   : integer;
   ecnt   : integer;  /* Exit loop counter. */
   stat   : integer;
   exits  : stringlist;
code{
	 heartbeat:=PULSE_SEC*15;
	 walk:=interrupt(SFB_TICK,self.position==POSITION_STANDING,move_ment);
	 interrupt(SFB_TICK,(self.position==POSITION_RESTING) or
			(self.position==POSITION_SITTING),stand_up);
	 interrupt(SFB_TICK,(self.position==POSITION_SLEEPING),wake_up);
	 interrupt(SFB_MSG,(activator==self) and (argument=="buying"),dont_move);
	 interrupt(SFB_MSG,(activator==self) and (argument=="nobuy"),move_again);
	 stat:=0;
	 ecnt:=0;
	 exits:={"north","east","south","west","up","down"};
   :loop:
	 wait(SFB_CMD,FALSE);
	 goto loop;

   :dont_move:
	 stat:=1;
	 goto loop;

   :move_again:
	 stat:=0;
	 goto loop;

   :stand_up:
	 exec("stand",self);
	 goto loop;

   :wake_up:
	 exec("wake",self);
	 goto loop;

   :move_ment:
	 if(stat==1) goto loop;
	 cnt:=0;
	 cnt2:=0;
	 while(cnt<6)
	 {
	  if(self.outside.exit_to[cnt]!=null) cnt2:=1;
	  cnt:=cnt+1;
	 }
	 if(cnt2==0) goto damn_no_exits;
	 crap:=0;
   :find_exit:
	 ext:=rnd(0,5);
	 if(self.outside.exit_to[ext]==null)
	 {
	  crap:=crap+1;
	  if(crap>19)
	  {
	   crap:=0;
	   pause;
	  }
	  goto find_exit;
	 }
	 if(isset(self.outside.exit_info[ext],EX_CLOSED) and
	isset(self.outside.exit_info[ext],EX_LOCKED)) goto locked;
	 if(isset(self.outside.exit_info[ext],EX_CLOSED))
	 {
	  act("$1n walks through the "+self.outside.exit_names[ext].[0]+" as if it didn't exist",
		   A_HIDEINV,self,null,null,TO_ALL);
	  unset(self.outside.exit_info[ext],EX_CLOSED);
	  room:=self.outside;
	  exec(exits.[ext],self);
	  set(room.exit_info[ext],EX_CLOSED);
	  goto loop;
	 }
	 exec(exits.[ext],self);
	 goto loop;

   :locked:
	 act("$1n walks through the "+self.outside.exit_names[ext].[0]+" as if it didn't exist",
		  A_HIDEINV,self,null,null,TO_REST);
	 unset(self.outside.exit_info[ext],EX_LOCKED);
	 unset(self.outside.exit_info[ext],EX_CLOSED);
	 room:=self.outside;
	 exec(exits.[ext],self);
	 set(room.exit_info[ext],EX_CLOSED);
	 set(room.exit_info[ext],EX_LOCKED);
	 if(ext==0)	 ext:=2;
	 else if(ext==1) ext:=3;
	 else if(ext==2) ext:=0;
	 else		 ext:=1;
	 act("$1n arrives through the "+self.outside.exit_names[ext].[0]+".",
		  A_HIDEINV,self,null,null,TO_REST);
	 goto loop;

   :damn_no_exits:
	 if(ecnt==0)
	  exec("say What the hell am i doing here?",self);
	 if(ecnt==1)
	  exec("scratch",self);
	 if(ecnt==2)
	  exec("say How the fuck did i get here?",self);
	 if(ecnt==3)
	  exec("think",self);
	 if(ecnt==4)
	  exec("sigh",self);
	 if(ecnt==5)
	 {
	  ecnt:=-1;
	  exec("emote utters the words 'ereh atuo kcuf eht em teg'",self);
          act("$1n opens a rift.",A_SOMEONE,self,null,null,TO_REST);
	  exec("emote walk into the rift.",self);
          act("The rift closes itself quietly.",A_SOMEONE,self,null,null,TO_REST);
	  link(self,findroom("pzone_10@demon_realm"));
          act("A rift opens before you.",A_SOMEONE,self,null,null,TO_REST);
	  exec("emote appears through the rift.",self);
          act("The rift closes itself quietly.",A_SOMEONE,self,null,null,TO_REST);
	 }
	 ecnt:=ecnt+1;
	 goto loop;
}
dilend

end
/******************************************************************
		  Town Ghosts
 ******************************************************************/
	 mayor
names {"tsaar mayor ghost","mayor ghost","ghost","mayor"}
title "the ghost of the mayor"
descr "The Ghost of the mayor hovers here."
extra {}
"The only thing you can make out is his sad face the rest of his body is a blur."

extra {"face","head"}
"His face seems very sad. It seems as if he is always looked like this."

extra {"body"}
"Well it is not much of a body. The only part you can see, except for the head.
Is his neck."

extra {"neck"}
"There are strange markings around his neck."

extra {"markings around neck","markings"}
"Hmm.. It looks as if he has been hung!!"

flags {UNIT_FL_NO_TELEPORT}

GREATER_GHOST(100,SEX_FEMALE)

dilbegin quest1();
var
   pc	  : unitptr;
   sobj   : unitptr;
   _sx	  : string;
   fuct   : integer;
code{
   :init:
	 heartbeat := PULSE_SEC * 5;
	 on_activation( self.position == POSITION_FIGHTING, ina_fight );

   :start:
	 wait( SFB_DONE, ( activator.type == UNIT_ST_PC ) );
	 if( command( "give"  ) or
	 command( "steal" ) or
	 command( "kill"  ) ) goto start;
	 if( activator.sex == SEX_MALE	  ) _sx:="he";
	 if( activator.sex == SEX_FEMALE  ) _sx:="she";
	 if( activator.sex == SEX_NEUTRAL ) _sx:="it";
	 if( activator.minv > 0) goto start;
	 if( QUEST1_FINISHED in activator.quests ) goto start;
	 if( QUEST1_ONGOING  in activator.quests ) goto inform;
	 pc := activator;
	 secure( pc, lost_pc );
	 exec( "say Greetings " + pc.name, self ); pause;
	 exec( "think", self ); pause;
	 exec( "say I was wondering if you might help me?", self ); pause;
	 exec( "grin", self ); pause;
	 exec( "say You see, when the gods attacked our village everyone was killed.", self );
	 pause;
	 exec( "say Well. Everyone except for my son.", self ); pause;
	 exec( "sigh", self ); pause;
	 exec( "say I need a few items to cast a spell to locate him.", self ); pause;
	 exec( "say And since i can't leave this place.. I was wondering if you would be so kind as to get them for me?", self );
	 pause;
	 exec( "say Please NOD if you accept", self );
	 wait( SFB_DONE, command( "nod" ) and ( activator == pc ) );
	 addextra( pc.quests, { QUEST1_ONGOING }, "" );

	 sobj := findroom( "path_13@demon_realm" ); /* Load ring */
	 sobj := sobj.inside;
	 while( ( sobj != null ) and ( not ( "chaos_ring" == sobj.nameidx ) ) )
	   sobj := sobj.next;
	 if( sobj == null ) /* There was no ring here */
	 {
	  sobj := load( "chaos_ring@demon_realm" );
	  link( sobj, findroom( "path_13@demon_realm" ) );
	 }
	 sobj := findroom( "floor5@hades6" );       /* Load staff */
	 sobj := sobj.inside;
	 while( ( sobj != null ) and ( not ( "chaos_staff" == sobj.nameidx ) ) )
	   sobj := sobj.next;
	 if( sobj == null ) /* There was no ring here */
	 {
	  sobj := load( "chaos_staff@demon_realm" );
	  link( sobj, findroom( "floor5@hades6" ) );
	 }
	 sobj := findroom( "courtyard_9@akaren" ); /* Load gem */
	 sobj := sobj.inside;
	 while( ( sobj != null ) and ( not ( "chaos_gem" == sobj.nameidx ) ) )
	   sobj := sobj.next;
	 if( sobj == null ) /* There was no ring here */
	 {
	  sobj := load( "chaos_gem@demon_realm" );
	  link( sobj, findroom( "courtyard_9@akaren" ) );
	 }

	 exec( "smile", self ); pause;
	 exec( "say The items i need are all made of materials from the same beast.", self ); pause;
	 exec( "say I do not know where to find them but i know their names.", self ); pause;
	 exec( "think", self ); pause;
	 exec( "say The first is the staff of chaos, and the rumors say it is in somewhere in HELL.", self ); pause;
	 exec( "say The second item is the ring of chaos, this will be the easiest to find.", self ); pause;
	 exec( "say Because it is located somewhere in this demonic realm", self ); pause;
	 exec( "say The third and final object is the most powerful of them.", self ); pause;
	 exec( "say It is the gem of chaos, which holds the eye of one of the chaos guardians.", self ); pause;
	 exec( "say I heard that he has hidden somewhere when he was walking in the realm of VALHALLA.", self ); pause;
	 exec( "say Please bring me those 3 items and i shall reward you for your effort.", self ); pause;
	 exec( "say Go now.", self );
	 unsecure( pc );
	 goto start;

   :inform:
	 pc := activator;
	 secure( pc, no_inform );
	 if( ( "chaos staff" in pc.quests ) and
	 ( "chaos ring"  in pc.quests ) and
	 ( "chaos gem"   in pc.quests ) ) goto no_inform;
	 exec( "smile", self ); pause;
	 exec( "say So " + pc.name + ", how is it going?", self ); pause;
	 exec( "grin", self ); pause;
	 exec( "say If you need to know the information about the items again, just nod.", self );

	 heartbeat := PULSE_SEC*30;
	 fuct := interrupt( SFB_TICK, TRUE, no_inform );

	 wait( SFB_DONE, ( command( "nod" ) or command( "shake" ) ) and
			 ( activator == pc ) );

	 clear( fuct );
	 heartbeat := PULSE_SEC * 5;

	 if( not( "chaos ring" in pc.quests ) )
	 {
	   sobj := findroom( "path_13@demon_realm" ); /* Load ring */
	   sobj := sobj.inside;
	   while( ( sobj != null ) and ( not ( "chaos_ring" == sobj.nameidx ) ) )
	 sobj := sobj.next;
	   if( sobj == null ) /* There was no ring here */
	   {
	sobj := load( "chaos_ring@demon_realm" );
	link( sobj, findroom( "path_13@demon_realm" ) );
	   }
	 }
	 if( not( "chaos staff" in pc.quests ) )
	 {
	   sobj := findroom( "floor5@hades6" );       /* Load staff */
	   sobj := sobj.inside;
	   while( ( sobj != null ) and ( not ( "chaos_staff" == sobj.nameidx ) ) )
	 sobj := sobj.next;
	   if( sobj == null ) /* There was no ring here */
	   {
	sobj := load( "chaos_staff@demon_realm" );
	link( sobj, findroom( "floor5@hades6" ) );
	   }
	 }
	 if( not( "chaos gem" in pc.quests ) )
	 {
	   sobj := findroom( "courtyard_9@akaren" ); /* Load gem */
	   sobj := sobj.inside;
	   while( ( sobj != null ) and ( not ( "chaos_gem" == sobj.nameidx ) ) )
	 sobj := sobj.next;
	   if( sobj == null ) /* There was no ring here */
	   {
	sobj := load( "chaos_gem@demon_realm" );
	link( sobj, findroom( "courtyard_9@akaren" ) );
	   }
	 }

	 if( command( "shake" ) )
	 {
	  exec( "smile", self ); pause;
	  exec( "say Then get going, i am still missing some of the items.", self ); pause;
	  exec( "think", self ); pause;
	  if( not( "chaos staff" in pc.quests ) )
	  {
	   exec( "say The chaos staff is still missing.", self );
	   if( not( "chaos gem" in pc.quests ) )
	   {
	exec( "say And so is the gem of chaos.", self );
	if( not( "chaos ring" in pc.quests ) )
	 exec( "say AND the chaos ring!", self );
	   }
	   unsecure( pc );
	   goto start;
	  }
	  if( not( "chaos gem" in pc.quests ) )
	  {
	   exec( "say The gem of chaos is still missing.", self );
	   if( not( "chaos ring" in pc.quests ) )
	exec( "say And so is the chaos ring.", self );
	  unsecure( pc );
	  goto start;
	  }
	  if( not( "chaos ring" in pc.quests ) )
	   exec( "say I am still missing the chaos ring.", self );
	  unsecure( pc );
	  goto start;
	 }
	 exec( "say Very well then, I will tell you what i know again.", self ); pause;
	 exec( "say The items i need are all made of materials from the same beast.", self ); pause;
	 exec( "say I do not know where to find them but i know their names.", self ); pause;
	 exec( "think", self ); pause;
	 if( not( "chaos staff" in pc.quests ) )
	   exec( "say The first is the staff of chaos, and the rumors say it is in somewhere in HELL.", self ); pause;
	 if( not( "chaos ring" in pc.quests ) )
	 {
	   exec( "say The second item is the ring of chaos, this will be the easiest to find.", self ); pause;
	   exec( "say Because it is located somewhere in this demonic realm", self ); pause;
	 }
	 if( not( "chaos gem" in pc.quests ) )
	 {
	   exec( "say The third and final object is the most powerful of them.", self ); pause;
	   exec( "say It is the gem of chaos, which holds the eye of one of the chaos guardians.", self ); pause;
	   exec( "say I heard that he has hidden somewhere when he was walking in the realm of VALHALLA.", self ); pause;
	 }
	 unsecure( pc );
	 goto start;

   :no_inform:
	 unsecure( pc );
	 goto start;

   :lost_pc:
	 exec( "sigh", self ); pause;
	 exec( "say I guess " + _sx + " was not ready.", self ); pause;
	 unsecure( pc );
	 goto start;

   :ina_fight:
	 heartbeat := PULSE_SEC * 2;
	 while( self.position == POSITION_FIGHTING ) pause;
	 heartbeat := PULSE_SEC * 5;
	 goto start;

}
dilend

dilbegin finish_quest1();
external integer check_con@demon_realm(u1 : unitptr, nidx : string);
var
   stat   : integer;
   pc	  : unitptr;
   obj	  : unitptr;
   obj2   : unitptr;
   _sx	  : string;
   quest  : extraptr;
code{
	 heartbeat:=PULSE_SEC*5;
	 on_activation(self.position==POSITION_FIGHTING,ina_fight);
	 interrupt(SFB_COM,self.position==POSITION_FIGHTING,ina_fight);
   :loop:
	 wait(SFB_DONE,((target==self) and (command("give") or command("smile"))) or
			(command("poke") or command("slap")));
	 if( not( visible( self, activator ) ) ) goto loop;
	 pc:=activator;
	 secure(pc,lost_pc);
	 if(pc.sex==SEX_MALE)	 _sx:="he";
	 if(pc.sex==SEX_FEMALE)  _sx:="she";
	 if(pc.sex==SEX_NEUTRAL) _sx:="it";
	 if(activator.minv > 0) goto loop;
	 if(QUEST1_FINISHED in pc.quests) goto thank;
	 if(command("smile") or command("poke") or command("slap")) goto check_quest;
	 if(QUEST1_ONGOING in pc.quests)  goto get_item;
	 unsecure(pc);
	 goto loop;

   :ina_fight:
	 heartbeat:=PULSE_SEC*2;
	 while(self.position==POSITION_FIGHTING) pause;
	 heartbeat:=PULSE_SEC*5;
	 goto loop;

   :get_item:
	 if(not(QUEST1_ONGOING in pc.quests))
	 {
	  exec("say I dont need this!!",self);
	  exec("drop "+medium.name,self);
	  goto loop;
	 }
	 if(medium.nameidx=="chaos_gem")
	 {
	  if("chaos gem" in pc.quests)
	  {
	   exec("say I have already recieved this item from you.",self);
	   exec("give "+medium.name+" "+pc.name,self);
	  }
	  else
	  {
	   destroy(medium);
	   quest:=QUEST1_ONGOING in pc.quests;
	   addstring(quest.names, "chaos gem");
	   exec("say Ahh... I see you found the guardians eye.",self);
	   exec("say Hope i didn't make you run all over the world for this.",self);
	   exec("say It will allow the spell to locate my son.",self);
	  }
	 }
	 else if(medium.nameidx=="chaos_staff")
	 {
	  if("chaos staff" in pc.quests)
	  {
	   exec("say I have already recieved this item from you.",self);
	   exec("give "+medium.name+" "+pc.name,self);
	  }
	  else
	  {
	   destroy(medium);
	   quest:=QUEST1_ONGOING in pc.quests;
	   addstring(quest.names, "chaos staff");
	   exec("say The powerful staff of chaos, this will draw the power to the spell.",self);
	  }
	 }
	 else if(medium.nameidx=="chaos_ring")
	 {
	  if("chaos ring" in pc.quests)
	  {
	   exec("say I have already recieved this item from you.",self);
	   exec("give "+medium.name+" "+pc.name,self);
	  }
	  else
	  {
	   destroy(medium);
	   quest:=QUEST1_ONGOING in pc.quests;
	   addstring(quest.names, "chaos ring");
	   exec("say This ring will bind the magic power.",self);
	  }
	 }
	 else
	 {
	  exec("say I dont need this!!",self);
	  exec("drop "+medium.name,self);
	 }
   :check_quest:
	 if(("chaos gem" in pc.quests) and
	("chaos staff" in pc.quests) and
	("chaos ring" in pc.quests)) goto finish;
	 unsecure(pc);
	 goto loop;

   :finish:
	 exec( "thank " + pc.name, self ); pause;
	 exec( "say I will now start the ritual.", self ); pause;
	 exec( "emote utters the words 'gnystz dhgx'", self );
         act( "A pot appears before you.", A_SOMEONE, self, null, null, TO_ALL ); pause;
         act( "As you try to touch the pot, you realise that it does not really exist.", A_SOMEONE, self, null, null, TO_ALL ); pause;
	 exec( "emote puts the ring in the pot.", self ); pause;
	 exec( "emote puts the staff in the pot.", self ); pause;
	 exec( "emote puts the gem in the pot.", self ); pause;
	 exec( "emote utters the words 'eg gim nys'", self ); pause;
         act( "There is a great flash!", A_SOMEONE, self, null, null, TO_CHAR ); pause;
	 exec( "sniff", self ); pause;
	 exec( "sigh", self ); pause;
	 exec( "say My son is alive!", self ); pause;
	 exec( "thank " + pc.name, self ); pause;
	 exec( "say I need to find a way to talk to him.", self ); pause;
	 exec( "say "+pc.name+", I may need you help again later on.", self ); pause;
	 exec( "say But first i have to figure out a way to talk to my son.", self ); pause;
	 exec( "sniff", self ); pause;
	 exec( "say Please stop by later, i will tell you when i have found a way.", self ); pause;
	 exec( "thank " + pc.name, self );
	 subextra( pc.quests, QUEST1_ONGOING );
	 addextra( pc.quests, {QUEST1_FINISHED}, "" );
	 experience( 5000, pc );
	 obj := load( "magic_bag@demon_realm" );
	 obj2 := load( "pend_of_loc@demon_realm" );
	 obj2.height := pc.height;
	 link( obj2, obj );
	 exec( "give " + obj.name + " " + pc.name, self );
         act( "You have gained 5000xp", A_SOMEONE, pc, null, null, TO_CHAR );
	 unsecure( pc );
	 goto loop;

   :thank:
	 stat := check_con( pc, "magic_bag" );
	 if( stat == 0 )
	  goto reimb_bag;
	 exec( "thank " + pc.name, self );
	 exec( "say I have not found a way yet, but thankyou for stopping by.", self );
	 unsecure( pc );
	 goto loop;

   :reimb_bag:
	 exec( "say I can see you have lost the bag i gave you.",self); pause;
	 exec( "say I owe you enough to give you another one.",self); pause;
	 sendtoalldil( pc.name,"bag_own@demon_realm");
	 obj := load("magic_bag@demon_realm");
	 addextra(obj.extra,{"$owner"},pc.name);
	 exec("give "+obj.name+" "+pc.name,self);;
	 exec("smile "+pc.name,self);
	 unsecure(pc);
	 goto loop;

   :lost_pc:
	 exec("sigh",self); pause;
	 exec("say I guess "+_sx+" was not ready.",self); pause;
	 unsecure(pc);
	 goto loop;

}
dilend

end  /* End of Mayor */
/******************************************************************/
	 morgia
names {"morgia","banker","ghost"}
title "Morgia the banker"
descr "A ghost hovers above the ground."
extra {}
"The ghost actually seems to have a solid body, but when you look at the head
you can almost see straight through it. Wierd!"

extra {"head"}
"There is no head.. It looks like some sort of mist..."

money 1 SILVER_PIECE

flags {UNIT_FL_NO_TELEPORT}

GREATER_GHOST(80,SEX_FEMALE)

special SFUN_BANK

end  /* End of morgia */
/******************************************************************/
	 tsaar_ghost
names {"tsaar ghost","ghost"}
title "Ghost of Tsaar"
descr "A ghost hovers above the ground."
extra {}
"There is no part of its body that can be distinguished."

LESSER_GHOST(60,SEX_MALE)

dilcopy ghost_walk@demon_realm();

end  /* End of Tsaar Ghost */
/******************************************************************/
	 ghost_guard
names {"ghost guard","ghost","guard"}
title "Ghost guard"
descr "A ghost hovers here."
extra {}
"The ghost of a guard who seems to have been through a major battle. You can
clearly see that he has been fighting someone with great power by looking at
the expression of his face. It looks like he would rather die than neglect his
duties, and that is probabaly why he died too."

extra {"expression on face","face","expression"}
"The face has frozen in a horrble grimace of terror, whoever did this to him
must have had some great powers."

LESSER_GHOST(70,SEX_MALE)
MSET_WEAPON(6,20,6,6,6,6)

end  /* End of Ghost guard */
/******************************************************************/
	 ghost_healer
names {"ghost healer","ghost","healer"}
title "Ghost healer"
descr "A ghost cleric hovers here."
extra {}
"The ghost of a friar. There is nothing special about him and the only purpose
he has is to heal people for money.&n
10 pp for heal.&n
50 pp for resurrect."

GREATER_GHOST(40,SEX_MALE)
MSET_WEAPON(6,6,6,6,20,6)
MSET_SPELL(30,2,2,2,2,2,2,2,2,2,2)

flags {UNIT_FL_NO_TELEPORT}

dilbegin ghost_heal();
var
   pc	  : unitptr;
   tar	  : unitptr;
   num	  : integer;
   cnt	  : integer;
   stat   : integer;
   itim   : integer;
   random : integer;
   crap   : unitptr;
code{
   :init:
	 heartbeat:=PULSE_SEC*3;
	 stat:=0;
	 interrupt(SFB_CMD,command("heal") and (stat==0),not_payed);
   :loop:
	 heartbeat:=PULSE_SEC*3;
	 wait(SFB_DONE,command("give") and (self==target));
	 if( not( medium.type & UNIT_ST_OBJ ) )
	 {
	  exec( "say What am i supposed to do with this?", self );
	  goto loop;
	 }
	 if("pieces" in medium.name)
	 {
	  if(medium.name=="platinum pieces")
	  {
	   num:=atoi(getword(medium.title));
	   destroy(medium);
	   if(num<10)
	   {
	exec("say This is not enough!",self);
	goto loop;
	   }
	   if(num<20)
	   {
	 heartbeat:=PULSE_SEC*3;
	 pause;
	   :retry:
	 heartbeat:=PULSE_SEC*30;
	 exec("say Heal who?",self);
	 itim:=interrupt(SFB_TICK,TRUE,fooled);
	 wait(SFB_DONE,command("say"));
	 clear(itim);
	 tar:=findunit(self,argument,FIND_UNIT_SURRO,null);
	 if(tar==null)
	 {
	  exec("say There is noone with that name here.",self);
	  goto retry;
	 }
	 exec("say Ok, I will heal "+tar.name,self);
	 random:=cast_spell(SPL_CURE_WOUNDS_2,self,self,tar,"");
	 goto loop;
	   }
	   heartbeat:=PULSE_SEC*3;
	   pause;

	 :retry2:
	   heartbeat:=PULSE_SEC*30;
	   exec("say Resurrect who?",self);
	   itim:=interrupt(SFB_TICK,TRUE,fooled);
	   wait(SFB_DONE,command("say"));
	   clear(itim);
	   tar:=findunit(self,argument,FIND_UNIT_WORLD,null);
	   if( ( tar == null ) or ( tar.minv > activator.level ) )
	   {
	exec("say There is noone with that name here.",self);
	goto retry2;
	   }
	   crap:=findunit(activator,"corpse of "+tar.name,FIND_UNIT_SURRO,null);
	   if(crap!=null)
	   {
	if(isset(tar.pcflags,PC_SPIRIT))
	{
	 exec("say Ok, I will try to resurrect "+tar.name,self);
	 cnt:=0;
	 while(isset(tar.pcflags,PC_SPIRIT))
	 {
	  cnt:=cnt+1;
	  if(cnt==20) break;
	  random:=cast_spell(SPL_RESURRECTION,self,self,tar,"");
	  pause;
	 }
	 if(cnt==20)
	 {
	  exec("say I can't reach the soul of "+tar.name,self);
	  exec("sigh",self);
	 }
	 else
	  exec("say Well.. I have saved another soul.",self);
	}
	else
	{
	 exec("say "+tar.name+" is not in the spirit realm, I can not help.",self);
	}
	   }
	   else
	   {
	exec("say The corpse of "+tar.name+" is not here, i can't resurrect "+tar.name,self);
	   }
	   goto loop;

	  }
	  if((medium.name=="gold pieces") or
	 (medium.name=="silver pieces") or
	 (medium.name=="copper pieces") or
	 (medium.name=="iron pieces"))
	  {
	   exec("emote is burnt by the money.",self);
	   exec("drop "+argument,self);
	   exec("howl",self);
	   goto loop;
	  }
	 }
	 exec("say What am i going to do with this?",self);
	 exec("drop "+argument,self);
	 goto loop;

   :fooled:
	 exec("say I dont have all day!!",self);
	 clear(itim);
	 goto loop;

   :not_payed:
	 exec("say You have not payed me yet...",self);
	 block;
	 goto loop;

   :lost_tar:
	 unsecure(tar);
	 goto loop;
}
dilend

end  /* End of Ghost Healer */
/******************************************************************/
	 gwendy
names {"gwendy","ghost shopkeeper","ghost","shopkeeper"}
title "Gwendy the shopkeeper"
descr "The ghost of Gwendy is here."
extra {}
"
It is the ghost of Gwendy, the Tsaar armoureress. Her body is very solid
compared to the other ghosts in this town.
"

GREATER_GHOST(60,SEX_FEMALE)

end  /* End of Gwendy */
/******************************************************************/
	 erthar
names {"erthar","ghost shopkeeper","ghost","shopkeeper"}
title "Erthar the shopkeeper"
descr "Erthar the ghost shopkeeper"
extra {}
"
The ghost of a once powerful human, his upper body in now only a blur but you
can still make out the muscles. If this guy was alive, you would not want to
mess with him."

extra {"upper body","upper"}
"This looks like it once was the upper body of a great blacksmith."

GREATER_GHOST(60,SEX_MALE)

dilcopy shopkeeper@function(
{
 "m_dagger@demon_realm 2 10","m_longsword@demon_realm 2 10",
 "m_greatsword@demon_realm 2 10","m_war_hammer@demon_realm 2 10",
 "m_war_mattock@demon_realm 2 10"
},
{
 "$1n says, 'I have no such weapon in my store'",
 "$1n says, 'You don't have anything like that!'",
 "$1n says, 'I have no use for such a thing'",
 "$1n says, 'You can't afford that, come back when you have the money for it!'",
 "$1n says, 'Come back when you need some other weapon'",
 "$1n says, 'I'll put this in my store, thank you very much'",
 "$1n says, 'Damn, the stock is a bit empty. I don't have that amount'",
 "$1n says, 'What in the damnation do you want me to do with this?'",
 "$1n says, 'I can't afford that!"
}, {"4","22"},"5",
140, 70, 6*PLATINUM_MULT, "shopclose@demon_realm","()" );

end  /* End of Erthar */
/******************************************************************/
	 aina
names {"aina","ghost shopkeeper","ghost","shopkeeper"}
title "Aina the shopkeeper"
descr "Aina the ghost shopkeeper"
extra {}
"
As you look at this ghost you realise that she was once a very beutiful young
woman. When you examine her more throughly you realise that she has no marks
of damage on her so called body, there are no burns of any kind. You stare at
her for a long time before you realise that she is fading in and out of reality."

extra {"body"}
"Her curves is in exactly the right places."

GREATER_GHOST(60,SEX_MALE)

dilcopy shopkeeper@function(
{
 "s_ring@demon_realm 4 10","g_ring@demon_realm 4 10",
 "r_ring@demon_realm 4 10","d_ring@demon_realm 4 10","j_neck@demon_realm 4 10",
 "d_neck@demon_realm 4 10","g_ear@demon_realm 5 15","d_ear@demon_realm 5 15"
},
{
 "$1n says, 'I am so sorry, but I have no such thing in stock right now'",
 "$1n says, 'Why are you trying to sell me a thing that you do not have?'",
 "$1n says, 'I don't see the use for that, sorry'",
 "$1n says, 'It don't seem like you can afford it'",
 "$1n says, 'Nice doing business with you, enjoy the $2n'",
 "$1n says, 'Nice $2n, I thank you for this'",
 "$1n says, 'I don't have that amount in my stock right now'",
 "$1n says, 'The store will open in one hour'",
 "$1n says, 'What in the damnation do you want me to do with this?'",
 "$1n says, 'I can't afford that!"
}, {"4","22"},"12",
130, 80, 6*PLATINUM_MULT, "shopclose@demon_realm","()" );

end  /* End of Aina */
/******************************************************************/
	 erika
names {"erika","ghost shopkeeper","ghost","shopkeeper"}
title "Erika the shopkeeper"
descr "Erika the ghost shopkeeper"
extra {}
"
This young lady seems to have died at an early age, by looking at her face and
hands your guess is that she died around the age of 20. Her silver white hair
covers her eyes."

extra {"silver white hair","silver hair","white hair","hair"}
"Her hair is as beautiful as a spring that runs free, the wind seems to grab
hold of her hair every once in a while but there is no wind at all."

extra {"eyes"}
"As you look at her eyes you realise that she is great pain, and your stomach
twists and turns."

GREATER_GHOST(60,SEX_MALE)

dilcopy shopkeeper@function(
{
 "c_potion@demon_realm 3 20","p_potion@demon_realm 3 20",
 "y_potion@demon_realm 3 20"
},
{
 "$1n says, 'I don't have such a thing in my store, sorry'",
 "$1n says, 'You don't have anything like that $3N!",
 "$1n says, 'I don't have any use for that'",
 "$1n says, 'You don't even have the money for it!'",
 "$1n says, 'Hope you're satisfied with your $2n'",
 "$1n says, 'I might have some use for this $2n'",
 "$1n says, 'I don't have that many in my stock right now'",
 "$1n says, 'The store will open in one hour'",
 "$1n says, 'What in the damnation do you want me to do with this?'",
 "$1n says, 'I can't afford that!"
}, {"4","22"},"10",
135, 85, 6*PLATINUM_MULT, "shopclose@demon_realm","()" );

end  /* End of Erika  */
/******************************************************************/
	 beggar
names {"ghost beggar","ghost","beggar"}
title "Ghost beggar"
descr "A ghost beggar."

extra {}
"The only thing you can see is a slight blue mist, which seem to hover about
1 feet above the ground. You can make out some sort of hands which seem to hold
a cup. You guess is that this is a beggar. This poor thing looks as if it is
fading away from reality."

extra {"hands","hand","cup"}
"These so called hands are formed like a cup."

LESSER_GHOST(60,SEX_NEUTRAL)

dilbegin beg();
var
 vict : unitptr;
code{
	 interrupt( SFB_DONE, command( CMD_GIVE ) and ( self == target ), thank );
   :loop:
	 wait( SFB_TICK, command( CMD_AUTO_TICK ) );
	 vict := findrndunit( self, FIND_UNIT_SURRO, UNIT_ST_PC );
	 if( vict )
	 {
	   if( vict.sex == SEX_MALE )
	   exec( "say A copper coin kind sir?", self );
	  else if( vict.sex == SEX_FEMALE )
	   exec( "say A copper coin kind miss?", self );
	  else
	   exec( "say A copper coin kind thing?", self );
	 }
	 goto loop;

   :thank:
	 exec( "thank " + activator.name, self );
	 act( "$1n eats $2n.", A_SOMEONE, self, medium, null, TO_ROOM );
	 destroy( medium );
	 goto loop;
}
dilend

end  /* End of Beggar */
/******************************************************************/
/*################################################################
  ################################################################*/
%objects
/******************************************************************/
         light_bracelet
names {"lightbracelet","bracelet"}
title "&c+bBracelet of light&cw"
descr "A shining bracelet lies on the ground."

extra {}
"A bracelet of pure light lies on the ground."

extra {"$identify"}
"This bracelet will increase your physical abilities."

extra {"$improved identify"}
"This bracelet will increase your strength by 3 and dexterity by 1."

manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_WRIST, MANIPULATE_HOLD}
flags {UNIT_FL_MAGIC}
weight 1

STR_TRANSFER( +1 )


dilcopy ali_restrict@function( 1000, 350, 0, 0, "" );
dilcopy level_restrict@function( 50, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 100, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_DEX, 100, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_BRA, 80, 0, 0, "" );

end
/******************************************************************/
	 peddler_swo
names {"lightsword","sword"}
title "&c+blightsword&cw"
descr "A sword with a &c+bblue&cw blade and wooden handle lies here."

WEAPON_DEF( WPN_LONG_SWORD, 0, 0 )

extra {}
"The blade of this sword looks like steel of some sort, but it weighs
to little to be and metal that you have heard of."

extra {"$improved identify"}
"Craftmanship: 0&n
Magical modifier: 0&n
This magical blade can chop off limbs when the word 'skiva' is
expressed in combat by the wielder."

dilbegin chop();
var
 slump	: integer;
code{
   :loop:
     wait( SFB_DONE, command( CMD_SAY ) and ( argument == "skiva" ) and ( self.equip == WEAR_WIELD ) );
     if( self.alignment <= 0 ) goto loop;
     act( "The blade of $1n's $2n gives out a sudden burst of light.", A_SOMEONE, self.outside, self, null, TO_ROOM );
     act( "The blade of your $2n gives out a sudden burst of light.", A_SOMEONE, self.outside, self, null, TO_CHAR );

     act( "$1n's $2n cuts deep into the body of $3n who screams in agony!", A_SOMEONE, self.outside, self, self.outside.fighting, TO_REST );
     act( "Your $2n cuts deep into the body of $3n who screams in agony!", A_SOMEONE, self.outside, self, self.outside.fighting, TO_CHAR );
     act( "$1n's $2n cuts deep into your body.", A_SOMEONE, self.outside, self, self.outside.fighting, TO_VICT );
     act( "You SCREAM in agony!", A_SOMEONE, self.outside.fighting, null, null, TO_CHAR );

     slump := rnd( 1, 3 );
     if( slump < 3 ) dilcopy( "chop_leftarm@demon_realm", self.outside.fighting );
     else dilcopy( "chop_rightarm@demon_realm", self.outside.fighting );
     goto loop;
}
dilend

dilbegin recall charge();
var
 muyear   : integer;
 mumonth  : integer;
code{
     muyear  := mudyear;
     mumonth := mudmonth;
     heartbeat := PULSE_SEC * 60 ;
   :loop:
     if( ( mumonth < mudmonth ) or ( muyear < mudyear ) )
     {
      if( self.equip )
      {
       act( "The blade of $1n's $2n shines slightly.", A_SOMEONE, self.outside, null, null, TO_ROOM );
       act( "The blade of your $2n shines slightly.", A_SOMEONE, self, null, null, TO_CHAR );
      }
      self.alignment := 1;
      muyear  := mudyear;
      mumonth := mudmonth;
     }
     pause;
     goto loop;
}
dilend

end
/******************************************************************/
	 demon_gem
names {"demon gem","gem"}
title "the demon gem"
descr "A black gem lies pulsating on the ground."

type ITEM_TREASURE

extra {}
"You dare not look at the gem long enough to get a good description."

cost 2 GOLD_PIECE
rent 1 GOLD_PIECE

end
/******************************************************************/
	 note_1
names {"ancient note","note"}
title "an ancient note"
descr "An ancient note lies on the ground."

type ITEM_NOTE

extra {}
"This is the last notification I'll be able to make.&n
I was watching from my cell when Ishlor made his legendaric
Mortifier, i also heard him weave a spell into it before they came for me.
When in combat speak the word 'adod' and the sword will aid you.
Take care not to use it to often, if the mortifier is used without having
enough energy it will be unable to control the magic powers set free
and what happens cannot be predicted."

end
/******************************************************************/
	 anya_corpse
names {"corpse of anya","corpse"}
title "a corpse"
descr "The corpse of Anya lies here."

dilbegin decompose();
code{
	 heartbeat := PULSE_SEC * 60;
	 pause;
	 act( "There is a smell of a rotting corpse.", A_HIDEINV, self.outside.inside, null, null, TO_ROOM );
	 pause;
	 act( "There is a smell of a rotting corpse.", A_HIDEINV, self.outside.inside, null, null, TO_ROOM );
	 pause;
	 act( "There is a smell of a rotting corpse.", A_HIDEINV, self.outside.inside, null, null, TO_ROOM );
	 pause;
	 act( "A horde of maggots consume a corpse.", A_HIDEINV, self.outside.inside, null, null, TO_ROOM );
	 destroy( self );
}
dilend

end
/******************************************************************/
	 anklet_spd
names {"anklet of speed","anklet"}
title "anklet of speed"
descr "An old anklet lies here."
extra {}
"An old rusty iron anklet which looks like it'll fall apart at any moment."

MATERIAL_METAL("Rusty iron")

manipulate {MANIPULATE_WEAR_ANKLE}

ARMOUR_CHAIN( -15, 0 )

DEX_TRANSFER(+1)

end
/******************************************************************/
	 p_cloak
names {"dark cloak","cloak"}
title "dark cloak"
descr "A dark cloak is lying here on the ground."
extra {}
"This is a well worn cloak which has a lot of small holes in it, the lower part
is completely shredded. There is a golden stripe on the collar, which is
shining slightly in the light."

extra {"$identify"}
"The cloak makes you harder to kill."

extra {"$improved identify"}
"The cloak increases your durability in combat."

extra {"$wear_s"}
"You wrap the $2n around you."

extra {"$wear_o"}
"$1n wraps the $2n around $1mself."

flags {UNIT_FL_MAGIC}

manipulate {MANIPULATE_TAKE,MANIPULATE_HOLD,MANIPULATE_WEAR_ABOUT}

cost 1 GOLD_PIECE
rent 3 COPPER_PIECE, 1 IRON_PIECE


/*CHAR_FLAG_TRANSFER(UNIT_FL_INVISIBLE)*/
HIT_TRANSFER(+1)

dilcopy level_restrict@function( 30, 0, 0, "" );

end
/******************************************************************/
	 sp_pend
names {"spider pendant","pendant"}
title "spider pendant"
descr "A pendant which resembles a spider lies here."
extra {}
"The spider is actually a real one that has been petrified, it looks very
beautiful and you think that it might have some mystic powers. Why else would
anyone bother to make a pendant of it?"

extra {"$identify"}
"This pendant increases your knowledge in diseases and poisons, it also
enhances your brain."

extra {"$improved identify"}
"This pendant increases your knowledge in diseases and poisons, it also
enhances your brain. It raises you BRA by 2 and internal sphere by 10%."

extra {"$wear_s"}
"You put the $2N around your neck, it feels heavy."

extra {"$wear_o"}
"$1n puts the $2N around $1s neck."

extra {"$rem_s"}
"As you remove the $2N you feel very easy about yourself."

extra {"$rem_o"}
"$1n removes the $2N from around $1s neck."

flags {UNIT_FL_MAGIC}

manipulate {MANIPULATE_TAKE,MANIPULATE_HOLD,MANIPULATE_WEAR_NECK}

BRA_TRANSFER(+1)
cost 7 GOLD_PIECE
rent 2 SILVER_PIECE, 6 COPPER_PIECE, 3 IRON_PIECE

dilcopy level_restrict@function( 40, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_BRA, 80, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_MAG, 40, 0, 0, "" );

end
/******************************************************************/
	 vault_closer
title "vault closer"

flags {UNIT_FL_NO_TELEPORT}

dilbegin vault_close();
code{
	heartbeat:=PULSE_SEC*2;
	sendtoall("close","bank_of_tsaar@demon_realm");
	pause;
	destroy(self);
}
dilend

end
/******************************************************************/
		   pend_of_loc
names {"pendant of location","pendant"}
title "Pendant of location"
descr "A rock pendant lies here."
extra {}
"This is an ordinary black rock pendant."

extra {"$identify"}
"This pendant can help you locate persons/objects by writing locate <object>.
It also makes you feel closer to your god."

extra {"$improved identify"}
"Casts the find path spell, and also adds 1 to your div when worn."

DIV_TRANSFER(+1)
manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_NECK}
type ITEM_TREASURE
MATERIAL_ORGANIC("Grey stone")
flags {UNIT_FL_MAGIC}
weight 2
cost 1 PLATINUM_PIECE,2 GOLD_PIECE
rent 4 SILVER_PIECE

spell 70

dilbegin locate();
var
   tar	: unitptr;
   crap : integer;
code{
   :start:
	 wait(SFB_CMD,(command("locate")) and (self.outside.type==UNIT_ST_PC) and
		  ((self.equip==WEAR_NECK_1) or (self.equip==WEAR_NECK_2)));
	 if(self.outside!=activator) goto start;
	 block;
	 if(not(QUEST1_FINISHED in self.outside.quests))
	 {
	  act("As you concentrate on the pendant, you realise that you dont know how it works.",
		  A_SOMEONE,self.outside,null,null,TO_CHAR);
	  goto start;
	 }
	 if(self.outside.mana<5) goto start;
	 tar:=findunit(self.outside,argument,FIND_UNIT_WORLD,null);
	 if((tar==null) or (tar.minv > self.outside.level))
	 {
          act("There is no such unit.",A_SOMEONE,self.outside,null,null,TO_CHAR);
	  goto start;
	 }
	 self.outside.mana:=self.outside.mana-5;
	 crap:=cast_spell(SPL_FIND_PATH,self.outside,self,tar,"");
	 goto start;
}
dilend

dilcopy abi_restrict@function( ABIL_BRA, 80, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_CHA, 75, 0, 0, "" );

end  /* End of Pendant Of Location */
/******************************************************************/
		 g_robe
names {"guardian robe","robe"}
title "guardian robe"
descr "A shimmering robe lies here."
extra{}
"The robe is made of an unknown material and it is constantly
shifting colors. The collar has all the colours of the rainbow, and it looks
as if it is adapting to the weather."

extra {"collar"}
"The collar has all the colours of the rainbow, and it seems to be adapting
to the weather."


extra {"$wear_s"}
"You wrap the $2N around yourself, it feels nice and smooth."

extra {"$wear_o"}
"$1n wraps the $2N around $1mself."

extra {"$remove_s"}
"You remove the $2N from around your body, you miss it already."

extra {"$remove_o"}
"$1n removes the $2N."

ARMOUR_CHAIN(0,0)

manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_ABOUT}
flags {UNIT_FL_MAGIC}

weight 10
cost 7 GOLD_PIECE
rent 2 SILVER_PIECE, 6 COPPER_PIECE, 3 IRON_PIECE

dilcopy level_restrict@function( 30, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_MAG, 50, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_CHA, 50, 0, 0, "" );

end /* Guardian Robe */
/*======================================*/
		 g_staff
names {"guardian staff","staff"}
title "guardian staff"
descr "A guardian staff lies here."
extra {}
"The aura the staff emits is an aura of incredible power."

WEAPON_DEF(WPN_QUARTERSTAFF,13,5)

manipulate {MANIPULATE_TAKE, MANIPULATE_WIELD}
flags {UNIT_FL_MAGIC}

weight 8
cost 6 GOLD_PIECE
rent 2 SILVER_PIECE, 3 COPPER_PIECE, 1 IRON_PIECE

dilcopy level_restrict@function( 50, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_MAG, 30, 0, 0, "" );

end /* Guardian Staff */
/******************************************************************/
		 mortifier
names {"mortifier","sword"}
title "Mortifier"
descr "A great sword lies here."

manipulate {MANIPULATE_TAKE,MANIPULATE_WIELD,MANIPULATE_HOLD}
WEAPON_DEF(WPN_GREAT_SWORD,7,7)
flags {UNIT_FL_MAGIC}

extra {}
"The sword is crafted in a black metal. The sword has a great skull of a
demon a bit above the handle. It also has some runes carved into it.
This sword has somehow changed size. It now fits you perfectly."

MATERIAL_METAL("A black unknown metal.")

extra {"runes"}
"You cant make out what they say, but you feel that they somehow have
great power."

extra {"skull on sword","great skull","demon skull","skull"}
"This skull has somehow become part of the sword. Its horns make out two
of the swords three blades."

extra {"swordhandle","handle"}
"The handle is made of pure diamond."

extra {"black metal","metal"}
"This metal feels and looks like steel, but it does not weigh as much
as it should."

extra {"$identify"}
"This sword raises your physical strength to allow combat with demons."

extra {"$improved identify"}
"The sword raises your STR by 1,DEX by 1, adds 7% to greatsword skill."

extra {"$wear_s"}
"You wield the mighty $2N, you can feel the power as you hold it in you hand."

extra {"$wear_o"}
"$1n wields the mighty $2N, you can see a sparkle in $1s eyes."

extra {"$rem_s"}
"As you stop using the $2N you feel an emptyness in your soul."

extra {"$rem_o"}
"$1n stops using the $2N, YOU WANT IT."

STR_TRANSFER(+1)
DEX_TRANSFER(+1)
WEAPON_TRANSFER(WPN_GREAT_SWORD,+7)
spell 68                           /* Spell level */

cost 4 PLATINUM_PIECE, 5 GOLD_PIECE, 4 SILVER_PIECE
rent 1 GOLD_PIECE, 7 SILVER_PIECE

weight 30

dilbegin mortifierdil();
var
   enemy	: unitptr;
   random	: integer;
   stop_int : integer;
code {
   :init:
	 heartbeat:=PULSE_SEC;
	 interrupt(SFB_DONE,command("remove") and (self==medium),remove_dil);
   :start:
	 wait(SFB_CMD,((activator==self.outside) and (self.equip==WEAR_WIELD)) and
		   (command("adod")));
	 block;
	 if(self.alignment<20)
	 {
          act("You hear a faint voice saying 'I need blood...'",A_SOMEONE,self.outside,null,null,TO_CHAR);
	  goto start;
	 }

	 self.alignment := self.alignment - 20;
	 if( self.outside.fighting.level < IMMORTAL_LEVEL )
	   random:=cast_spell(SPL_ACIDBALL_2,self.outside,self,self.outside.fighting,"mort_aff@demon_realm");
	 goto start;

   :remove_dil:
	 if(dilfind("mort_load@demon_realm",self.outside))
	   random:=dildestroy("mort_load@demon_realm",self.outside);
	 goto start;
}
dilend

dilbegin mort_skill();
var
   ute : unitptr;
   plr : unitptr;
code
{
	 heartbeat:=PULSE_SEC * 30;
         interrupt( SFB_TICK, self.equip, tick_check );
         interrupt( SFB_DONE, command( CMD_REMOVE ) and ( self == medium ), start );
   :start:
         wait( SFB_CMD, ( command( CMD_WEAR ) or command( CMD_WIELD ) ) and ( activator == self.outside ) );
         ute := findunit( self.outside, argument, FIND_UNIT_INVEN, null );
         if( ute != self )
          goto start;

   :check_skill:
         if( self.equip == WEAR_HOLD ) goto start;
	 if( ( self.outside.weapons[ WPN_GREAT_SWORD ] < 80 ) and
             ( self.outside.type & UNIT_ST_PC ) )
	 {
	  ute := self;
	  while( ute.type != UNIT_ST_ROOM )
	   ute := ute.outside;
	  plr := self.outside;
          act( "You hear a large sigh.",A_SOMEONE,plr,null,null,TO_CHAR);
	  act( "You hear a large sigh as $1n's $2N drops to the ground.",
                   A_SOMEONE,plr,self,null,TO_REST);
	  link( self, ute );
	 }
	 else
	 {
	  if( not( dilfind( "mort_load@demon_realm", self.outside ) ) )
           dilcopy( "mort_load@demon_realm", self.outside );
	 }
	 goto start;

   :tick_check:
	 if( ( self.outside.weapons[ WPN_GREAT_SWORD ] < 80 ) and
	 ( self.outside.type & UNIT_ST_PC ) )
	 {
	  ute := self;
	  while( ute.type != UNIT_ST_ROOM )
	   ute := ute.outside;
	  plr := self.outside;
          act( "You hear a large sigh.",A_SOMEONE,plr,null,null,TO_CHAR);
          act( "You hear a large sigh as $1n's $2N drops to the ground.",A_SOMEONE,plr,self,null,TO_REST);
	  link( self, ute );
	 }
	 goto start;
}
dilend

dilbegin mort_spell();
/* Lightning from sky, costs 100 mana. */
var
   ute	  : unitptr;
   random : integer;
code{
	  heartbeat:=PULSE_SEC*30;
	:start:
	  wait(SFB_CMD,((activator==self.outside) and (self.equip==WEAR_WIELD)) and
		   (command("mortem")));
          if( cmdstr != "mortem" ) goto start;
          block;
          act("You call for the lightning to strike.",A_SOMEONE,self.outside,null,null,TO_CHAR);
          act("$1n calls for the lightning to strike.",A_SOMEONE,self.outside,null,null,TO_ROOM);
	  ute:=self;
	  while(ute.type!=UNIT_ST_ROOM) ute:=ute.outside; /* Find room. */
	  if(self.alignment<=0)
	  {
           act("You hear a THUNDEROUS noise.",A_SOMEONE,self.outside,null,null,TO_ALL);
	   if(isset(ute.flags,UNIT_FL_INDOORS))
	   {
	act("A lightningbolt strikes through the ceiling and hits your $2N.",
                   A_SOMEONE,self.outside,self,null,TO_CHAR);
	act("A lightningbolt strikes through the ceiling and hits $1s $2N.",
		   A_SOMEONE,self.outside,self,null,TO_REST);
	   }
	   else
	   {
	act("A lightningbolt strikes from the sky and hits your $2N.",
                   A_SOMEONE,self.outside,self,null,TO_CHAR);
	act("A lightningbolt strikes from the sky and hits $1s $2N.",
		   A_SOMEONE,self.outside,self,null,TO_REST);
	   }
           act("Your $2N is disintigrated by the power of the lightning.",A_SOMEONE,self.outside,self,null,TO_CHAR);
	   act("$1n's $2N is disintigrated by the power of the lightning.",A_HIDEINV,self.outside,self,null,TO_REST);
	   random:=dildestroy("mort_load@demon_realm",self.outside);
	   destroy(self);
	  }
	  if(self.alignment<100) goto start;
	  self.alignment:=self.alignment-100;
	  if(self.outside.fighting==null)
	  {
           act("You hear a THUNDEROUS noise.",A_SOMEONE,self.outside,null,null,TO_ALL);
	   if(isset(ute.flags,UNIT_FL_INDOORS))
         act("A lightningbolt strikes through the ceiling and hits the floor.",A_SOMEONE,self.outside,null,null,TO_ALL);
	   else
         act("A lightningbolt strikes from the sky and hits the ground.",A_SOMEONE,self.outside,null,null,TO_ALL);
           act("Causing a major tremmor, after a few seconds it's gone.",A_SOMEONE,self.outside,null,null,TO_ALL);
	   goto start;
	  }
          act("You hear a THUNDEROUS noise.",A_SOMEONE,self.outside,null,null,TO_ALL);
	  if(self.outside.fighting.level>IMMORTAL_LEVEL)
	  {
	   if(isset(ute.flags,UNIT_FL_INDOORS))
	   {
	 act("A lightningbolt strikes through the ceiling, but as it hits $2n it gets absorbed.",
		A_SOMEONE,self.outside,self.outside.fighting,null,TO_NOTVICT);
	 act("A lightningbolt strikes through the ceiling, but as it hits $2n it gets absorbed.",
		A_SOMEONE,self.outside,self.outside.fighting,null,TO_CHAR);
	 act("A lightningbolt strikes through the ceiling.",
                A_SOMEONE,self.outside,self.outside.fighting,null,TO_VICT);
	   }
	   else
	   {
	 act("A lightningbolt strikes from the sky, but as it hits $2n it gets absorbed.",
		A_SOMEONE,self.outside,self.outside.fighting,null,TO_NOTVICT);
	 act("A lightningbolt strikes from the sky, but as it hits $2n it gets absorbed.",
		A_SOMEONE,self.outside,self.outside.fighting,null,TO_CHAR);
	 act("A lightningbolt strikes from the sky.",
                A_SOMEONE,self.outside,self.outside.fighting,null,TO_VICT);
	   }
	   act("You can feel the power flowing through your body as it hits you.",
                  A_SOMEONE,self.outside,self.outside.fighting,null,TO_VICT);
	   goto start;
	  }
	  if(isset(ute.flags,UNIT_FL_INDOORS))
	  {
	   act("A lightningbolt strikes through the ceiling and hits $2n in $2s head.",
		  A_SOMEONE,self.outside,self.outside.fighting,null,TO_NOTVICT);
	   act("A lightningbolt strikes through the ceiling and hits $2n in $2s head from the sky.",
		  A_SOMEONE,self.outside,self.outside.fighting,null,TO_CHAR);
	   act("A lightningbolt strikes through the ceiling and hits you in your head from the sky.",
		  A_SOMEONE,self.outside,self.outside.fighting,null,TO_VICT);
	  }
	  else
	  {
	   act("A lightningbolt strikes $2n in $2s head from the sky.",
		  A_SOMEONE,self.outside,self.outside.fighting,null,TO_NOTVICT);
	   act("A lightningbolt strikes $2n in $2s head from the sky.",
		  A_SOMEONE,self.outside,self.outside.fighting,null,TO_CHAR);
	   act("A lightningbolt strikes you in your head from the sky.",
		  A_SOMEONE,self.outside,self.outside.fighting,null,TO_VICT);
	  }
	  random:=cast_spell(SPL_LIGHTNING_2,self.outside,self,self.outside.fighting,"mort_light@demon_realm");
	  goto start;
}
dilend

dilbegin mort_healer();
/* Heal spell costs 30 mana. */
code{
	 heartbeat:=PULSE_SEC*3;
   :start:
	 wait(SFB_CMD,(activator==self.outside) and (self.equip==WEAR_WIELD) and
	 ( (command("say")and("laeh"==argument)) or (command("laeh") )));
         block;
	 act("$1n utters the ancient words of divine power.",A_SOMEONE,self.outside,null,null,TO_REST);
         act("You utter the ancient words of divine power.",A_SOMEONE,self.outside,null,null,TO_CHAR);
	 if(self.alignment==0) goto start;
	 if(self.alignment>30)
	 {
	  self.alignment:=self.alignment-30;
	  cast_spell(SPL_CURE_WOUNDS_1,self.outside,self,self.outside);
	  act("You feel the divine forces building up and flowing through your body.",
                   A_SOMEONE,self.outside,null,null,TO_CHAR);
	  act("You feel the divine forces building up.",
                   A_SOMEONE,self.outside,null,null,TO_REST);
	 }
	 else
	 {
	  act("You feel the divine forces building up, and then drain away.",
                   A_SOMEONE,self.outside,null,null,TO_ALL);
	  self.alignment:=0;
	 }
	 goto start;
}
dilend

dilbegin aware mort_charge();
/* The sword holds the soul of a demon prince, that's why it has 200 mana. */
var
   random : integer;
code{
   :start:
	 wait(SFB_MSG,(activator==self.outside) and (self.equip==WEAR_WIELD));
	 act("The handle of your $2N glows, as it absorbs the soul from your victim.",
                  A_SOMEONE,self.outside,self,null,TO_CHAR);
	 act("The handle of $1n's $2N glows, as it absorbs the soul from $1s victim.",
		  A_SOMEONE,self.outside,self,null,TO_REST);
	 self.alignment:=self.alignment+atoi(argument);
         if( self.alignment > 200 )
	 {
	  self.alignment:=200; /* If i have full load, donate 1 mana to wielder */
	  if( self.outside.mana < self.outside.max_mana )
	  self.outside.mana:=self.outside.mana+1;
	 }
	 goto start;
}
dilend

dilbegin check_mana();
code{
	 heartbeat:=PULSE_SEC*3;
   :start:
	 wait(SFB_CMD,(activator==self.outside) and (self.equip==WEAR_WIELD) and
		  (command("tfark")));
	 block;
	 act("You silently speak the name of the demon prince, whos soul is trapped in the sword.",
                  A_SOMEONE,self.outside,null,null,TO_CHAR);
         act("$1n mumbles something.",A_SOMEONE,self.outside,null,null,TO_REST);
	 if(self.alignment==0)
	   act("The handle of your $2N is dark.",A_SOMEONE,self.outside,self,null,TO_CHAR);
	 if( ( self.alignment > 0	) and ( self.alignment <= 50 ) )
	   act("The handle of your $2N is shimmering slightly.",A_SOMEONE,self.outside,self,null,TO_CHAR);
	 if( ( self.alignment > 50	) and ( self.alignment <= 100 ) )
	   act("The handle of your $2N is glowing slightly.",A_SOMEONE,self.outside,self,null,TO_CHAR);
	 if( ( self.alignment > 100 ) and ( self.alignment <= 150 ) )
	   act("The handle of your $2N is shining slightly.",A_SOMEONE,self.outside,self,null,TO_CHAR);
         if( self.alignment > 150 )
	   act("The handle of your $2N shines brightly.",A_SOMEONE,self.outside,self,null,TO_CHAR);
	 goto start;
}
dilend

dilbegin mortifier_dead();
code {
	 heartbeat:=3;
   :start:
	 wait(SFB_COM, ( command( CMD_AUTO_COMBAT ) ) and
		   ( self.equip == WEAR_WIELD )   and
		   ( self.outside.fighting.level < IMMORTAL_LEVEL ) and
		   ( self.outside.fighting.hp < 10 ) );

	 act( "$1n's $3N SLASHES $2n's stomach wide open",
		   A_SOMEONE, self.outside, self.outside.fighting, self, TO_NOTVICT);

	 act( "$2n tries to block your attack, but fails miserably!",
                        A_SOMEONE, self.outside, self.outside.fighting, self, TO_CHAR);

	 act( "Your $3N CUTS $2n's stomach wide open",
                        A_SOMEONE, self.outside, self.outside.fighting, self, TO_CHAR);

	 act( "When you try to block $1n's attack, you make a fatal mistake. -SLASH-",
		   A_SOMEONE, self.outside, self.outside.fighting, self, TO_VICT);

	 act( "The last thing you feel is how your guts rushes out of your body!",
		   A_SOMEONE, self.outside, self.outside.fighting, self, TO_VICT);

	 act( "Then everything goes black, you have a date with the grim reaper...",
		   A_SOMEONE, self.outside, self.outside.fighting, self, TO_VICT);

	 self.outside.fighting.hp := -11;
	 pause;
	 goto start;
}
dilend

/*
dilbegin check_worth();
var
   ute : unitptr;
   str : string;
code{
	 heartbeat:=PULSE_SEC*30;
   :start:
	 pause;
	 ute:=self;
	 while((ute.type!=UNIT_ST_PC) and (ute.type!=UNIT_ST_ROOM))
	   ute:=ute.outside;
	 if(ute.type==UNIT_ST_ROOM) goto start;
	 str:="inventory";
	 if(self.outside!=ute) str:=self.outside.name;
	 if((ute.alignment>-350) and (ute.level<IMMORTAL_LEVEL))
	 {
          act("A dark voice says 'You puny mortal!'",A_SOMEONE,ute,null,null,TO_CHAR);
          act("A dark voice says 'You are not worthy of guarding my soul!'",A_SOMEONE,ute,null,null,TO_CHAR);
          act("You hear a thunderous crack from your "+str,A_SOMEONE,ute,null,null,TO_CHAR);
	  act("You hear a thunderous crack from $1n's "+str,A_SOMEONE,ute,null,null,TO_REST);
	  destroy(self);
	 }
	 goto start;
}
dilend

*/

dilcopy level_restrict@function( 50, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 80, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_DEX, 80, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_BRA, 50, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_CHA, 40, 0, 0, "" );

end /* End of mortifer */
/******************************************************************/
	 ishlors1_plate
names {"ishlors plate","plate"}
title "Ishlors plate"

descr "A strange plate lies here"

extra {}
"This plate is crafted in some black metal, it is of a totally unknown kind and
it makes it hard for you to decide how much damage it will take before breaking.
The plate is of enourmous size, but as you touch it it seem to adapt."
extra {"$wear_s"}
"As you wear $2N you feel a cool wind down your spine."
extra {"$remove_s"}
"The removal of $2N makes you feel better."

ARMOUR_PLATE(0,0)
manipulate {MANIPULATE_TAKE,MANIPULATE_HOLD,MANIPULATE_WEAR_BODY}
flags {UNIT_FL_MAGIC}
weight 45
cost 5 GOLD_PIECE
rent 2 SILVER_PIECE
dilcopy ali_restrict@function( -350, -1000, 0, 0, "" );
dilcopy level_restrict@function( 50, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 85, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_DEX, 85, 0, 0, "" );

end /* Ishlors plate */
/******************************************************************/
	ishlors_pendant
names {"ishlors pendant","pendant"}
title "Ishlors Pendant"
descr "A powerful pendant lies here glowing."

extra {}
"The pendant have some inscription on it which you are unable to understand.
There is also a face on the other side of the pendant, a very ugly face."

manipulate {MANIPULATE_TAKE,MANIPULATE_HOLD,MANIPULATE_WEAR_NECK}
flags {UNIT_FL_MAGIC}
ARMOUR_CHAIN(0,0)      /* Wonder why i set this */


cost 2 PLATINUM_PIECE,4 GOLD_PIECE
rent 1 GOLD_PIECE

weight 2

dilcopy ali_restrict@function( -350, -1000, 0, 0, "" );

dilcopy level_restrict@function( 50, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 85, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_DEX, 85, 0, 0, "" );

end
/******************************************************************/
	magic_bag	/* Can hold unlimited items */
names {"magic bag","leather bag","bag"}
title "Magic bag"
descr "a bag lies here."

extra {}
"A bag made of leather, it's a bit bigger than usual bags but not much.
It also has some runes carved into the bottom, but you are unable to determine
what they mean. They are to worn out."

extra {"runes in bottom","runes"}
"You are unable to make out what they say."

extra {"$identify"}
"A bag which can hold unlimited items. Only demand is that you are strong enough
to carry it."

manipulate {MANIPULATE_TAKE,MANIPULATE_HOLD}
flags {UNIT_FL_MAGIC}
type ITEM_CONTAINER
capacity 0
value[0] INFINITE_CAPACITY

cost 2 PLATINUM_PIECE
rent 4 SILVER_PIECE

weight 20

dilcopy bag_own@demon_realm();

dilbegin checksize();
var
   pc  : unitptr;
   sak : unitptr;
   old : unitptr;
   tgt : unitptr;
   num : integer;
   amo : integer;
   lop : integer;
   obj : string;
   tar : string;
   arg : stringlist;
code{
     self.capacity := 32767;
   :start:
     wait( SFB_CMD, command( "put" ) and ( activator == self.outside ) );
     pc := activator;

     sak := findunit( self.outside, argument, FIND_UNIT_INVEN, null );
     if( not sak ) goto start;
     obj := argument;
     obj := " " + getword( obj );
     if( obj in " in" )
      obj := getword( argument );
     tgt := findunit( self, argument, FIND_UNIT_INVEN|FIND_UNIT_SURRO|FIND_UNIT_EQUIP, null );
     if( ( not tgt ) or ( tgt != self ) )  goto start;

     if( sak.type == ITEM_MONEY ) goto start;

     if( sak.weight > 15 )
     {
      act( "$2n is to big to fit in $3n.", A_SOMEONE, activator, sak, self, TO_CHAR );
      block;
      goto start;
     }
     goto start;

/*
	 arg:=getwords(argument);
	 amo:=length(arg);
	 num:=0;
   :loop:

	 while((arg.[num]!="in") and (num<amo)) num:=num+1;
	 if(num==amo) goto start;
	 obj:="";
	 tar:="";
	 lop:=0;
	 while(lop<num)
	 {
	  obj:=obj+arg.[lop]+" ";
	  lop:=lop+1;
	 }
	 lop:=num+1;
	 while(lop<amo)
	 {
	  tar:=tar+arg.[lop];
	  if(lop<amo) tar:=tar+" ";
	  lop:=lop+1;
	 }

	 tgt := findunit( activator, tar, FIND_UNIT_INVEN|FIND_UNIT_SURRO|FIND_UNIT_EQUIP, null );
	 if( tgt != self ) goto start;

	 block;
	 if( ( arg.[0] == "money" ) and ( arg.[1] == "in" ) ) goto put_money;

	 if( not( arg.[0] == "all" ) or not ( arg.[1] == "in" ) )
	 {
	  sak := findunit( self.outside, obj, FIND_UNIT_INVEN, null );
	  if( sak == null )
	  {
           act("You have no such thing!",A_SOMEONE,pc,null,null,TO_CHAR);
	   goto start;
	  }
	  if(sak.weight>15)
	  {
           act("The object is to big to fit in bag.",A_SOMEONE,pc,null,null,TO_CHAR);
	   goto start;
	  }
	  link(sak,self);
          act("You put $3N into the $2n",A_SOMEONE,pc,self,sak,TO_CHAR);
          act("$1n puts $3N into $1s $2n",A_SOMEONE,pc,self,sak,TO_REST);
	 }
	 else
	 {
          sak:=self.outside.inside;
          while( sak )
	  {
           old := sak;
           sak := sak.next;
           if( ( ( old.equip == 0 ) and ( old != self ) ) and
                 ( old.objecttype != ITEM_MONEY ) )
           {
            if(old.weight>15)
            {
             act("The $2n is to big to fit in the bag.",A_SOMEONE,pc,old,null,TO_CHAR);
            }
            else
            {
             link( old, self );
             act("You put $3n into the $2n",A_SOMEONE,pc,self,old,TO_CHAR);
             act("$1n puts $3n into $1s $2n",A_SOMEONE,pc,self,old,TO_REST);
            }
           }
          }
	 }

	 goto start;

	  :put_money:
	 old:=findunit(self.outside,"platinum",FIND_UNIT_INVEN,null);
	 if(old!=null)
	 {
	  link(old,self);
          act("You put $3n into the $2n",A_SOMEONE,pc,self,old,TO_CHAR);
          act("$1n puts $3n into $1s $2n",A_SOMEONE,pc,self,old,TO_REST);
	 }
	 old:=findunit(self.outside,"gold",FIND_UNIT_INVEN,null);
	 if(old!=null)
	 {
	  link(old,self);
          act("You put $3n into the $2n",A_SOMEONE,pc,self,old,TO_CHAR);
          act("$1n puts $3n into $1s $2n",A_SOMEONE,pc,self,old,TO_REST);
	 }
	 old:=findunit(self.outside,"silver",FIND_UNIT_INVEN,null);
	 if(old!=null)
	 {
	  link(old,self);
          act("You put $3n into the $2n",A_SOMEONE,pc,self,old,TO_CHAR);
          act("$1n puts $3n into $1s $2n",A_SOMEONE,pc,self,old,TO_REST);
	 }
	 old:=findunit(self.outside,"copper",FIND_UNIT_INVEN,null);
	 if(old!=null)
	 {
	  link(old,self);
          act("You put $3n into the $2n",A_SOMEONE,pc,self,old,TO_CHAR);
          act("$1n puts $3n into $1s $2n",A_SOMEONE,pc,self,old,TO_REST);
	 }
	 old:=findunit(self.outside,"iron",FIND_UNIT_INVEN,null);
	 if(old!=null)
	 {
	  link(old,self);
          act("You put $3n into the $2n",A_SOMEONE,pc,self,old,TO_CHAR);
          act("$1n puts $3n into $1s $2n",A_SOMEONE,pc,self,old,TO_REST);
	 }
	 goto start;
*/
}
dilend

end /* End of Magic bag */
/******************************************************************/
	 bag_struct
names {"bag of structure","bag","structure"}
title "bag of structure"
descr "a bag lies here."

manipulate {MANIPULATE_TAKE,MANIPULATE_HOLD,MANIPULATE_ENTER}
flags {UNIT_FL_MAGIC}
type ITEM_CONTAINER
capacity 300

cost 2 PLATINUM_PIECE
rent 4 SILVER_PIECE

weight 20

dilbegin recall reduceweight();
var
   cont  : integer; /* Containing */
   cnt	 : integer;

   basew : integer;
   u	 : unitptr;
code{
	 basew := self.weight;
	 heartbeat := 3;
   :start:
	 cont := 0;
	 cnt := 0;
	 u := self.inside;
	 while( u )
	 {
	  cont := cont + u.weight;
	  u := u.next;
	  cnt := cnt + 1;
	  if( cnt == 40 )/* Added this to prevent dil destruction in case of big inv. */
	  {
	   cnt := 0;
	   pause;
	  }
	 }
	 setweight( self, basew - ( cont * 75 ) / 100 );
	 wait( SFB_DONE, ( command( "put" )   and ( self == target ) ) or
			 ( command( "get" )   and ( self == medium ) ) or
			 ( command( "enter" ) and ( self == target ) ) or
			 ( command( "exit" )  and ( self == target ) ) );
	 goto start;
}
dilend



end  /* End of Bag of Structure */
/******************************************************************/
	 /* Ghost guard eq */
	 g_plate
names {"ethereal plate","breastplate","plate"}
title "Ethereal breastplate"
descr "a vague blue breastplate shaped thing lies here."

manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_BODY}
ARMOUR_PLATE(0,0)
MATERIAL_METAL("A ghostly metal")

weight 16	/* Low weight since it's not a physical item */
cost   128 COPPER_PIECE
rent   6  COPPER_PIECE

dilcopy level_restrict@function( 35, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 70, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_DEX, 70, 0, 0, "" );

end

	 g_longsword
names {"ethereal longsword","longsword"}
title "Ethereal longsword"
descr "a light blue longsword lies here."

manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_BODY}
WEAPON_DEF(WPN_LONG_SWORD,0,0)
MATERIAL_METAL("A ghostly metal")

weight 10	/* Low weight since it's not a physical item */
cost   160 COPPER_PIECE
rent   8  COPPER_PIECE

dilcopy level_restrict@function( 35, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 70, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_DEX, 70, 0, 0, "" );

end
/******************************************************************/
	/*	Guard equipment */
	 guard_helmet
names {"demonic helmet","helmet"}
title "Demonic Helmet"
descr "A demonic helmet lies here."

manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_HEAD}
ARMOUR_PLATE(0,0)
MATERIAL_METAL("A black shimmering metal")

weight 10
cost 5 GOLD_PIECE
rent 2 SILVER_PIECE

dilcopy level_restrict@function( 35, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 75, 0, 0, "" );

end

	 guard_sleeves
names {"demonic sleeves","sleeves"}
title "Demonic Sleeves"
descr "A pair of demonic sleeves lies here."

manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_ARMS}
ARMOUR_PLATE(0,0)
MATERIAL_METAL("A black shimmering metal")

weight 15
cost 5 GOLD_PIECE
rent 2 SILVER_PIECE

dilcopy level_restrict@function( 35, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 75, 0, 0, "" );

end

	 guard_gloves
names {"demonic gloves","gloves"}
title "Demonic Gloves"
descr "A pair of demonic gloves lies here."

manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_HANDS}
ARMOUR_PLATE(0,0)
MATERIAL_METAL("A black shimmering metal")

weight 10
cost 5 GOLD_PIECE
rent 2 SILVER_PIECE

dilcopy level_restrict@function( 35, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 75, 0, 0, "" );

end

	 guard_plate
names {"demonic plate","plate"}
title "Demonic Plate"
descr "A demonic plate lies here."

manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_BODY}
ARMOUR_PLATE(0,0)
MATERIAL_METAL("A black shimmering metal")

weight 25
cost 5 GOLD_PIECE
rent 2 SILVER_PIECE

dilcopy level_restrict@function( 35, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 75, 0, 0, "" );

end

	 guard_leggings
names {"demonic leggings","leggings"}
title "Demonic Leggings"
descr "A pair of demonic leggings lies here."

manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_LEGS}
ARMOUR_PLATE(0,0)
MATERIAL_METAL("A black shimmering metal")

weight 15
cost 5 GOLD_PIECE
rent 2 SILVER_PIECE

dilcopy level_restrict@function( 35, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 75, 0, 0, "" );

end

	 guard_boots
names {"demonic boots","boots"}
title "Demonic Boots"
descr "A pair of demonic boots lies here."

manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_FEET}
ARMOUR_PLATE(0,0)
MATERIAL_METAL("A black shimmering metal")

weight 10
cost 5 GOLD_PIECE
rent 2 SILVER_PIECE

dilcopy level_restrict@function( 35, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 75, 0, 0, "" );

end

	 guard_sword
names {"demonic longsword","longsword","sword"}
title "Demonic Longsword"
descr "A demonic longsword lies here."
manipulate {MANIPULATE_TAKE, MANIPULATE_WIELD}
WEAPON_DEF(WPN_LONG_SWORD,0,0)
MATERIAL_METAL("A black shimmering metal")

weight 15
cost 5 GOLD_PIECE
rent 2 SILVER_PIECE

dilcopy level_restrict@function( 35, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 60, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_DEX, 80, 0, 0, "" );

end

	 guard_hammer
names {"demonic warhammer","warhammer","hammer"}
title "Demonic Warhammer"
descr "A demonic warhammer lies here."
manipulate {MANIPULATE_TAKE, MANIPULATE_WIELD}
WEAPON_DEF(WPN_WAR_HAMMER,0,0)
MATERIAL_METAL("A black shimmering metal")

weight 15
cost 5 GOLD_PIECE
rent 2 SILVER_PIECE

dilcopy level_restrict@function( 35, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 80, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_DEX, 60, 0, 0, "" );

end

	 guard_shield
names {"demonic shield","shield"}
title "Demonic Shield"
descr "A demonic shield lies here."

manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_SHIELD}
SHIELD_DEF(SHIELD_MEDIUM,0,0)
MATERIAL_METAL("A black shimmering metal")

weight 20
cost 5 GOLD_PIECE
rent 2 SILVER_PIECE

dilcopy level_restrict@function( 35, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 67, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_DEX, 60, 0, 0, "" );

end
/******************************************************************
		 SHOP EQUIPMENT
 ******************************************************************/
m_longsword
names {"mithril longsword","longsword","sword"}
title "Mithril Longsword"
descr "A mirthil longsword lies here."
extra {}
"This sword is beautifully crafted. No human could've made this magnificent
sword."

manipulate {MANIPULATE_TAKE, MANIPULATE_WIELD}
WEAPON_DEF(WPN_LONG_SWORD,0,0)
MATERIAL_METAL("Mithril")

weight 8  /* Long sword weighs about 16, Mithril is lighter than steel weight/2 */

cost 3 PLATINUM_PIECE
rent 1 GOLD_PIECE

dilcopy level_restrict@function( 20, 0, 0, "" );

end

m_greatsword
names {"mithril greatsword","greatsword","sword"}
title "Mithril Greatsword"
descr "A mithril greatsword lies here."
extra {}
"This sword is beautifully crafted. No human could've made this magnificent
sword."

manipulate {MANIPULATE_TAKE, MANIPULATE_WIELD}
WEAPON_DEF(WPN_GREAT_SWORD,0,0)
MATERIAL_METAL("Mithril")

weight 12  /* Great sword weighs about 24, Mithril is lighter than steel weight/2 */
cost 3 PLATINUM_PIECE, 3 GOLD_PIECE
rent 1 GOLD_PIECE, 2 SILVER_PIECE, 3 COPPER_PIECE, 1 IRON_PIECE

dilcopy level_restrict@function( 20, 0, 0, "" );

end

m_dagger
names {"mithril dagger","dagger"}
title "Mithril Dagger"
descr "A mithril dagger lies here."
extra {}
"A dagger of fine craftsmanship, it is beautifully crafted. No human could've
made this magnificent dagger."

manipulate {MANIPULATE_TAKE, MANIPULATE_WIELD}
WEAPON_DEF(WPN_DAGGER,0,0)
MATERIAL_METAL("Mithril")

weight 1  /* Dagger weighs about 2, Mithril is lighter than steel weight/2 */
cost 1 PLATINUM_PIECE, 3 GOLD_PIECE
rent 4 SILVER_PIECE, 3 COPPER_PIECE

dilcopy level_restrict@function( 20, 0, 0, "" );

end

m_war_hammer
names {"mithril war hammer","war hammer","hammer"}
title "Mithril War Hammer"
descr "A mithril war hammer lies here."
extra {}
"This warhammer is beautifully crafted. No human could've made this magnificent
warhammer."

manipulate {MANIPULATE_TAKE, MANIPULATE_WIELD}
WEAPON_DEF(WPN_WAR_HAMMER,0,0)
MATERIAL_METAL("Mithril")

weight 10  /* War hammer weighs about 20, Mithril is lighter than steel weight/2 */
cost 3 PLATINUM_PIECE, 3 GOLD_PIECE
rent 1 GOLD_PIECE, 2 SILVER_PIECE

dilcopy level_restrict@function( 20, 0, 0, "" );

end

m_war_mattock
names {"mithril war mattock","war mattock","mattock","hammer"}
title "Mithril War Mattock"
descr "A mithril war mattock lies here."
extra {}
"This warhammer is beautifully crafted. No human could've made this magnificent
warhammer."

manipulate {MANIPULATE_TAKE, MANIPULATE_WIELD}
WEAPON_DEF(WPN_WAR_MATTOCK,0,0)
MATERIAL_METAL("Mithril")

weight 15  /* War mattock weighs about 30, Mithril is lighter than steel weight/2 */
cost 4 PLATINUM_PIECE, 3 GOLD_PIECE
rent 1 GOLD_PIECE, 6 SILVER_PIECE

dilcopy level_restrict@function( 20, 0, 0, "" );

end
/******************************************************************
	  MAGIC STORE
 ******************************************************************/
c_potion
names {"crystal vial","crystal","vial","potion"}
title "Crystal vial"
descr "A crystal vial lies here."

extra {"$identify"}
"This is one dose of a liquid which makes you invisible."

extra {"$improved identify"}
"It holds the magic essence of invisibility."

extra {"$quaff_s"}
"As you pour the containment of the $2N down your throut you feel a burning
sensation."

extra {"$quaff_o"}
"$1n pours the containment of the $2N down $1s throut."

POTION_DEF(90,SPL_INVISIBILITY,SPL_NONE,SPL_NONE)
weight 1
cost 2 PLATINUM_PIECE
rent 4 SILVER_PIECE
end

p_potion
names {"purple vial","purple","vial","potion"}
title "Purple vial"
descr "A purple vial lies here."

extra {"$identify"}
"This is one dose of cure for almost any diease."

extra {"$improved identify"}
"It holds the magic essence of remove disease and remove posion."

extra {"$quaff_s"}
"As you pour the containment of the $2N down your throut you feel a burning
sensation."

extra {"$quaff_o"}
"$1n pours the containment of the $2N down $1s throut."

POTION_DEF(90,SPL_REM_DISEASE,SPL_REMOVE_POISON,SPL_NONE)
weight 1
cost 8 PLATINUM_PIECE
rent 6 SILVER_PIECE
end

y_potion
names {"yellow vial","yellow","vial","potion"}
title "Yellow vial"
descr "A yellow vial lies here."

extra {"$identify"}
"This is one dose of healing."

extra {"$improved identify"}
"It holds the magic essence of healing."

extra {"$quaff_s"}
"As you pour the containment of the $2N down your throut you feel a burning
sensation."

extra {"$quaff_o"}
"$1n pours the containment of the $2N down $1s throut."

POTION_DEF(90,SPL_CURE_WOUNDS_3,SPL_NONE,SPL_NONE)
weight 1
cost 6 PLATINUM_PIECE
rent 5 SILVER_PIECE
end

/******************************************************************
	  JEWELERY STORE
 ******************************************************************/
s_ring
names {"silver ring","ring"}
title "a small silver ring"
descr "A small silver ring lies here."
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD,MANIPULATE_WEAR_FINGER}
type ITEM_OTHER
weight 0
cost 8 SILVER_PIECE
rent 4 COPPER_PIECE
end

g_ring
names {"gold ring","ring"}
title "a small gold ring"
descr "A small gold ring lies here."
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD,MANIPULATE_WEAR_FINGER}
type ITEM_OTHER
weight 0
cost 7 GOLD_PIECE, 3 SILVER_PIECE
rent 3 SILVER_PIECE
end

r_ring
names {"ruby ring","ring"}
title "a small ruby ring"
descr "A small ruby ring lies here."
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD,MANIPULATE_WEAR_FINGER}
type ITEM_OTHER
weight 0
cost 1 PLATINUM_PIECE, 3 GOLD_PIECE
rent 4 SILVER_PIECE, 3 COPPER_PIECE
end

d_ring
names {"diamond ring","ring"}
title "a small diamond ring"
descr "A small diamond ring lies here."
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD,MANIPULATE_WEAR_FINGER}
type ITEM_OTHER
weight 0
cost 4 PLATINUM_PIECE, 5 GOLD_PIECE
rent 1 GOLD_PIECE, 1 SILVER_PIECE, 3 COPPER_PIECE
end

j_neck
names {"jade necklace","necklace"}
title "a green necklace"
descr "A green necklace lies here."
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD,MANIPULATE_WEAR_NECK}
type ITEM_OTHER
weight 1
cost 3 PLATINUM_PIECE, 5 GOLD_PIECE
rent 5 GOLD_PIECE, 4 COPPER_PIECE
end

d_neck
names {"diamond necklace","necklace"}
title "a diamond necklace"
descr "A diamond necklace lies here."
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD,MANIPULATE_WEAR_NECK}
type ITEM_OTHER
weight 1
cost 6 PLATINUM_PIECE, 3 GOLD_PIECE
rent 2 GOLD_PIECE, 3 COPPER_PIECE
end

d_ear
names {"diamond earring","earring"}
title "a diamond earring"
descr "A diamond earring lies here."
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD,MANIPULATE_WEAR_EAR}
type ITEM_OTHER
weight 0
cost 4 PLATINUM_PIECE, 2 GOLD_PIECE
rent 1 GOLD_PIECE
end

g_ear
names {"golden earring","earring"}
title "a golden earring"
descr "A golden earring lies here."
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD,MANIPULATE_WEAR_EAR}
type ITEM_OTHER
weight 0
cost 1 PLATINUM_PIECE, 2 GOLD_PIECE
rent 4 SILVER_PIECE
end
/******************************************************************/
	 treasure_1

flags {UNIT_FL_NO_TELEPORT}

MONEY(IRON_PIECE, 497)

end  /* End of Treasure 1 */
/******************************************************************/
	 board_1
names {"board"}
title "god assistance board"
descr "In one of the mirrors you can see a board."

flags {UNIT_FL_NO_TELEPORT}

special SFUN_BULLETIN_BOARD "citizen"

end  /* End of board 1 /*
/******************************************************************/
	 sign_1
names {"sign"}
title "old sign"
descr "There is an old sign here."

extra {}
"&lThe sign reads:
Tsaar village - West
Castle of Ishlor  - East
Temple of Olympus - West"

flags {UNIT_FL_NO_TELEPORT}

end  /* End of Sign 1 */
/******************************************************************/
	 sign_2
names {"sign"}
title "old sign"
descr "There is an old sign here."
extra {}
"&lThis ruin has been banished to another dimension by the gods of VALHALLA.
I am working on how to get it back to it's real place - Shai"

flags {UNIT_FL_NO_TELEPORT}

end  /* End of Sign 2 */
/******************************************************************/
	 sign_3
names {"sign"}
title "old sign"
descr "There is an old sign here."

extra {}
"Bridge out of order, new one under construction! - Shai"

flags {UNIT_FL_NO_TELEPORT}

end  /* End of Sign 3 */
/******************************************************************/
	 sign_4
names {"sign"}
title "old sign"
descr "There is an old sign here."

extra {}
"I put up this energy wall to prevent the hordes from stormin into VALHALLA - Shai"

flags {UNIT_FL_NO_TELEPORT}

end
/******************************************************************/
	 sign_5
names {"sign"}
title "old sign"
descr "There is an old sign here."

extra {}
"The Archam desert was slowly fading away, i just speeded up the process - Shai"

flags {UNIT_FL_NO_TELEPORT}

end
/******************************************************************/
	 sign_6
names {"sign"}
title "old sign"
descr "There is an old sign here."

extra {}
"The Murhabi swamp has sunk into the next plane, it will be returned soon - Shai"

flags {UNIT_FL_NO_TELEPORT}

end
/******************************************************************/
	 skeleton
names {"burned skeleton","skeleton"}
title "burned skeleton"
descr "There is a small burned skeleton here."

extra {}
"The skeleton has been here for quite a while, it has been badly burnt by some
sort of flame magic. There are markings from teeth on it's bones and your
guess is that, if there has been flesh on those bones. It was VERY long ago."

extra {"$get_s"}
"You get a weird feeling in you stomach as you pick up the $2n."

extra {"$drop_s"}
"The $2n gives out a small crack when you drop it."

extra {"$drop_o"}
"The $2n gives out a small crack when $1n drops it."

CONTAINER_DEF( 200 ) /* Amusing.. you can use it as a bag or something :) */
weight 100

dilbegin destr();
code{
	 heartbeat := PULSE_SEC * 10;
   :loop:
	 wait( SFB_TICK, self.inside == null );
	 pause;
	 pause;
	 pause;
	 pause;
	 pause;
	 pause;
	 pause;
	 pause;
	 act( "The skeleton crumbles into dust.",
		   A_SOMEONE, self.outside.inside, null, null, TO_ALL );
	 quit;
}
dilend

end  /* End of Skeleton */
/******************************************************************/
	 money_1
flags { UNIT_FL_NO_TELEPORT }
MONEY( SILVER_PIECE, 13 )
end
/******************************************************************/
	 small_pond
names {"pond"}
title "a pond"
descr "A crystal clear pond."

extra {}
"This pond has crystal clear water. You feel a great urge for swimming as you
look at it."

spell 70

dilbegin pond();
var
 res : integer;
code{
   :init:
	 heartbeat:=PULSE_SEC*3;
	 interrupt(SFB_CMD,command("drink") and ("from pond"==argument),drink);
   :loop:
	 pause;
	 goto loop;

   :drink:
	 block;
         act("You drink the water from the pond.",A_SOMEONE,activator,null,null,TO_CHAR);
	 act("$1n drinks water from the pond.",A_SOMEONE,activator,null,null,TO_REST);
	 if(rnd(0,100)<50)
	 {
          act("You feel refreshed",A_SOMEONE,activator,null,null,TO_CHAR);
	  res:=cast_spell(SPL_CURE_WOUNDS_2,activator,self,activator,"");
	 }
	 else
	 {
          act("You feel sick",A_SOMEONE,activator,null,null,TO_CHAR);
	  res:=cast_spell(SPL_POISON,activator,self,activator,"");
	 }
	 goto loop;
}
dilend

flags { UNIT_FL_NO_TELEPORT, UNIT_FL_MAGIC }
end
/******************************************************************/
	 eth_noose
names {"ethereal noose","noose"}
title "ethereal noose"
descr "a shimmering noose lies here."

extra {}
"This is a noose made of ethereal rope, it has probably been turned ethereal
when the person who used it died. It is almost completely transparent."

extra {"$wear_s"}
"As soon as you put the $2N around your neck you feel it growing tighter."

extra {"$rem_s"}
"The strain around your neck vanishes when the $2N is removed."

manipulate { MANIPULATE_TAKE, MANIPULATE_HOLD, MANIPULATE_WEAR_NECK }

end  /* End of eth noose */
/******************************************************************/
	 res_book
names {"research book","book"}
title "Book of demonic knowledge"
descr "A black book lies here."

manipulate { MANIPULATE_TAKE, MANIPULATE_HOLD }

extra {}
"The book is complete black, no title no nothing. When you open it you can
see that the name of the writer is Horja. There seems to be some sort of index
in it too."

extra {"writer"}
"My name is Horja, i have been studying demons and their behavior for almost
two decades now. My master was the great demonologist Sorch, he was the only
person who ever managed to summon a greater demon and strike a bargain with it.
Instead of wasting my precious time telling about myself i will write down
what i have set my life on discovering."

extra {"index"}
"&n
Chapter 1 - Demon Servants&n
Chapter 2 - Lesser Demons&n
Chapter 3 - Greater Demons&n
Chapter 4 - Demon princes&n
Chapter 5 - Demonic Allies"

extra {"chapter 1","demon servants"}
"My assistant has written a book about these, so i refer to it."

extra {"chapter 2","lesser demons"}
"These are the most common of the demons i have come across. They have their
own rank soceity where they act as soldiers, workers, messengers or whatever
else their ruling deity commands them to do. As with all demons they have no
specific appearance or nature of behavior, though i have never seen one that is
over 10 feet tall yet. I have discovered that not all lesser demons are evil
or malicous, it usually depends on the nature of their deity."

extra {"chapter 3","greater demons"}
"The greater demons are the most powerful of their kind. In their own plane
of existence they are second only to the gods and demon princes, and have
total power over all demons in the realm. They are even worshipped by some
Human cults as if they were gods. These entities tend to be proud and haughty,
and only the very powerful or very foolish should attempt to summon them."

extra {"chapter 4","demon princes"}
"I really do not know much about the demon princes, i have never seen one.
I havn't even heard the name of one, though this is not so strange when i have
heard that if you know the true name of a demon prince. You can command it
to do anything."

extra {"chapter 5","demonic allies"}
"I have placed all my work around one race of demoninc allies, known as Fimirs.
They have an advanced system of living but a very primitive nature. I will
follow up on my notes as soon as i come back from my trip to the eastern
border of this realm."

dilbegin read_dil();
var
 chapter : integer;
code{
   :loop:
	 wait( SFB_CMD, command( "chapter" ) );
	 if( not( visible( activator, self ) ) ) goto loop;
	 chapter := atoi( getword( argument ) );
	 block;
	 if( ( chapter < 1 ) or ( chapter > 5 ) )
	  act( "The $2n does not have a chapter by that number.",
	   A_SOMEONE, activator, self, null, TO_CHAR );
	 else
	  exec( "read chapter " + itoa( chapter ), activator );
	 goto loop;
}
dilend

end  /* End of res book */
/******************************************************************/
	 shadow_axe
names {"shadow axe","axe"}
title "shadow axe"
descr "There is a shadow shaped as an axe on the ground."

extra {}
"You can make out no details on this axe."

extra {"$wear_s"}
"The handle of the $2N is hard to get a grip on, but you manage."

extra {"$identify"}
"This axe has been shaped by the demon lord of shadows, he only gives
it to his most loyal allies. The magic aura tells you that the blade
of this axe is fatal to Elves."

extra {"$improved identify"}
"This axe raises your dexterity by 3 and although the blade of the
axe hates elves, the handle has no such magic in it. The reason for this
is that The demon lord had many elf spies which he used to fight
the elves, and gave these axes to them."

manipulate { MANIPULATE_TAKE, MANIPULATE_WIELD, MANIPULATE_HOLD }
WEAPON_DEF( WPN_HAND_AXE, 0, 0 )
MATERIAL_METAL("shadow")

WEAPON_SLAYER( RACE_ELF ) /* Elf slayer */


dilbegin solid();
code{
   :loop:
	 wait( SFB_COM, command( CMD_AUTO_COMBAT ) );
	 if( ( self.equip != WEAR_WIELD ) and ( self.equip != WEAR_HOLD ) )
	 goto loop;
	 if( not( self.outside.type & UNIT_ST_PC ) ) goto loop;
	 if( self.outside.position != POSITION_FIGHTING ) goto loop;
	 if( not( self.outside.fighting.type & UNIT_ST_NPC ) ) goto loop;

	 if( rnd( 1, 200 ) < self.outside.weapons[ WPN_HAND_AXE ] )
	 {
	  act( "The blade of your $2N suddenly becomes solid and cuts deep into $3n.",
		   A_SOMEONE, self.outside, self, self.outside.fighting, TO_CHAR );
	  act( "The blade of $1n's $2N suddenly becomes solid and cuts deep into $3n.",
		   A_SOMEONE, self.outside, self, self.outside.fighting, TO_NOTVICT );
	 }
	 goto loop;
}
dilend

dilcopy light_eat@demon_realm();

dilcopy level_restrict@function( 40, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_DEX, 88, 0, 0, "" );

weight 8
cost 612 COPPER_PIECE
rent 30 COPPER_PIECE
end  /* End of shadow axe */
/******************************************************************/
	 shadow_chain
names {"shadow chainmail","chainmail","chain","mail"}
title "a shadow chainmail"
descr "A dark chainmail lies here."

manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_BODY}
ARMOUR_CHAIN( 0,0 )
MATERIAL_METAL( "shadow" )


dilbegin magic();
var
 res : integer;
code{
   :loop:
	 wait( SFB_CMD, command( CMD_CAST ) and ( activator == self.outside ) and
			( self.equip == WEAR_BODY ) and
			( self.outside.type & UNIT_ST_PC ) );
	 act("You feel the $2N getting warmer as the magic power builds up.",
                  A_SOMEONE,self.outside,self,null,TO_CHAR);
	 act("$1N's $2N becomes more solid as the powers of magic builds up.",
		  A_HIDEINV,self.outside,self,null,TO_REST);
	 if( self.hp == 1 )
	 {
	  self.spells[ SPL_FIREBALL_3 ] := self.outside.level * 2;
	  res := cast_spell( SPL_FIREBALL_3, self.outside, self, self.outside, "chain_aff@demon_realm" );
	  if( res > 0 )
	   act( "Your $2N burns your skin and fades from existence.",
		A_SOMEONE,self.outside,self,null,TO_CHAR);
	  else
	   act( "Your $2N fades from existance.",
		A_SOMEONE,self.outside,self,null,TO_CHAR);

	  act( "$1n's $2N fades from existence.",
	   A_HIDEINV,self.outside,self,null,TO_REST);

	  destroy( self );
	 }
	 self.hp := self.hp - 1;
	 goto loop;
}
dilend

dilcopy light_eat@demon_realm();

dilcopy level_restrict@function( 40, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_STR, 60, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_DEX, 88, 0, 0, "" );


weight 20
cost 612 COPPER_PIECE
rent 30 COPPER_PIECE
end  /* End of shadow chain */
/******************************************************************/
	 erika_earring
names {"golden earring","earring"}
title "golden earring"
descr "A golden earring lies here."

extra {}
"A golden earring with platinum ornaments. The earring resembles a small snake
around some sort of spire. The eyes of the snake are small rubys."

extra {"platinum ornaments", "platinum", "ornaments"}
"The ornament is some sort if binding for magic."

extra {"snake around spire", "snake", "spire"}
"This snake is very well crafted you can even make out scailes on it's body."

extra {"snake eyes", "eyes", "rubys"}
"The rubys acts as eyes for the snake."

manipulate { MANIPULATE_TAKE, MANIPULATE_HOLD, MANIPULATE_WEAR_EAR }

cost 1 PLATINUM_PIECE
rent 3 SILVER_PIECE

weight 0

dilcopy level_restrict@function( 30, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_BRA, 70, 0, 0, "" );


end  /* End of earring */
/******************************************************************
		 QUEST ITEMS!!
 ******************************************************************/
	 chaos_gem
names {"gem of chaos","yellow gem","gem"}
title "Gem of Chaos"
descr "A yellow gem lies here."

extra {}
"This is a small yellow gem. But when you look closer you see something inside
it. As you look even closer you realize that there is an eye inside the gem.
And it's looking back at you!"

flags { UNIT_FL_NO_TELEPORT, UNIT_FL_BURIED, UNIT_FL_MAGIC }
manipulate { MANIPULATE_TAKE, MANIPULATE_HOLD }

cost 6 GOLD_PIECE
rent 2 SILVER_PIECE

end
/*======================================*/
	 chaos_staff
names {"staff of chaos","staff"}
title "Staff of Chaos"
descr "A staff lies here."
extra {}
"The staff is made of a black stone material, it seems to feed on the heat
around itself."

extra {"$identify"}
"This staff makes you more physically strong."

extra {"$improved identify"}
"It raises you Str by 2 and your Dex 1."

MATERIAL_ORGANIC("A black organic material")

manipulate { MANIPULATE_TAKE, MANIPULATE_WIELD }
WEAPON_DEF( WPN_QUARTERSTAFF, 13, 8 )
flags { UNIT_FL_MAGIC, UNIT_FL_NO_TELEPORT, UNIT_FL_BURIED }
STR_TRANSFER( +2 )
DEX_TRANSFER( +1 )
weight 5
cost 1 PLATINUM_PIECE, 2 GOLD_PIECE
rent 7 SILVER_PIECE

dilcopy level_restrict@function( 50, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_BRA, 80, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_CON, 40, 0, 0, "" );


end  /* End of Choas Staff */
/*======================================*/
	 chaos_ring
names {"ring of chaos","ring"}
title "Ring of Chaos"
descr "A strange ring lies here."
extra {}
"This ring seems to be made of bone but you can't really tell for sure. It
seems to have some strange aura around itself. It give you the creeps."

extra {"aura"}
"You stare at the ring and it gives you a headache."

extra {"$identify"}
"The ring will make you more powerful in the ways of magic, but will slowly
consume your soul."

extra {"$improved identify"}
"This ring is a small piece from Ishlors horn. Even this tiny piece will
allow you to gain some of his power. It'll raise your BRA by 1 and MAG by 2"

manipulate { MANIPULATE_TAKE, MANIPULATE_WEAR_FINGER }
type ITEM_TREASURE
MATERIAL_ORGANIC( "Piece of a horn" )
flags { UNIT_FL_MAGIC, UNIT_FL_BURIED, UNIT_FL_NO_TELEPORT }
MAG_TRANSFER( +2 )
BRA_TRANSFER( +1 )

spell 80

weight 1
cost 1 PLATINUM_PIECE, 2 GOLD_PIECE
rent 7 SILVER_PIECE


dilbegin evil_ring();
var
   pc	: unitptr;
   stat : integer;
   cnt	: integer;
   crap : integer;
code {
	   heartbeat := PULSE_SEC * 60;
	   stat := 0;
	   interrupt( SFB_DONE, ( command( CMD_WEAR ) and
				( medium == self ) ), int_wield );
	   interrupt( SFB_DONE, ( command( CMD_REMOVE ) and
				( medium == self ) ), int_remove );
	   interrupt( SFB_TICK, TRUE, eat_ali );
	 :start:
	   if( ( self.outside.alignment < 350 ) and ( stat == 1 ) )
	   {
		act("You hear that deep voice again",
                                          A_SOMEONE,self.outside,null,null,TO_CHAR);
                act("Your soul has been cleaned",A_SOMEONE,self.outside,null,null,TO_CHAR);
                act("The ring slips of your finger",A_SOMEONE,self.outside,null,null,TO_CHAR);
		unequip( self );
		stat := 0;
	   }
	   pause;
	   goto start;

	 :eat_ali:
	   heartbeat := PULSE_SEC * 60;
	   if( stat == 0 ) goto start;
	   if( self.outside.type != UNIT_ST_PC ) goto start;
	   if( rnd( 1, 100 ) < 50 )
	   {
		crap := cast_spell( SPL_ENERGY_DRAIN, self.outside, self, self.outside, "" );
		goto start;
	   }
	   self.outside.alignment := self.outside.alignment - 1;
	   cnt := cnt + 1;
	   if( cnt == 20 )
	   {
		act("You feel as if part of your soul has been taken away.",
                         A_SOMEONE, self.outside, null, null, TO_CHAR );
		cnt := 0;
	   }
	   goto start;

	 :int_remove:
	   stat := 0;
	   act("Pass this ring on to the next person whom you wish to purge.",
                                          A_SOMEONE, self.outside, null, null, TO_CHAR );
	   goto start;

	 :int_wield:
	   cnt := 0;
	   stat := 1;
	   pc := activator;
	   secure( pc, start );
	   act("After you have put the ring on you hear a deep voice:",
                                          A_SOMEONE, pc, null, null, TO_CHAR );
	   if( pc.alignment > 350 )
	   {
		act("'Ahh this is a nice one.. We shall get along very good.'",
                                          A_SOMEONE, pc, null, null, TO_CHAR );
	   }
	   else
	   {
		act("'What's this? You have no reason to wear me.'",
                                          A_SOMEONE, pc, null, null, TO_CHAR );
		unequip( self );
	   }
	   unsecure( pc );
	   goto start;

	 :lost:
	   unsecure( pc );
	   goto start;
}
dilend


dilcopy level_restrict@function( 50, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_BRA, 40, 0, 0, "" );
dilcopy abi_restrict@function( ABIL_MAG, 30, 0, 0, "" );


end /* End of ring */
/******************************************************************/
/*################################################################
  ################################################################*/
%reset
/******************************************************************
			   Plain Reset
 ******************************************************************/
load p_servent into pzone_1  zonemax 16
load p_servent into pzone_2  zonemax 16
load p_servent into pzone_5  zonemax 16
load p_servent into pzone_6  zonemax 16
{
  equip anklet_spd position WEAR_ANKLE_L
}
load p_servent into pzone_8  zonemax 16
load p_servent into pzone_9  zonemax 16
load p_servent into pzone_11 zonemax 16
load p_servent into pzone_12 zonemax 16

load bridge_guard into pzone_15 local 2
{
  equip guard_helmet   position WEAR_HEAD
  equip guard_sleeves  position WEAR_ARMS
  equip guard_gloves   position WEAR_HANDS
  equip guard_plate    position WEAR_BODY
  equip guard_leggings position WEAR_LEGS
  equip guard_boots    position WEAR_FEET
  equip guard_sword    position WEAR_WIELD
  equip guard_shield   position WEAR_SHIELD
}

load peddler into pzone_10 max 1
{
  equip guard_helmet		position WEAR_HEAD
  equip guard_sleeves		position WEAR_ARMS
  equip guard_gloves		position WEAR_HANDS
  equip guard_plate		position WEAR_BODY
  equip guard_leggings		position WEAR_LEGS
  equip guard_boots		position WEAR_FEET
  equip guard_shield		position WEAR_SHIELD

  equip light_bracelet             position WEAR_WRIST_L
  equip peddler_swo             position WEAR_WIELD

  equip p_cloak                 position WEAR_ABOUT
}
/******************************************************************
			   Path reset
 ******************************************************************/
load d_sp_queen   into path_20		   zonemax 1
load d_spider	  into path_17		   zonemax 16
load d_spider	  into path_13		   zonemax 16
load d_spider	  into path_6		   zonemax 16
load d_spider	  into path_11		   zonemax 16
load d_spider	  into path_3		   zonemax 16
load d_spider	  into path_8		   zonemax 16
load d_spider	  into path_15		   zonemax 16
load d_spider	  into path_19		   zonemax 16
/******************************************************************
			   Town Rest
 ******************************************************************/
load tsaar_ghost  into deadend		   zonemax 5
load tsaar_ghost  into dark_alley2	   zonemax 5
load tsaar_ghost  into tsaar_road1	   zonemax 5
load tsaar_ghost  into tsaar_road15	   zonemax 5
load tsaar_ghost  into village_sq1	   zonemax 5

load ghost_guard  into north_guardcage local 1
{
 equip g_plate@demon_realm	   position WEAR_BODY
 equip g_longsword@demon_realm position WEAR_WIELD
}
load ghost_guard	into south_guardcage local 1
{
 equip g_plate@demon_realm	   position WEAR_BODY
 equip g_longsword@demon_realm position WEAR_WIELD
}
load ghost_guard	into east_guardcage  local 1
{
 equip g_plate@demon_realm	   position WEAR_BODY
 equip g_longsword@demon_realm position WEAR_WIELD
}
load ghost_healer	into tsaar_church    local 1
load beggar		into deadend	     local 2
load beggar		into tsaar_road28    local 2

load morgia		into bank_of_tsaar   zonemax 1
load mayor		into mayor_floor2    zonemax 1
{
 equip eth_noose	   position WEAR_NECK_1
}
/*	 Stores are closed for now, to hard to make good prices
load gwendy		into tsaar_armory    zonemax 1
*/
load erthar		into tsaar_weaponry  zonemax 1
load aina		into jeweler		 zonemax 1
load erika		into magic_store	 zonemax 1
{
 equip erika_earring  position WEAR_EAR_L
}
load treasure_1   into treasury 	   local 1

load attic_thief  into guild_attic	   max 1
{
 load res_book
 equip shadow_axe	   position WEAR_WIELD
 equip shadow_axe	   position WEAR_HOLD
 equip shadow_chain    position WEAR_BODY
}

load demon_gservant into cas_entrance local 2
load demon_gservant into cas_entrance local 2
load demon_gservant into cas_entrance local 2
load demon_gservant into cas_entrance local 2
load demon_gservant into cas_entrance local 2

/******************************************************************
			   Misc. Reset
 ******************************************************************/
load ishlor into nc_ghall@ishlor max 1
{
  equip mortifier		position WEAR_WIELD
  equip treasury_key@ishlor	position WEAR_NECK_1
  equip ishlors1_plate		position WEAR_BODY
}

load g_wizard into rentry max 1
{
  equip g_robe	position  WEAR_ABOUT
  equip g_staff position  WEAR_WIELD
}

load board_1		into shai_study 		local 1
load board_1		into tsaar_church		local 1
load sign_1		into path2village3		max 1
load sign_2		into path_18			max 1
load sign_3		into broken_bridge		max 1
load sign_4		into north_gate 		max 1
load sign_5		into road_5			max 1
load sign_6		into path_8			max 1
load vault_closer	into shai_study 		local 1

load c_man1		into road_5			local 1
load c_man2		into path_8			local 1
/******************************************************************
			   Quest. Reset
 ******************************************************************/
load small_pond 	into path_13 zonemax 1	/* Load pond	       */
load skeleton		into path_13 zonemax 1	/* Skelton at pond     */
{
 load money_1
}
/******************************************************************
			   Door Reset
 ******************************************************************/
door cas_entrance	NORTH { EX_OPEN_CLOSE, EX_CLOSED }
door village_sq3	SOUTH { EX_OPEN_CLOSE, EX_CLOSED }
door mayor_floor1	NORTH { EX_OPEN_CLOSE, EX_CLOSED }
door tsaar_jail 	EAST { EX_OPEN_CLOSE, EX_CLOSED, EX_LOCKED, EX_PICKPROOF }
door tsaar_guard	WEST { EX_OPEN_CLOSE, EX_CLOSED, EX_LOCKED, EX_PICKPROOF }

door demonic_guild	  UP { EX_OPEN_CLOSE, EX_CLOSED, EX_HIDDEN }
door guild_attic	DOWN { EX_OPEN_CLOSE, EX_CLOSED }

/******************************************************************/
%end



